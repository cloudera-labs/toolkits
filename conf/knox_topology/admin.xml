<topology>
    <gateway>
	<provider>
		<role>authentication</role>
		<name>ShiroProvider</name>
		<enabled>true</enabled>
		<param>
			<name>sessionTimeout</name>
			<value>30</value>
		</param>
		<param>
			<name>main.ldapRealm</name>
			<value>org.apache.hadoop.gateway.shirorealm.KnoxLdapRealm</value>
		</param>
		<param>
			<name>main.ldapRealm.userDnTemplate</name>
			<value>uid={0},ou=users,dc=cloudair,dc=lan</value>
		</param>
		<param>
			<name>main.ldapRealm.contextFactory.url</name>
			<value>ldap://infra01.cloudair.lan:389</value>
		</param>
		<param>
			<name>main.ldapRealm.contextFactory.authenticationMechanism</name>
			<value>simple</value>
		</param>
		<param>
			<name>urls./**</name>
			<value>authcBasic</value>
		</param>
	</provider>

	<provider>
		<role>authorization</role>
		<name>AclsAuthz</name>
		<enabled>true</enabled>
		<param>
			<name>knox.acl.mode</name>
			<value>OR</value>
		</param>
		<param>
			<name>knox.acl</name>
			<value>KNOX_ADMIN_USERS;KNOX_ADMIN_GROUPS;*</value>
		</param>
	</provider>

	<provider>
		<role>identity-assertion</role>
		<name>HadoopGroupProvider</name>
		<enabled>true</enabled>
		<param>
			<name>hadoop.security.group.mapping</name>
			<value>org.apache.hadoop.security.LdapGroupsMapping</value>
		</param>
		<param>
			<name>hadoop.security.group.mapping.ldap.bind.user</name>
			<value>uid=ldapadmin,ou=users,dc=cloudair,dc=lan</value>
		</param>
		<param>
			<name>hadoop.security.group.mapping.ldap.bind.password</name>
			<value>BadPass%1</value>
		</param>
		<param>
			<name>hadoop.security.group.mapping.ldap.url</name>
			<value>ldap://infra01.cloudair.lan:389</value>
		</param>
		<param>
			<name>hadoop.security.group.mapping.ldap.base</name>
			<value></value>
		</param>
		<param>
			<name>hadoop.security.group.mapping.ldap.search.filter.user</name>
			<value>(&amp;(|(objectclass=posixAccount)(objectclass=inetOrgPerson))(cn={0}))</value>
		</param>
		<param>
			<name>hadoop.security.group.mapping.ldap.search.filter.group</name>
			<value>(objectclass=posixGroup)</value>
		</param>
		<param>
			<name>hadoop.security.group.mapping.ldap.search.attr.member</name>
			<value>memberuid</value>
		</param>
		<param>
			<name>hadoop.security.group.mapping.ldap.search.attr.group.name</name>
			<value>cn</value>
		</param>
	</provider>
    </gateway>

	<service>
 		<role>KNOX</role>
	</service>
</topology>
