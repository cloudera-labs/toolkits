{"paragraphs":[{"text":"%md\n# About\n**Lab:** Querying Tables and Views with SQL\n**Objective:**\n**File locations:**\n    Local: /home/devuser/data/telco/accountdevice\n    Hive Tables: telco.accounts\n\n**Successful outcome:** Use the Catalog API to explore Hive tables, create DataFrames by executing SQL queries, and work with temporary views.\n**Before you begin:** \n**Related lessons:** \n\n---","user":"sysadmin","dateUpdated":"2020-06-10T20:13:14+0000","config":{"tableHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>About</h1>\n<p><strong>Lab:</strong> Querying Tables and Views with SQL\n<br  /><strong>Objective:</strong> <em>Bold description</em>\n<br  /><strong>File locations:</strong></p>\n<pre><code>Local: $DEVDATA/accountdevice\nHive Tables: devsh.accounts\n</code></pre>\n<p><strong>Successful outcome:</strong> Use the Catalog API to explore Hive tables, create DataFrames by executing SQL queries, and work with temporary views.\n<br  /><strong>Before you begin:</strong>\n<br  /><strong>Related lessons:</strong></p>\n<hr />\n"}]},"apps":[],"jobName":"paragraph_1591819994267_309316857","id":"20181126-092644_1457476546","dateCreated":"2020-06-10T20:13:14+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:53"},{"text":"%md\n# Setup","user":"sysadmin","dateUpdated":"2020-06-10T20:13:14+0000","config":{"tableHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>Setup</h1>\n<p><strong>Important:</strong> This exercise depends on <strong><em> ***Insert previous exercise title here (with link?)*** </em></strong>. If you did not complete that exercise, run the course catch-up script and advance to the current exercise:</p>\n<pre><code>$ $DEVSH/scripts/catchup.sh\n</code></pre>\n"}]},"apps":[],"jobName":"paragraph_1591819994268_1784134802","id":"20181201-044336_178705192","dateCreated":"2020-06-10T20:13:14+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:54"},{"text":"%md\n# Lab\n","user":"sysadmin","dateUpdated":"2020-06-10T20:13:14+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>Lab</h1>\n"}]},"apps":[],"jobName":"paragraph_1591819994269_1759089399","id":"20181126-093358_358613711","dateCreated":"2020-06-10T20:13:14+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:55"},{"text":"%md\n### Show Tables and Columns Using the Catalog API","user":"sysadmin","dateUpdated":"2020-06-10T20:13:14+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Show Tables and Columns Using the Catalog API</h3>\n"}]},"apps":[],"jobName":"paragraph_1591819994269_11279378","id":"20200425-211825_1230755707","dateCreated":"2020-06-10T20:13:14+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:56"},{"title":"1 - View the current Hive tables and temporary views","text":"%md\nView the list of current Hive tables and temporary views in the `telco` database.\n\nThe list should include the `accounts` table.","user":"sysadmin","dateUpdated":"2020-06-10T20:13:14+0000","config":{"tableHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>View the list of current Hive tables and temporary views in the <code>devsh</code> database.</p>\n<p>The list should include the <code>accounts</code> table.</p>\n"}]},"apps":[],"jobName":"paragraph_1591819994270_1763093723","id":"20200425-204217_180178720","dateCreated":"2020-06-10T20:13:14+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:57"},{"text":"%spark2\nspark.catalog.listTables(\"telco\").show","user":"sysadmin","dateUpdated":"2020-06-10T20:13:14+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1591819994270_-750575597","id":"20200425-205151_147795731","dateCreated":"2020-06-10T20:13:14+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:58"},{"title":"2 - List the schema of the accounts table","text":"%md\nList the schema (column definitions) of the `telco.accounts` table.","user":"sysadmin","dateUpdated":"2020-06-10T20:13:14+0000","config":{"tableHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h5>2)</h5>\n<p>List the schema (column definitions) of the <code>devsh.accounts</code> table.</p>\n"}]},"apps":[],"jobName":"paragraph_1591819994271_1299485322","id":"20200425-204217_1495631798","dateCreated":"2020-06-10T20:13:14+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:59"},{"text":"%spark2\nspark.catalog.listColumns(\"accounts\",\"telco\").show","user":"sysadmin","dateUpdated":"2020-06-10T20:13:14+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1591819994271_1892690902","id":"20200425-205839_923045469","dateCreated":"2020-06-10T20:13:14+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:60"},{"title":"3 - Create a DataFrame based on the accounts table","text":"%md\nCreate a new DataFrame based on the `telco.accounts` table, and confirm that its schema matches that of the column above.","user":"sysadmin","dateUpdated":"2020-06-10T20:13:14+0000","config":{"tableHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h4>3</h4>\n<p>Create a new DataFrame based on the <code>devsh.accounts</code> table, and confirm that its schema matches that of the column above.</p>\n"}]},"apps":[],"jobName":"paragraph_1591819994272_725571072","id":"20200425-204216_47253481","dateCreated":"2020-06-10T20:13:14+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:61"},{"text":"%spark2\n","user":"sysadmin","dateUpdated":"2020-06-10T20:13:14+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1591819994273_-1162045563","id":"20200425-205934_1028171688","dateCreated":"2020-06-10T20:13:14+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:62"},{"text":"%md\n### Perform a SQL Query on a Table","user":"sysadmin","dateUpdated":"2020-06-10T20:13:14+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Perform a SQL Query on a Table</h3>\n"}]},"apps":[],"jobName":"paragraph_1591819994273_518633588","id":"20200425-212714_1159161390","dateCreated":"2020-06-10T20:13:14+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:63"},{"title":"4 - Perform a SQL query on the accounts table","text":"%md\nCreate a new DataFrame by performing a simple SQL query on the `telco.accounts` table. Confirm that the schema and data are correct.","user":"sysadmin","dateUpdated":"2020-06-10T20:13:14+0000","config":{"tableHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h4>4)</h4>\n<p>Create a new DataFrame by performing a simple SQL query on the<code>devsh.accounts</code> table. Confirm that the schema and data are correct.</p>\n"}]},"apps":[],"jobName":"paragraph_1591819994274_-1517266582","id":"20200425-204214_2011765789","dateCreated":"2020-06-10T20:13:14+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:64"},{"text":"%spark2\nval firstLastDF = spark.sql(\"SELECT first_name,last_name FROM telco.accounts\")","user":"sysadmin","dateUpdated":"2020-06-10T20:13:14+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1591819994274_-339421179","id":"20200425-210133_1271266054","dateCreated":"2020-06-10T20:13:14+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:65"},{"title":"5 - Compare the results of the SQL query from above to the equivalent query using the DataFrame API","text":"%md\n*Optional:* Perform the equivalent query using the DataFrame API, and compare the schema and data in the results to those of the query above.","user":"sysadmin","dateUpdated":"2020-06-10T20:13:14+0000","config":{"tableHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h4>5)</h4>\n<p><em>Optional:</em> Perform the equivalent query using the DataFrame API, and compare the\n<br  />schema and data in the results to those of the query above.</p>\n"}]},"apps":[],"jobName":"paragraph_1591819994275_-200852641","id":"20200425-204209_844636626","dateCreated":"2020-06-10T20:13:14+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:66"},{"text":"%spark2\n","user":"sysadmin","dateUpdated":"2020-06-10T20:13:14+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1591819994275_348093231","id":"20200425-210250_2016844228","dateCreated":"2020-06-10T20:13:14+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:67"},{"text":"%md\n### Create and Query a View","user":"sysadmin","dateUpdated":"2020-06-10T20:13:14+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Create and Query a View</h3>\n"}]},"apps":[],"jobName":"paragraph_1591819994275_-291323686","id":"20200425-212910_1802330108","dateCreated":"2020-06-10T20:13:14+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:68"},{"title":"6 - Create a DataFrame based on the account device data","text":"%md\nCreate a DataFrame called `accountDeviceDF` based on the CSV files in `/user/zeppelin/accountdevice`. (Be sure to use the headers and inferred schema to determine the column names and types.)","user":"sysadmin","dateUpdated":"2020-06-10T20:13:14+0000","config":{"tableHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Create a DataFrame called <code>accountDeviceDF</code> based on the CSV files in <code>/devsh_loudacre/accountdevice</code>. (Be sure to use the headers and inferred schema to determine the column names and types.)</p>\n"}]},"apps":[],"jobName":"paragraph_1591819994276_399688540","id":"20200425-212936_798549669","dateCreated":"2020-06-10T20:13:14+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:69"},{"text":"%spark2\n","user":"sysadmin","dateUpdated":"2020-06-10T20:13:14+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1591819994276_-1928399298","id":"20200425-210420_595158875","dateCreated":"2020-06-10T20:13:14+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:70"},{"title":"7 - Create a temporary view","text":"%md\nCreate a temporary view on the `accountDeviceDF` DataFrame called `account_dev`.","user":"sysadmin","dateUpdated":"2020-06-10T20:13:14+0000","config":{"tableHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h4>7)</h4>\n<p>Create a temporary view on the <code>accountDeviceDF</code> DataFrame called\n<br  /><code>account_dev</code>.</p>\n"}]},"apps":[],"jobName":"paragraph_1591819994277_1558046104","id":"20200425-210413_1790340597","dateCreated":"2020-06-10T20:13:14+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:71"},{"text":"%spark2\n","user":"sysadmin","dateUpdated":"2020-06-10T20:13:14+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1591819994277_-1795202835","id":"20200425-210533_34707541","dateCreated":"2020-06-10T20:13:14+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:72"},{"title":"8 - List the tables and views in the devsh database","text":"%md\nConfirm the view was created correctly by listing the tables and views in the `devsh` database as you did earlier. Notice that the `account_dev` table type is `TEMPORARY`.","user":"sysadmin","dateUpdated":"2020-06-10T20:13:14+0000","config":{"tableHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h4>8)</h4>\n<p>Confirm the view was created correctly by listing the tables and views in the\n<br  />devsh database as you did earlier. Notice that the <code>account_dev</code> table type is\n<br  /><code>TEMPORARY</code>.</p>\n"}]},"apps":[],"jobName":"paragraph_1591819994278_1409971568","id":"20200425-210412_35375447","dateCreated":"2020-06-10T20:13:14+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:73"},{"text":"%pyspark\n","user":"sysadmin","dateUpdated":"2020-06-10T20:13:14+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1591819994278_-350731264","id":"20200425-210629_2011533386","dateCreated":"2020-06-10T20:13:14+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:74"},{"title":"9 - Use a SQL query to create a new DataFrame","text":"%md\nUsing a SQL query, create a new DataFrame based on the first five rows of the account_dev view, and display the results.","user":"sysadmin","dateUpdated":"2020-06-10T20:13:14+0000","config":{"tableHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<pre><code>    &gt; spark.sql(\"SELECT * FROM account_dev LIMIT 5\").show()\n</code></pre>\n"}]},"apps":[],"jobName":"paragraph_1591819994279_114220557","id":"20200425-204208_966046944","dateCreated":"2020-06-10T20:13:14+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:75"},{"text":"%spark2\nspark.sql(\"SELECT * FROM account_dev LIMIT 5\").show()","user":"sysadmin","dateUpdated":"2020-06-10T20:13:14+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1591819994279_-518461874","id":"20200425-210735_2037261450","dateCreated":"2020-06-10T20:13:14+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:76"},{"text":"%md\n### Use SQL to Join Two Tables","user":"sysadmin","dateUpdated":"2020-06-10T20:13:14+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Use SQL to Join Two Tables</h3>\n"}]},"apps":[],"jobName":"paragraph_1591819994280_1491457037","id":"20200425-204207_2008963040","dateCreated":"2020-06-10T20:13:14+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:77"},{"title":"10 - Join the accounts table and the account_dev view","text":"%md\nJoin the `telco.accounts` table and `account_dev` view using the account ID, and display the results.\n(Note that the SQL string in the command below must be entered on a single line in the Spark shell.)","user":"sysadmin","dateUpdated":"2020-06-10T20:13:14+0000","config":{"tableHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>(Note that the SQL string in the command below must be entered on a single line in the Spark shell.)</p>\n"}]},"apps":[],"jobName":"paragraph_1591819994280_1094027591","id":"20200425-213619_1400283766","dateCreated":"2020-06-10T20:13:14+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:78"},{"text":"%spark2\nval nameDevDF = spark.sql(\"SELECT acct_num,\nfirst_name, last_name, account_device_id FROM\ndevsh.accounts JOIN account_dev ON acct_num =\naccount_id\")\n\nnameDevDF.show","user":"sysadmin","dateUpdated":"2020-06-10T20:13:14+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1591819994280_-1059935880","id":"20200425-213832_715963491","dateCreated":"2020-06-10T20:13:14+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:79"},{"title":"11 - Save the new DataFrame as a Hive table","text":"%md\nSave `nameDevDF` as a Hive table in the devsh called `name_dev` (with the file path as `/user/zeppelin/hive/name_dev`).","user":"sysadmin","dateUpdated":"2020-06-10T20:13:14+0000","config":{"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1591819994289_1711161515","id":"20200425-213617_1311161101","dateCreated":"2020-06-10T20:13:14+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:80"},{"text":"%spark2\n","user":"sysadmin","dateUpdated":"2020-06-10T20:13:14+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1591819994290_799035985","id":"20200425-214311_1714837796","dateCreated":"2020-06-10T20:13:14+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:81"},{"title":"12 - Use the Catalog API to confirm the table was created correctly","text":"%md\nUse the Catalog API to confirm that the table was created correctly with the right schema.","user":"sysadmin","dateUpdated":"2020-06-10T20:13:14+0000","config":{"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1591819994290_-852167689","id":"20200425-213616_41530436","dateCreated":"2020-06-10T20:13:14+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:82"},{"text":"%spark2\n","user":"sysadmin","dateUpdated":"2020-06-10T20:13:14+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1591819994291_-473488660","id":"20200425-214333_82825593","dateCreated":"2020-06-10T20:13:14+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:83"},{"title":"13 - Verify that the name_dev table exists in the Hive metastore","text":"%md\n*Optional:* If you are familiar with using Hive, verify that the `telco.name_dev` table now exists in the Hive metastore.","user":"sysadmin","dateUpdated":"2020-06-10T20:13:14+0000","config":{"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1591819994291_1182085188","id":"20200425-213615_1430154858","dateCreated":"2020-06-10T20:13:14+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:84"},{"text":"%jdbc(hive)\n","user":"sysadmin","dateUpdated":"2020-06-10T20:13:14+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1591819994292_-1085499383","id":"20200425-214359_2065545271","dateCreated":"2020-06-10T20:13:14+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:85"},{"title":"14 - Confirm that the account_dev view is temporary","text":"%md\n*Optional:* Exit and restart the shell and confirm that the `account_dev` temporary view is no longer available.","user":"sysadmin","dateUpdated":"2020-06-10T20:13:14+0000","config":{"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1591819994293_-511889974","id":"20200425-213613_1242953185","dateCreated":"2020-06-10T20:13:14+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:86"},{"text":"%spark2\n","user":"sysadmin","dateUpdated":"2020-06-10T20:13:14+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1591819994294_-256401304","id":"20200425-214347_1897482092","dateCreated":"2020-06-10T20:13:14+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:87"},{"text":"%md\n# Result\n**You have now:** \n\n---","user":"sysadmin","dateUpdated":"2020-06-10T20:13:14+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>Result</h1>\n<p><strong>You have now:</strong></p>\n<hr />\n"}]},"apps":[],"jobName":"paragraph_1591819994294_2110919456","id":"20181126-133507_1472573213","dateCreated":"2020-06-10T20:13:14+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:88"},{"text":"%md\n# Solution\n---\n\nIf not uploaded previously: \n\n    $ hdfs dfs -put /user/devuser/data/telco/accountdevice /user/zeppelin/","user":"sysadmin","dateUpdated":"2020-06-10T20:13:14+0000","config":{"tableHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>Solution</h1>\n<hr />\n<p>If not uploaded previously:</p>\n<pre><code>$ hdfs dfs -put $DEVDATA/accountdevice /devsh_loudacre/\n</code></pre>\n"}]},"apps":[],"jobName":"paragraph_1591819994294_-165896724","id":"20181018-125200_1133281582","dateCreated":"2020-06-10T20:13:14+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:89"},{"text":"%sh\nhdfs dfs -ls /user/zeppelin/accountdevice/","user":"sysadmin","dateUpdated":"2020-06-10T23:47:47+0000","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Found 3 items\n-rw-r--r--   3 zeppelin hdfs        212 2020-06-10 18:03 /user/zeppelin/accountdevice/._part-00000-f3b62dad-1054-4b2e-81fd-26e54c2ae76a.csv\ndrwxr-xr-x   - zeppelin hdfs          0 2020-06-10 23:05 /user/zeppelin/accountdevice/accountdevice\n-rw-r--r--   3 zeppelin hdfs   12928268 2020-06-10 18:03 /user/zeppelin/accountdevice/part-00000-f3b62dad-1054-4b2e-81fd-26e54c2ae76a.csv\n"}]},"apps":[],"jobName":"paragraph_1591819994295_-1847585279","id":"20200531-184032_378921030","dateCreated":"2020-06-10T20:13:14+0000","dateStarted":"2020-06-10T23:47:47+0000","dateFinished":"2020-06-10T23:47:49+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:90"},{"title":"1 - View the list of current Hive tables and temporary views","text":"%spark2\nspark.catalog.listTables(\"telco\").show","user":"sysadmin","dateUpdated":"2020-06-10T23:47:58+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------+--------+-----------+---------+-----------+\n|       name|database|description|tableType|isTemporary|\n+-----------+--------+-----------+---------+-----------+\n|   accounts|   telco|       null| EXTERNAL|      false|\n|   name_dev|   telco|       null| EXTERNAL|      false|\n|account_dev|    null|       null|TEMPORARY|       true|\n+-----------+--------+-----------+---------+-----------+\n\n"}]},"apps":[],"jobName":"paragraph_1591819994296_1908371315","id":"20200426-000605_1224242785","dateCreated":"2020-06-10T20:13:14+0000","dateStarted":"2020-06-10T23:47:58+0000","dateFinished":"2020-06-10T23:47:58+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:91"},{"title":"2 - List the schema of the accounts table","text":"%spark2\nspark.catalog.listColumns(\"telco\",\"accounts\").show","user":"sysadmin","dateUpdated":"2020-06-10T23:48:06+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------+-----------+---------+--------+-----------+--------+\n|          name|description| dataType|nullable|isPartition|isBucket|\n+--------------+-----------+---------+--------+-----------+--------+\n|      acct_num|       null|      int|    true|      false|   false|\n|acct_create_dt|       null|timestamp|    true|      false|   false|\n| acct_close_dt|       null|timestamp|    true|      false|   false|\n|    first_name|       null|   string|    true|      false|   false|\n|     last_name|       null|   string|    true|      false|   false|\n|       address|       null|   string|    true|      false|   false|\n|          city|       null|   string|    true|      false|   false|\n|         state|       null|   string|    true|      false|   false|\n|       zipcode|       null|   string|    true|      false|   false|\n|  phone_number|       null|   string|    true|      false|   false|\n|       created|       null|timestamp|    true|      false|   false|\n|      modified|       null|timestamp|    true|      false|   false|\n+--------------+-----------+---------+--------+-----------+--------+\n\n"}]},"apps":[],"jobName":"paragraph_1591819994297_-639632130","id":"20200426-000959_248054979","dateCreated":"2020-06-10T20:13:14+0000","dateStarted":"2020-06-10T23:48:06+0000","dateFinished":"2020-06-10T23:48:06+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:92"},{"title":"3 - Create a new DataFrame based on the accounts table","text":"%spark2\nval accountsDF = spark.read.table(\"telco.accounts\")\naccountsDF.printSchema","user":"sysadmin","dateUpdated":"2020-06-10T23:48:09+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- acct_num: integer (nullable = true)\n |-- acct_create_dt: timestamp (nullable = true)\n |-- acct_close_dt: timestamp (nullable = true)\n |-- first_name: string (nullable = true)\n |-- last_name: string (nullable = true)\n |-- address: string (nullable = true)\n |-- city: string (nullable = true)\n |-- state: string (nullable = true)\n |-- zipcode: string (nullable = true)\n |-- phone_number: string (nullable = true)\n |-- created: timestamp (nullable = true)\n |-- modified: timestamp (nullable = true)\n\naccountsDF: org.apache.spark.sql.DataFrame = [acct_num: int, acct_create_dt: timestamp ... 10 more fields]\n"}]},"apps":[],"jobName":"paragraph_1591819994298_1886262425","id":"20200426-001108_1151276805","dateCreated":"2020-06-10T20:13:14+0000","dateStarted":"2020-06-10T23:48:10+0000","dateFinished":"2020-06-10T23:48:10+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:93"},{"text":"%md\n### Perform a SQL Query on a Table","user":"sysadmin","dateUpdated":"2020-06-10T20:13:14+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Perform a SQL Query on a Table</h3>\n"}]},"apps":[],"jobName":"paragraph_1591819994298_224256772","id":"20200429-043257_859043392","dateCreated":"2020-06-10T20:13:14+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:94"},{"title":"4 - Perform a SQL query on the accounts table","text":"%spark2\nval firstLastDF = spark.sql(\"SELECT first_name,last_name FROM telco.accounts\")\nfirstLastDF.printSchema\nfirstLastDF.show(5)","user":"sysadmin","dateUpdated":"2020-06-10T23:48:14+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- first_name: string (nullable = true)\n |-- last_name: string (nullable = true)\n\n+----------+---------+\n|first_name|last_name|\n+----------+---------+\n|    Donald|   Becton|\n|     Donna|    Jones|\n|    Dorthy| Chalmers|\n|     Leila|  Spencer|\n|     Anita| Laughlin|\n+----------+---------+\nonly showing top 5 rows\n\nfirstLastDF: org.apache.spark.sql.DataFrame = [first_name: string, last_name: string]\n"}]},"apps":[],"jobName":"paragraph_1591819994299_-903245647","id":"20200429-043256_1081078145","dateCreated":"2020-06-10T20:13:14+0000","dateStarted":"2020-06-10T23:48:14+0000","dateFinished":"2020-06-10T23:48:14+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:95"},{"title":"5 - Compare the results of the SQL query from above to the equivalent query using the DataFrame API","text":"%spark2\nval firstLastDF2 = accountsDF.select(\"first_name\",\"last_name\")\nfirstLastDF2.printSchema\nfirstLastDF2.show(5)","user":"sysadmin","dateUpdated":"2020-06-10T23:48:17+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- first_name: string (nullable = true)\n |-- last_name: string (nullable = true)\n\n+----------+---------+\n|first_name|last_name|\n+----------+---------+\n|    Donald|   Becton|\n|     Donna|    Jones|\n|    Dorthy| Chalmers|\n|     Leila|  Spencer|\n|     Anita| Laughlin|\n+----------+---------+\nonly showing top 5 rows\n\nfirstLastDF2: org.apache.spark.sql.DataFrame = [first_name: string, last_name: string]\n"}]},"apps":[],"jobName":"paragraph_1591819994300_431269878","id":"20200429-043254_742596193","dateCreated":"2020-06-10T20:13:14+0000","dateStarted":"2020-06-10T23:48:17+0000","dateFinished":"2020-06-10T23:48:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:96"},{"text":"%md\n### Create and Query a View","user":"sysadmin","dateUpdated":"2020-06-10T20:13:14+0000","config":{"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1591819994300_911727784","id":"20200429-043252_1665886003","dateCreated":"2020-06-10T20:13:14+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:97"},{"title":"6 - Create a DataFrame based on the account device data","text":"%spark2\nval accountDeviceDF = spark.read.option(\"header\",\"true\").option(\"inferSchema\",\"true\").csv(\"/user/zeppelin/accountdevice\")","user":"sysadmin","dateUpdated":"2020-06-10T23:48:23+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"accountDeviceDF: org.apache.spark.sql.DataFrame = [id: int, account_id: int ... 3 more fields]\n"}]},"apps":[],"jobName":"paragraph_1591819994301_1454110924","id":"20200429-043252_506101829","dateCreated":"2020-06-10T20:13:14+0000","dateStarted":"2020-06-10T23:48:23+0000","dateFinished":"2020-06-10T23:48:23+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:98"},{"title":"7 - Create a temporary view","text":"%spark2\naccountDeviceDF.createOrReplaceTempView(\"account_dev\")","user":"sysadmin","dateUpdated":"2020-06-10T23:48:25+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1591819994302_1361539296","id":"20200429-043250_1737448514","dateCreated":"2020-06-10T20:13:14+0000","dateStarted":"2020-06-10T23:48:25+0000","dateFinished":"2020-06-10T23:48:25+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:99"},{"title":"8 - List the tables and views in the devsh database","text":"%spark2\nspark.catalog.listTables(\"telco\").show","user":"sysadmin","dateUpdated":"2020-06-10T23:48:28+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------+--------+-----------+---------+-----------+\n|       name|database|description|tableType|isTemporary|\n+-----------+--------+-----------+---------+-----------+\n|   accounts|   telco|       null| EXTERNAL|      false|\n|   name_dev|   telco|       null| EXTERNAL|      false|\n|account_dev|    null|       null|TEMPORARY|       true|\n+-----------+--------+-----------+---------+-----------+\n\n"}]},"apps":[],"jobName":"paragraph_1591819994303_-839022563","id":"20200429-044141_1658573369","dateCreated":"2020-06-10T20:13:14+0000","dateStarted":"2020-06-10T23:48:28+0000","dateFinished":"2020-06-10T23:48:28+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:100"},{"title":"9 - Use a SQL query to create a new DataFrame","text":"%spark2\nspark.sql(\"SELECT * FROM account_dev LIMIT 5\").show","user":"sysadmin","dateUpdated":"2020-06-10T23:48:33+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------+----------+---------+---------------+--------------------+\n|    id|account_id|device_id|activation_date|   account_device_id|\n+------+----------+---------+---------------+--------------------+\n|130116|     86733|       36|  1378430416000|adf4b0aa-5ccd-416...|\n|130117|     86733|       29|  1388563821000|a87910b7-2f14-4d8...|\n|130118|     86734|       23|  1372509401000|6dac114d-0241-4e4...|\n|130119|     86734|       29|  1384441155000|cc1ead51-da1a-461...|\n|130120|     86735|       33|  1376460017000|2c2332a8-55c6-4ae...|\n+------+----------+---------+---------------+--------------------+\n\n"}]},"apps":[],"jobName":"paragraph_1591819994304_166980877","id":"20200429-044140_1395210650","dateCreated":"2020-06-10T20:13:14+0000","dateStarted":"2020-06-10T23:48:33+0000","dateFinished":"2020-06-10T23:48:33+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:101"},{"text":"%md\n### Use SQL to Join Two Tables","user":"sysadmin","dateUpdated":"2020-06-10T20:13:14+0000","config":{"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1591819994304_-450105088","id":"20200429-044138_1651579672","dateCreated":"2020-06-10T20:13:14+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:102"},{"title":"10 - Join the accounts table and the account_dev view","text":"%spark2\nval nameDevDF = spark.sql(\"SELECT acct_num, first_name, last_name, account_device_id FROM telco.accounts JOIN account_dev ON acct_num = account_id\")\nnameDevDF.show","user":"sysadmin","dateUpdated":"2020-06-10T23:48:35+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------+----------+---------+--------------------+\n|acct_num|first_name|last_name|   account_device_id|\n+--------+----------+---------+--------------------+\n|       1|    Donald|   Becton|20b671b4-2467-42d...|\n|       1|    Donald|   Becton|7eb61253-55cd-430...|\n|       2|     Donna|    Jones|658e3fac-8e85-40e...|\n|       3|    Dorthy| Chalmers|fb674b1b-135e-408...|\n|       4|     Leila|  Spencer|c0b0c922-7fd4-46b...|\n|       5|     Anita| Laughlin|e054dafa-88b8-41e...|\n|       5|     Anita| Laughlin|b72a7271-864e-46d...|\n|       6|    Stevie|   Bridge|7d11b8e3-d67d-45f...|\n|       7|     David|   Eggers|98428e3a-bfb0-487...|\n|       8|   Dorothy|  Koopman|c49c4f82-9e22-4b3...|\n|       8|   Dorothy|  Koopman|58830f32-8a63-4af...|\n|       9|      Kara|     Kohl|5266e928-9304-4ee...|\n|       9|      Kara|     Kohl|45fe71c6-c56f-435...|\n|      10|     Diane|   Nelson|27bdf2f3-82a2-48d...|\n|      10|     Diane|   Nelson|ece98119-a036-400...|\n|      11|    Robert|   Fisher|678dc546-57ca-47f...|\n|      12|    Marcia|  Roberts|71520a12-112e-448...|\n|      12|    Marcia|  Roberts|2c3fb6f8-14bb-43f...|\n|      13|    Andres|    Cruse|d7768cd0-b17b-4e0...|\n|      13|    Andres|    Cruse|9163f7b0-9957-47f...|\n+--------+----------+---------+--------------------+\nonly showing top 20 rows\n\nnameDevDF: org.apache.spark.sql.DataFrame = [acct_num: int, first_name: string ... 2 more fields]\n"}]},"apps":[],"jobName":"paragraph_1591819994305_-2012657799","id":"20200429-044432_481513618","dateCreated":"2020-06-10T20:13:14+0000","dateStarted":"2020-06-10T23:48:35+0000","dateFinished":"2020-06-10T23:48:35+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:103"},{"title":"11 - Save the new DataFrame as a Hive table","text":"%spark2\nnameDevDF.write.option(\"path\",\"/user/zeppelin/hive/name_dev\").saveAsTable(\"telco.name_dev\")","user":"sysadmin","dateUpdated":"2020-06-10T23:48:40+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"org.apache.spark.sql.AnalysisException: Table `telco`.`name_dev` already exists.;\n  at org.apache.spark.sql.DataFrameWriter.saveAsTable(DataFrameWriter.scala:408)\n  at org.apache.spark.sql.DataFrameWriter.saveAsTable(DataFrameWriter.scala:393)\n  ... 51 elided\n"}]},"apps":[],"jobName":"paragraph_1591819994306_-139115821","id":"20200429-044430_1872152104","dateCreated":"2020-06-10T20:13:14+0000","dateStarted":"2020-06-10T23:48:40+0000","dateFinished":"2020-06-10T23:48:41+0000","status":"ERROR","progressUpdateIntervalMs":500,"$$hashKey":"object:104"},{"title":"12 - Use the Catalog API to confirm the table was created correctly","text":"%spark2\nspark.catalog.listTables(\"telco\").show\nspark.sql(\"DESCRIBE telco.name_dev\").show","user":"sysadmin","dateUpdated":"2020-06-10T23:48:43+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------+--------+-----------+---------+-----------+\n|       name|database|description|tableType|isTemporary|\n+-----------+--------+-----------+---------+-----------+\n|   accounts|   telco|       null| EXTERNAL|      false|\n|   name_dev|   telco|       null| EXTERNAL|      false|\n|account_dev|    null|       null|TEMPORARY|       true|\n+-----------+--------+-----------+---------+-----------+\n\n+-----------------+---------+-------+\n|         col_name|data_type|comment|\n+-----------------+---------+-------+\n|         acct_num|      int|   null|\n|       first_name|   string|   null|\n|        last_name|   string|   null|\n|account_device_id|   string|   null|\n+-----------------+---------+-------+\n\n"}]},"apps":[],"jobName":"paragraph_1591819994306_-576330835","id":"20200429-044657_1007317987","dateCreated":"2020-06-10T20:13:14+0000","dateStarted":"2020-06-10T23:48:43+0000","dateFinished":"2020-06-10T23:48:43+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:105"},{"title":"13 - Verify that the name_dev table exists in the Hive metastore","text":"%jdbc(hive)\nSHOW TABLES FROM telco","user":"sysadmin","dateUpdated":"2020-06-10T23:48:48+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"tab_name":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"tab_name\naccounts\nname_dev\n"}]},"apps":[],"jobName":"paragraph_1591819994307_1290965573","id":"20200429-044653_230397289","dateCreated":"2020-06-10T20:13:14+0000","dateStarted":"2020-06-10T23:48:48+0000","dateFinished":"2020-06-10T23:48:48+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:106"},{"title":"14 - Confirm that the account_dev view is temporary","text":"%spark2\nspark.catalog.listTables(\"telco\").show","user":"sysadmin","dateUpdated":"2020-06-10T23:48:53+0000","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------+--------+-----------+---------+-----------+\n|       name|database|description|tableType|isTemporary|\n+-----------+--------+-----------+---------+-----------+\n|   accounts|   telco|       null| EXTERNAL|      false|\n|   name_dev|   telco|       null| EXTERNAL|      false|\n|account_dev|    null|       null|TEMPORARY|       true|\n+-----------+--------+-----------+---------+-----------+\n\n"}]},"apps":[],"jobName":"paragraph_1591819994308_1959053625","id":"20200429-044651_1860942540","dateCreated":"2020-06-10T20:13:14+0000","dateStarted":"2020-06-10T23:48:53+0000","dateFinished":"2020-06-10T23:48:53+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:107"},{"text":"%md\nWe hope you've enjoyed this lab. Below are additional resources that you should find useful:\n\n1. [Hortonworks Apache Spark Tutorials](http://hortonworks.com/tutorials/#tuts-developers) are your natural next step where you can explore Spark in more depth.\n2. [Hortonworks Community Connection (HCC)](https://community.hortonworks.com/spaces/85/data-science.html?type=question) is a great resource for questions and answers on Spark, Data Analytics/Science, and many more Big Data topics.\n3. [Hortonworks Apache Spark Docs](https://docs.hortonworks.com/HDPDocuments/HDP3/HDP-3.0.1/spark-overview/content/analyzing_data_with_apache_spark.html) - official Spark documentation.\n4. [Hortonworks Apache Zeppelin Docs](https://docs.hortonworks.com/HDPDocuments/HDP3/HDP-3.0.1/zeppelin-overview/content/overview.html) - official Zeppelin documentation.\n","user":"sysadmin","dateUpdated":"2020-06-10T20:13:14+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>We hope you've enjoyed this lab. Below are additional resources that you should find useful:</p>\n<ol>\n<li><a href=\"http://hortonworks.com/tutorials/#tuts-developers\">Hortonworks Apache Spark Tutorials</a> are your natural next step where you can explore Spark in more depth.</li>\n<li><a href=\"https://community.hortonworks.com/spaces/85/data-science.html?type=question\">Hortonworks Community Connection (HCC)</a> is a great resource for questions and answers on Spark, Data Analytics/Science, and many more Big Data topics.</li>\n<li><a href=\"https://docs.hortonworks.com/HDPDocuments/HDP3/HDP-3.0.1/spark-overview/content/analyzing_data_with_apache_spark.html\">Hortonworks Apache Spark Docs</a> - official Spark documentation.</li>\n<li><a href=\"https://docs.hortonworks.com/HDPDocuments/HDP3/HDP-3.0.1/zeppelin-overview/content/overview.html\">Hortonworks Apache Zeppelin Docs</a> - official Zeppelin documentation.</li>\n</ol>\n"}]},"apps":[],"jobName":"paragraph_1591819994308_-876071337","id":"20181126-133017_244739700","dateCreated":"2020-06-10T20:13:14+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:108"}],"name":"ScalaSpark/10-QueryingTablesAndViewsWithSQL","id":"2FBEZP8EC","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"sh:shared_process":[],"jdbc:shared_process":[],"spark2:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}