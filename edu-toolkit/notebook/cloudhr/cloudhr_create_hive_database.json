{"paragraphs":[{"text":"%md\n# About This Exercise\n**Title:** Create Hive External Database cloudhr\n**Objective:** \n        Create a Hive external database\n**File locations:** No data\n**Successful outcome:** A Hive external database cloudhr\n**Before you begin:** N/A\n**Related lessons:** Ranger\n\n---","user":"allan_admin","dateUpdated":"2022-06-25T14:56:32-0700","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>About This Exercise</h1>\n<p><strong>Title:</strong> Create Hive External Database cloudhr\n<br  /><strong>Objective:</strong></p>\n<pre><code>    Create a Hive external database\n</code></pre>\n<p><strong>File locations:</strong> No data\n<br  /><strong>Successful outcome:</strong> A Hive external database cloudhr\n<br  /><strong>Before you begin:</strong> N/A\n<br  /><strong>Related lessons:</strong> Ranger</p>\n<hr />\n"}]},"apps":[],"jobName":"paragraph_1656194192490_928088279","id":"20181126-092644_1457476546","dateCreated":"2022-06-25T14:56:32-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:18247"},{"text":"%md\n# Setup","user":"allan_admin","dateUpdated":"2022-06-25T14:56:32-0700","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>Setup</h1>\n"}]},"apps":[],"jobName":"paragraph_1656194192491_1641076063","id":"20181201-044336_178705192","dateCreated":"2022-06-25T14:56:32-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:18248"},{"title":"1 - Selecting run options for the notebook","text":"%md\n\n####Option 1: Run all of the paragraphs by selecting the arrowhead on the top line menu.\n\n####Option 2: Run each paragraph one at a time by selecting the arrowhead on each paragraph.\n","user":"allan_admin","dateUpdated":"2022-06-25T14:57:46-0700","config":{"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"title":true,"results":{},"enabled":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h4>Option 1: Run all of the paragraphs by selecting the arrowhead on the top line menu.</h4>\n<h4>Option 2: Run each paragraph one at a time by selecting the arrowhead on each paragraph.</h4>\n"}]},"apps":[],"jobName":"paragraph_1656194192492_700390818","id":"20210502-211214_424378971","dateCreated":"2022-06-25T14:56:32-0700","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:18249","dateFinished":"2022-06-25T14:57:46-0700","dateStarted":"2022-06-25T14:57:46-0700"},{"text":"%md\n#Exercise\n","user":"allan_admin","dateUpdated":"2022-06-25T14:56:32-0700","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>Exercise</h1>\n"}]},"apps":[],"jobName":"paragraph_1656194192492_-1502377930","id":"20211017-151821_2147248195","dateCreated":"2022-06-25T14:56:32-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:18250"},{"title":"2 - Check status of databases","text":"%jdbc(hive)\n\nSHOW DATABASES;\n","user":"allan_admin","dateUpdated":"2022-06-25T14:56:32-0700","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"database_name":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}},"2":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"tab_name":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"database_name\nclouddev\nclouddev_stage\ncloudsale\ncloudsale_stage\ndefault\ninformation_schema\nsys\n"}]},"apps":[],"jobName":"paragraph_1656194192492_-1706354449","id":"20211021-145218_934287784","dateCreated":"2022-06-25T14:56:32-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:18251"},{"title":"3 - Create hive database cloudhr","text":"%jdbc(hive)\n\nDROP DATABASE IF EXISTS cloudhr CASCADE;\n\nCREATE DATABASE cloudhr\nLOCATION '/tenant/cloudhr/warehouse/tablespace/external/hive';\n\nALTER DATABASE cloudhr SET MANAGEDLOCATION 'hdfs://my-name-service/tenant/cloudhr/warehouse/tablespace/managed/hive/cloudhr.db';\n\nUSE cloudhr;\n\n\n","user":"allan_admin","dateUpdated":"2022-06-25T14:56:32-0700","config":{"tableHide":false,"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Query executed successfully. Affected rows : 0"},{"type":"TEXT","data":"Query executed successfully. Affected rows : 0"},{"type":"TEXT","data":"Query executed successfully. Affected rows : 0"},{"type":"TEXT","data":"Query executed successfully. Affected rows : 0"}]},"apps":[],"jobName":"paragraph_1656194192493_-1170722922","id":"20200522-200304_45153463","dateCreated":"2022-06-25T14:56:32-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:18252"},{"text":"%md\n\n#### Hive Database Property MANAGEDLOCATION\n\nThe property MANAGEDLOCATION must be set to a URI when you specify an alternate location for a managed database.\nDo NOT set LOCATION and MANAGEDLOCATION to the same HDFS Path. This will result in an error.\nIn Hive_on_Tez you must add the property metastore.warehouse.tenant.colocation=true to Hive Service Advanced Configuration \n(hive-site.xml).\n","user":"allan_admin","dateUpdated":"2022-06-25T14:56:32-0700","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h4>Hive Database Property MANAGEDLOCATION</h4>\n<p>The property MANAGEDLOCATION must be set to a URI when you specify an alternate location for a managed database.\n<br  />Do NOT set LOCATION and MANAGEDLOCATION to the same HDFS Path. This will result in an error.\n<br  />In Hive_on_Tez you must add the property metastore.warehouse.tenant.colocation=true to Hive Service Advanced Configuration\n<br  />(hive-site.xml).</p>\n"}]},"apps":[],"jobName":"paragraph_1656194192493_-1197184479","id":"20220312-134901_586376993","dateCreated":"2022-06-25T14:56:32-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:18253"},{"title":"4 - Create table claim_saving","text":"%jdbc(hive)\n\nDROP TABLE IF EXISTS cloudhr.claim_saving;\n\nCREATE EXTERNAL TABLE cloudhr.claim_saving(\n  claim_date DATE,\n  last_name STRING,\n  client_id INT,\n  claim_number INT,\n  claim_code DECIMAL(7,2),\n  claim_amount DECIMAL(7,2),\n  risk_factor DECIMAL(7,7),\n  claim_adjustment DECIMAL(7,2)\n  )\nROW FORMAT DELIMITED\nFIELDS TERMINATED BY ','\nLOCATION '/tenant/cloudhr/warehouse/tablespace/external/hive/cloudhr.db/claim_saving';\n","user":"allan_admin","dateUpdated":"2022-06-25T14:56:32-0700","config":{"tableHide":false,"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Query executed successfully. Affected rows : 0"},{"type":"TEXT","data":"Query executed successfully. Affected rows : 0"}]},"apps":[],"jobName":"paragraph_1656194192494_1514061076","id":"20191113-003528_2063258198","dateCreated":"2022-06-25T14:56:32-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:18254"},{"title":"5 - Create table employee","text":"%jdbc(hive)\n\nDROP TABLE IF EXISTS cloudhr.employee;\n\nCREATE EXTERNAL TABLE cloudhr.employee(\n  emp_id INT,\n  name STRING,\n  age INT,\n  telephone STRING,\n  email STRING,\n  birthday DATE,\n  country_code STRING,\n  salary DECIMAL(7,2)\n  )\nROW FORMAT DELIMITED\nFIELDS TERMINATED BY ','\nLOCATION '/tenant/cloudhr/warehouse/tablespace/external/hive/cloudhr.db/employee';\n\n","user":"allan_admin","dateUpdated":"2022-06-25T14:56:32-0700","config":{"tableHide":false,"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Query executed successfully. Affected rows : 0"},{"type":"TEXT","data":"Query executed successfully. Affected rows : 0"}]},"apps":[],"jobName":"paragraph_1656194192495_724721140","id":"20210502-232157_1931600493","dateCreated":"2022-06-25T14:56:32-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:18255"},{"title":"6 - Create table provider_summary","text":"%jdbc(hive)\n\nDROP TABLE IF EXISTS cloudhr.provider_summary;\n\nCREATE EXTERNAL TABLE cloudhr.provider_summary(\n    provider_id INT,\n    company_name STRING,\n    address STRING,\n    city STRING,\n    state_code STRING,\n    zip_code STRING,\n    regional_office STRING,\n    business_years INT,\n    claim_amount DECIMAL(7,2),\n    paid_amount DECIMAL(7,2),\n    adustment_amount DECIMAL(7,2)\n    )\nROW FORMAT DELIMITED\nFIELDS TERMINATED BY ','\nLOCATION '/tenant/cloudhr/warehouse/tablespace/external/hive/cloudhr.db/provider_summary';\n","user":"allan_admin","dateUpdated":"2022-06-25T14:56:32-0700","config":{"tableHide":false,"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Query executed successfully. Affected rows : 0"},{"type":"TEXT","data":"Query executed successfully. Affected rows : 0"}]},"apps":[],"jobName":"paragraph_1656194192495_3376075","id":"20210502-232658_1687940699","dateCreated":"2022-06-25T14:56:32-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:18256"},{"title":"7 - List cloudhr tables","text":"%jdbc(hive)\n\nUSE cloudhr;\nSHOW TABLES;\nDESCRIBE cloudhr.employee;\n","user":"allan_admin","dateUpdated":"2022-06-25T14:56:32-0700","config":{"tableHide":false,"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"tab_name":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}},"1":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"tab_name":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}},"2":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"col_name":"string","data_type":"string","comment":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Query executed successfully. Affected rows : 0"},{"type":"TABLE","data":"tab_name\nclaim_saving\nemployee\nprovider_summary\n"},{"type":"TABLE","data":"col_name\tdata_type\tcomment\nemp_id\tint\t\nname\tstring\t\nage\tint\t\ntelephone\tstring\t\nemail\tstring\t\nbirthday\tdate\t\ncountry_code\tstring\t\nsalary\tdecimal(7,2)\t\n"}]},"apps":[],"jobName":"paragraph_1656194192496_-149366584","id":"20210503-000413_174249195","dateCreated":"2022-06-25T14:56:32-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:18257"},{"text":"%md\n\n# Reset\n","user":"allan_admin","dateUpdated":"2022-06-25T14:56:32-0700","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>Reset</h1>\n"}]},"apps":[],"jobName":"paragraph_1656194192496_427360284","id":"20210503-201327_1691139602","dateCreated":"2022-06-25T14:56:32-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:18258"},{"title":"A - Drop database cloudhr ","text":"%jdbc(hive)\n\n--DROP DATABASE IF EXISTS cloudhr CASCADE;\n","user":"allan_admin","dateUpdated":"2022-06-25T14:58:04-0700","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1656194192496_-1424927888","id":"20210503-201344_78143625","dateCreated":"2022-06-25T14:56:32-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:18259"},{"title":"B - Delete data from cloudhr","text":"%sh\n\n#echo '${PASSWD}' | su -l denis_deng -c 'hdfs dfs -rm -r -skipTrash /tenant/cloudhr/warehouse/external/hive/cloudhr.db'\n","user":"allan_admin","dateUpdated":"2022-06-25T14:58:15-0700","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1656194192497_-1495604035","id":"20220312-134731_2010931021","dateCreated":"2022-06-25T14:56:32-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:18260"},{"text":"%angular\n","user":"allan_admin","dateUpdated":"2022-06-25T14:56:32-0700","config":{"editorSetting":{"language":"scala","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/undefined","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1656194192497_-601756335","id":"20191113-001039_505978317","dateCreated":"2022-06-25T14:56:32-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:18261"}],"name":"cloudhr/create_hive_database","id":"2H7P6DSP9","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"angular:shared_process":[],"sh:shared_process":[],"jdbc:shared_process":[],"livy:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}