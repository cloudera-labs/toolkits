{"paragraphs":[{"text":"%md\n# About This Lab\n**Lab:** Create Hive Staging Database \n**Objective:** Create a Hive staging database for Cloudfin, use Cloudfin.orc to create a production databasee\n**File locations:** hostname:~/data/cloudfin\n**Successful outcome:** Create hive staging database\n**Before you begin:** N/A\n**Related lessons:** Zeppelin\n\n---","user":"devuser","dateUpdated":"2021-06-11T14:30:39+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>About This Lab</h1>\n<p><strong>Lab:</strong> Create Hive Staging Database\n<br  /><strong>Objective:</strong> Create a Hive staging database for Cloudfin, use Cloudfin.orc to create a production databasee\n<br  /><strong>File locations:</strong> hostname:~/data/cloudfin\n<br  /><strong>Successful outcome:</strong> Create hive staging database\n<br  /><strong>Before you begin:</strong> N/A\n<br  /><strong>Related lessons:</strong> Zeppelin</p>\n<hr />\n"}]},"apps":[],"jobName":"paragraph_1623421839611_1591499504","id":"20181126-092644_1457476546","dateCreated":"2021-06-11T14:30:39+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:47043"},{"text":"%md\n# Setup","user":"devuser","dateUpdated":"2021-06-11T14:30:39+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>Setup</h1>\n"}]},"apps":[],"jobName":"paragraph_1623421839611_1996181322","id":"20181201-044336_178705192","dateCreated":"2021-06-11T14:30:39+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:47044"},{"title":"1 - List the cloudfin dataset","text":"%sh\n\nls /var/data/cloudfin\n","user":"devuser","dateUpdated":"2021-06-11T14:30:39+0000","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"claim_saving.tar.gz\nconsent_data.tar.gz\nemployee.tar.gz\neu_country.tar.gz\nprovider_summary.tar.gz\ntax.tar.gz\nus_customer.tar.gz\nww_customer.tar.gz\n"}]},"apps":[],"jobName":"paragraph_1623421839611_1806472742","id":"20210502-211214_424378971","dateCreated":"2021-06-11T14:30:39+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:47045"},{"title":"2 - Create tmp directory","text":"%sh\n\nrm -r /tmp/cloudfin\nmkdir /tmp/cloudfin\nls /tmp/cloudfin","user":"devuser","dateUpdated":"2021-06-11T14:30:39+0000","config":{"tableHide":false,"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1623421839612_-715095172","id":"20191018-102228_1632466399","dateCreated":"2021-06-11T14:30:39+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:47046"},{"title":"3 - Use tar to extract the gz files","text":"%sh\n\ntar -xvzf /var/data/cloudfin/claim_saving.tar.gz -C /tmp/cloudfin/\ntar -xvzf /var/data/cloudfin/consent_data.tar.gz -C /tmp/cloudfin/\ntar -xvzf /var/data/cloudfin/employee.tar.gz -C /tmp/cloudfin/\ntar -xvzf /var/data/cloudfin/eu_country.tar.gz -C /tmp/cloudfin/\ntar -xvzf /var/data/cloudfin/provider_summary.tar.gz -C /tmp/cloudfin/\ntar -xvzf /var/data/cloudfin/tax.tar.gz -C /tmp/cloudfin/\ntar -xvzf /var/data/cloudfin/us_customer.tar.gz -C /tmp/cloudfin/\ntar -xvzf /var/data/cloudfin/ww_customer.tar.gz -C /tmp/cloudfin/","user":"devuser","dateUpdated":"2021-06-11T14:30:39+0000","config":{"tableHide":false,"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"._claim_saving.csv\nclaim_saving.csv\n._consent_data.csv\nconsent_data.csv\n._employee.csv\nemployee.csv\n._employee_raw.csv\nemployee_raw.csv\n._eu_country.csv\neu_country.csv\n._provider_summary.csv\nprovider_summary.csv\n._tax_2016.csv\ntax_2016.csv\n._tax_2017.csv\ntax_2017.csv\n._tax_2018.csv\ntax_2018.csv\n._us_customer.csv\nus_customer.csv\n._ww_customer.csv\nww_customer.csv\n"}]},"apps":[],"jobName":"paragraph_1623421839612_-899657784","id":"20200521-081538_1699892026","dateCreated":"2021-06-11T14:30:39+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:47047"},{"title":"4 - List cloudfin data files","text":"%sh\n\nls /tmp/cloudfin","user":"devuser","dateUpdated":"2021-06-11T14:30:39+0000","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"claim_saving.csv\nconsent_data.csv\nemployee.csv\nemployee_raw.csv\neu_country.csv\nprovider_summary.csv\ntax_2016.csv\ntax_2017.csv\ntax_2018.csv\nus_customer.csv\nww_customer.csv\n"}]},"apps":[],"jobName":"paragraph_1623421839612_-183655412","id":"20210502-230558_788092507","dateCreated":"2021-06-11T14:30:39+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:47048"},{"title":"5 - Load datafiles into hdfs","text":"%sh\n\nhdfs dfs -mkdir /data/cloudfin\nhdfs dfs -put /tmp/cloudfin/* /data/cloudfin\nhdfs dfs -ls /data/cloudfin\n","user":"devuser","dateUpdated":"2021-06-11T14:30:39+0000","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Found 11 items\n-rw-r--r--   3 zeppelin hdfs       6930 2021-05-03 00:35 /data/cloudfin/claim_saving.csv\n-rw-r--r--   3 zeppelin hdfs    3303028 2021-05-03 00:35 /data/cloudfin/consent_data.csv\n-rw-r--r--   3 zeppelin hdfs       4009 2021-05-03 00:35 /data/cloudfin/employee.csv\n-rw-r--r--   3 zeppelin hdfs      11108 2021-05-03 00:35 /data/cloudfin/employee_raw.csv\n-rw-r--r--   3 zeppelin hdfs        440 2021-05-03 00:35 /data/cloudfin/eu_country.csv\n-rw-r--r--   3 zeppelin hdfs      11964 2021-05-03 00:35 /data/cloudfin/provider_summary.csv\n-rw-r--r--   3 zeppelin hdfs         85 2021-05-03 00:35 /data/cloudfin/tax_2016.csv\n-rw-r--r--   3 zeppelin hdfs         85 2021-05-03 00:35 /data/cloudfin/tax_2017.csv\n-rw-r--r--   3 zeppelin hdfs         85 2021-05-03 00:35 /data/cloudfin/tax_2018.csv\n-rw-r--r--   3 zeppelin hdfs   17889061 2021-05-03 00:35 /data/cloudfin/us_customer.csv\n-rw-r--r--   3 zeppelin hdfs   18240066 2021-05-03 00:35 /data/cloudfin/ww_customer.csv\n"}]},"apps":[],"jobName":"paragraph_1623421839612_-507984094","id":"20210503-003430_1572754620","dateCreated":"2021-06-11T14:30:39+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:47049"},{"title":"6 - Grant hive access to cloudfin","text":"%sh\n\nhdfs dfs -chmod -R 777 /data/cloudfin\n","user":"devuser","dateUpdated":"2021-06-11T14:30:39+0000","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1623421839612_1870750068","id":"20210503-012920_129199628","dateCreated":"2021-06-11T14:30:39+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:47050"},{"title":"6 - Create hive database for cloudfin ","text":"%jdbc(hive)\n\nDROP DATABASE IF EXISTS cloudfin CASCADE;\n\nCREATE DATABASE cloudfin;\nUSE cloudfin;","user":"devuser","dateUpdated":"2021-06-11T14:30:39+0000","config":{"tableHide":false,"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"}]},"apps":[],"jobName":"paragraph_1623421839612_844119958","id":"20200522-200304_45153463","dateCreated":"2021-06-11T14:30:39+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:47051"},{"title":"7 - Create table claim_saving_stage","text":"%jdbc(hive)\n\nDROP TABLE IF EXISTS cloudfin.claim_saving_stage;\n\nCREATE EXTERNAL TABLE cloudfin.claim_saving_stage(\n  claim_date DATE,\n  last_name STRING,\n  client_id INT,\n  claim_number INT,\n  claim_code DECIMAL(7,2),\n  claim_amount DECIMAL(7,2),\n  risk_factor DECIMAL(7,7),\n  claim_adjustment DECIMAL(7,2)\n  )\nROW FORMAT DELIMITED\nFIELDS TERMINATED BY ','\nLOCATION '/warehouse/tablespace/external/hive/cloudfin.db/claim_saving_stage';\n\nLOAD DATA INPATH '/data/cloudfin/claim_saving.csv' OVERWRITE INTO TABLE claim_saving_stage;","user":"devuser","dateUpdated":"2021-06-11T14:30:39+0000","config":{"tableHide":false,"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"}]},"apps":[],"jobName":"paragraph_1623421839612_-811250720","id":"20191113-003528_2063258198","dateCreated":"2021-06-11T14:30:39+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:47052"},{"title":"8 - Create table consent_data_stage","text":"%jdbc(hive)\n\nDROP TABLE IF EXISTS consent_data_stage;\n\nCREATE EXTERNAL TABLE consent_data_stage(\n  country_code STRING,\n  country STRING,\n  insurance_id INT,\n  marketing_consent STRING,\n  marketing_consent_start_date DATE,\n  loyalty_consent STRING,\n  loyalty_consent_start_date DATE,\n  third_party_consent STRING,\n  third_party_consent_start_date DATE\n  )\nROW FORMAT DELIMITED\nFIELDS TERMINATED BY ','\nLOCATION '/warehouse/tablespace/external/hive/cloudfin.db/consent_data_stage';\n\nLOAD DATA INPATH '/data/cloudfin/consent_data.csv' OVERWRITE INTO TABLE consent_data_stage;","user":"devuser","dateUpdated":"2021-06-11T14:30:39+0000","config":{"tableHide":false,"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"}]},"apps":[],"jobName":"paragraph_1623421839613_932682206","id":"20210502-231252_667055020","dateCreated":"2021-06-11T14:30:39+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:47053"},{"title":"9 - Create table employee_stage","text":"%jdbc(hive)\n\nDROP TABLE IF EXISTS employee_stage;\n\nCREATE EXTERNAL TABLE employee_stage(\n  emp_id INT,\n  name STRING,\n  age INT,\n  telephone STRING,\n  email STRING,\n  birthday DATE,\n  country_code STRING,\n  salary DECIMAL(7,2)\n  )\nROW FORMAT DELIMITED\nFIELDS TERMINATED BY ','\nLOCATION '/warehouse/tablespace/external/hive/cloudfin.db/employee_stage';\n\nLOAD DATA INPATH '/data/cloudfin/employee.csv' OVERWRITE INTO TABLE employee_stage;\n","user":"devuser","dateUpdated":"2021-06-11T14:30:39+0000","config":{"tableHide":false,"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"}]},"apps":[],"jobName":"paragraph_1623421839613_1159304534","id":"20210502-232157_1931600493","dateCreated":"2021-06-11T14:30:39+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:47054"},{"title":"10 - Create table eu_country_stage","text":"%jdbc(hive)\n\nDROP TABLE IF EXISTS eu_country_stage;\n\nCREATE EXTERNAL TABLE eu_country_stage(\n  country_name STRING,\n  country_code STRING,\n  region STRING\n  )\nROW FORMAT DELIMITED\nFIELDS TERMINATED BY ','\nLOCATION '/warehouse/tablespace/external/hive/cloudfin.db/eu_country_stage';\n\nLOAD DATA INPATH '/data/cloudfin/eu_country.csv' OVERWRITE INTO TABLE eu_country_stage;","user":"devuser","dateUpdated":"2021-06-11T14:30:39+0000","config":{"tableHide":false,"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"}]},"apps":[],"jobName":"paragraph_1623421839613_-16221314","id":"20210502-214603_2023028012","dateCreated":"2021-06-11T14:30:39+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:47055"},{"title":"11 - Create table provider_summary_stage","text":"%jdbc(hive)\n\nDROP TABLE IF EXISTS provider_summary_stage;\n\nCREATE EXTERNAL TABLE provider_summary_stage(\n    provider_id INT,\n    company_name STRING,\n    address STRING,\n    city STRING,\n    state_code STRING,\n    zip_code STRING,\n    regional_office STRING,\n    business_years INT,\n    claim_amount DECIMAL(7,2),\n    paid_amount DECIMAL(7,2),\n    adustment_amount DECIMAL(7,2)\n    )\nROW FORMAT DELIMITED\nFIELDS TERMINATED BY ','\nLOCATION '/warehouse/tablespace/external/hive/cloudfin.db/eu_country_stage';\n\nLOAD DATA INPATH '/data/cloudfin/provider_summary.csv' OVERWRITE INTO TABLE provider_summary_stage;","user":"devuser","dateUpdated":"2021-06-11T14:30:39+0000","config":{"tableHide":false,"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"}]},"apps":[],"jobName":"paragraph_1623421839613_-457004906","id":"20210502-232658_1687940699","dateCreated":"2021-06-11T14:30:39+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:47056"},{"title":"12 - Create table us_customer_stage","text":"%jdbc(hive)\n\nDROP TABLE IF EXISTS us_customer_stage;\n\nCREATE EXTERNAL TABLE us_customer_stage(\n    customer_id INT,\n    gender STRING,\n    title STRING,\n    first_name STRING,\n    middle_initial STRING,\n    last_name STRING,\n    address STRING,\n    city STRING,\n    state_code STRING,\n    state STRING,\n    zip_code STRING,\n    country_code STRING,\n    country STRING,\n    email STRING,\n    username STRING,\n    password STRING,\n    telephone STRING,\n    telephone_country_code STRING,\n    mother_maiden STRING,\n    birthday DATE,\n    age INT,\n    tropical_zodiac STRING,\n    cc_type STRING,\n    cc_number STRING,\n    cvv2 INT,\n    cc_expires DATE,\n    national_id STRING,\n    mrn STRING,\n    insurance_id INT,\n    eye_color STRING,\n    occupation STRING,\n    company STRING,\n    vehicle STRING,\n    domain STRING,\n    blood_type STRING,\n    weight NUMERIC (6, 2),\n    height NUMERIC (6, 2),\n    latitude NUMERIC (12, 8),\n    longitude NUMERIC (12, 8)\n    )\nROW FORMAT DELIMITED\nFIELDS TERMINATED BY ','\nLOCATION '/warehouse/tablespace/external/hive/cloudfin.db/us_customer_stage';\n\nLOAD DATA INPATH '/data/cloudfin/us_customer.csv' OVERWRITE INTO TABLE us_customer_stage;","user":"devuser","dateUpdated":"2021-06-11T14:30:39+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"}]},"apps":[],"jobName":"paragraph_1623421839613_1536917207","id":"20191113-002418_175307041","dateCreated":"2021-06-11T14:30:39+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:47057"},{"title":"13 - Create table ww_customer_stage","text":"%jdbc(hive)\n\nDROP TABLE IF EXISTS ww_customer_stage;\n\nCREATE EXTERNAL TABLE ww_customer_stage(\n    customr_id INT,\n    title STRING,\n    first_name STRING,\n    middle_initial STRING,\n    last_name STRING,\n    name_set STRING,\n    address STRING,\n    city STRING,\n    state_code STRING,\n    state STRING,\n    zip_code STRING,\n    country_code STRING,\n    country STRING,\n    telephone_country_code STRING,\n    telephone STRING,\n    email STRING,\n    username STRING,\n    password STRING,\n    national_id STRING,\n    mrn STRING,\n    insurance_id INT,\n    cc_type STRING,\n    cc_number STRING,\n    cvv2 INT,\n    cc_expires STRING,\n    occupation STRING,\n    company STRING,\n    domain STRING,\n    vehicle STRING,\n    gender STRING,\n    mothers_maiden STRING,\n    birthday STRING,\n    tropical_zodiac STRING,\n    age INT,\n    eye_color STRING,\n    blood_type STRING,\n    weight NUMERIC (6, 2),\n    height NUMERIC (6, 2),\n    latitude NUMERIC (12, 8),\n    longitude NUMERIC (12, 8)\n    )\nROW FORMAT DELIMITED\nFIELDS TERMINATED BY ','\nLOCATION '/warehouse/tablespace/external/hive/cloudfin.db/22_customer_stage';\n\nLOAD DATA INPATH '/data/cloudfin/ww_customer.csv' OVERWRITE INTO TABLE ww_customer_stage;","user":"devuser","dateUpdated":"2021-06-11T14:30:39+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"}]},"apps":[],"jobName":"paragraph_1623421839613_1942593668","id":"20191113-003110_460081162","dateCreated":"2021-06-11T14:30:39+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:47058"},{"title":"14 - List cloudfin tables","text":"%jdbc(hive)\n\nSHOW TABLES;\n","user":"devuser","dateUpdated":"2021-06-11T14:30:39+0000","config":{"tableHide":false,"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"tab_name":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"tab_name\nclaim_saving_stage\nconsent_data_stage\nemployee_stage\neu_country_stage\nprovider_summary_stage\nus_customer_stage\nww_customer_stage\n"}]},"apps":[],"jobName":"paragraph_1623421839613_-855103026","id":"20210503-000413_174249195","dateCreated":"2021-06-11T14:30:39+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:47059"},{"title":"15 - Confirm the tables have been loaded correctly","text":"%jdbc(hive)\n\nSELECT * FROM ww_customer_stage LIMIT 5;","user":"devuser","dateUpdated":"2021-06-11T14:30:39+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"ww_customer_stage.customr_id":"string","ww_customer_stage.title":"string","ww_customer_stage.first_name":"string","ww_customer_stage.middle_initial":"string","ww_customer_stage.last_name":"string","ww_customer_stage.name_set":"string","ww_customer_stage.address":"string","ww_customer_stage.city":"string","ww_customer_stage.state_code":"string","ww_customer_stage.state":"string","ww_customer_stage.zip_code":"string","ww_customer_stage.country_code":"string","ww_customer_stage.country":"string","ww_customer_stage.telephone_country_code":"string","ww_customer_stage.telephone":"string","ww_customer_stage.email":"string","ww_customer_stage.username":"string","ww_customer_stage.password":"string","ww_customer_stage.national_id":"string","ww_customer_stage.mrn":"string","ww_customer_stage.insurance_id":"string","ww_customer_stage.cc_type":"string","ww_customer_stage.cc_number":"string","ww_customer_stage.cvv2":"string","ww_customer_stage.cc_expires":"string","ww_customer_stage.occupation":"string","ww_customer_stage.company":"string","ww_customer_stage.domain":"string","ww_customer_stage.vehicle":"string","ww_customer_stage.gender":"string","ww_customer_stage.mothers_maiden":"string","ww_customer_stage.birthday":"string","ww_customer_stage.tropical_zodiac":"string","ww_customer_stage.age":"string","ww_customer_stage.eye_color":"string","ww_customer_stage.blood_type":"string","ww_customer_stage.weight":"string","ww_customer_stage.height":"string","ww_customer_stage.latitude":"string","ww_customer_stage.longitude":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"ww_customer_stage.customr_id\tww_customer_stage.title\tww_customer_stage.first_name\tww_customer_stage.middle_initial\tww_customer_stage.last_name\tww_customer_stage.name_set\tww_customer_stage.address\tww_customer_stage.city\tww_customer_stage.state_code\tww_customer_stage.state\tww_customer_stage.zip_code\tww_customer_stage.country_code\tww_customer_stage.country\tww_customer_stage.telephone_country_code\tww_customer_stage.telephone\tww_customer_stage.email\tww_customer_stage.username\tww_customer_stage.password\tww_customer_stage.national_id\tww_customer_stage.mrn\tww_customer_stage.insurance_id\tww_customer_stage.cc_type\tww_customer_stage.cc_number\tww_customer_stage.cvv2\tww_customer_stage.cc_expires\tww_customer_stage.occupation\tww_customer_stage.company\tww_customer_stage.domain\tww_customer_stage.vehicle\tww_customer_stage.gender\tww_customer_stage.mothers_maiden\tww_customer_stage.birthday\tww_customer_stage.tropical_zodiac\tww_customer_stage.age\tww_customer_stage.eye_color\tww_customer_stage.blood_type\tww_customer_stage.weight\tww_customer_stage.height\tww_customer_stage.latitude\tww_customer_stage.longitude\nnull\ttitle\tfirst_name\tmiddle_initial\tlast_name\tname_set\taddress\tcity\tstate_code\tstate\tzip_code\tcountry_code\tcountry\ttelephone_country_code\ttelephone\temail\tusername\tpassword\tnational_id\tmrn\tnull\tcc_type\tcc_number\tnull\tcc_expire\toccupation\tcompany\tdomain\tvehicle\tgender\tmothers_maiden\tbirthday\ttropical_zodiac\tnull\teye_color\tblood_type\tnull\tnull\tnull\tnull\n1\tMr.\tArton\tT\tHaralčić\tSlovenian\tΚαλαμπάκα 165\tΛΕΥΚΩΣΙΑ\tNI\tΛευκωσία\t1408\tCY\tCyprus (Greek)\t357\t96 816464\tArtonHaralcic@superrito.com\tDras1991\taiKueve8kiu\t\t4318875228\t67386695\tMasterCard\t5517118796282180\t927\t11/1/19\tTime recorder\tAlbers Super Markets\tDebtRide.com.cy\t1995 Auverland A3\tmale\tZelkanović\t8/13/91\tLeo\t24\tBlue\tA+\t176.00\t168.00\t41.32502000\t-72.91611800\n2\tMrs.\tManita\tB\tvan Schagen\tDutch\tBratří Čapků 977\tChoustníkovo Hradište\tKR\tKrálovéhradecký kraj\t544 42\tCZ\tCzech Republic\t420\t604 060 095\tManitavanSchagen@teleworm.us\tAncomp\tquohL5shah\t\t403525331\t91409513\tMasterCard\t5389357938317030\t572\t7/1/18\tFitness director\tPerisolution\tCardTribune.cz\t2012 SsangYong Rexton\tfemale\tAalbers\t3/19/85\tPisces\t31\tRed\tO+\t196.20\t174.00\t50.49016900\t15.80769400\n3\tMr.\tErick\tC\tBarbosa\tBrazil\tNaustavegur 1\tVestmannaeyjar\t\t\t900\tIS\tIceland\t354\t444 7196\tErickCastroBarbosa@fleckens.hu\tSelinglese92\tzoh8Reo0ohee\t\t5452976766\t59642070\tVisa\t4556802259095820\t430\t3/1/18\tLong haul truck driver\tMighty Casey's\tBizCrisis.is\t2008 Mitsubishi Colt\tmale\tPinto\t8/16/92\tLeo\t23\tRed\tAB+\t152.70\t167.00\t63.37348000\t-20.34295000\n4\tMrs.\tSaidah\tN\tShalhoub\tArabic\tGotzkowskystraße 37\tKamp-Lintfort\tNW\tNordrhein-Westfalen\t47475\tDE\tGermany\t49\t02842 15 14 33\tSaidahNadwahShalhoub@gustr.com\tBanstal\taikohxee5Oh\t\t1196601791\t90429306\tVisa\t4929601576702880\t532\t2/1/19\tLine repairer\tParts and Pieces\tTelevisionBroker.de\t1996 BMW 840\tfemale\tKouri\t9/29/43\tLibra\t72\tPurple\tA+\t214.70\t169.00\t51.49370500\t6.62336200\n"}]},"apps":[],"jobName":"paragraph_1623421839614_254611524","id":"20200524-044032_2016590824","dateCreated":"2021-06-11T14:30:39+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:47060"},{"text":"%md\n\n# Reset\n","user":"devuser","dateUpdated":"2021-06-11T14:30:39+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>Reset</h1>\n"}]},"apps":[],"jobName":"paragraph_1623421839614_50631727","id":"20210503-201327_1691139602","dateCreated":"2021-06-11T14:30:39+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:47061"},{"title":"1 - Drop database cloudfin and all tables","text":"%jdbc(hive)\n\nDROP DATABASE IF EXISTS cloudfin CASCADE;\n","user":"devuser","dateUpdated":"2021-06-11T14:30:39+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1623421839614_1255445023","id":"20210503-201344_78143625","dateCreated":"2021-06-11T14:30:39+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:47062"},{"title":"2 - Delete hdfs data dirctory","text":"%sh\n\nhdfs dfs -rm -r -skipTrash /data/cloudfin\n","user":"devuser","dateUpdated":"2021-06-11T14:30:39+0000","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1623421839614_1381920761","id":"20210503-201457_1083316257","dateCreated":"2021-06-11T14:30:39+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:47063"},{"title":"3 - Delete tmp directory","text":"%sh\n\nrm -r /tmp/cloudfin","user":"devuser","dateUpdated":"2021-06-11T14:30:39+0000","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1623421839614_-901483475","id":"20210503-201534_35323064","dateCreated":"2021-06-11T14:30:39+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:47064"},{"text":"%angular\n","user":"devuser","dateUpdated":"2021-06-11T14:30:39+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/undefined","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1623421839614_-2019367994","id":"20191113-001039_505978317","dateCreated":"2021-06-11T14:30:39+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:47065"}],"name":"DATASET/Cloudfin_hql","id":"2G7V4PZDZ","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"psql:shared_process":[],"angular:shared_process":[],"sh:shared_process":[],"jdbc:shared_process":[],"spark2:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}