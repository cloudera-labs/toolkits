{"paragraphs":[{"text":"%md\n# About\n**Lab:** Exploring DataFrames Using the Apache Spark Shell\n**Objective:** You will use the Spark shell to work with DataFrames\n**File locations:** \n```\n/var/data/telco/device.json\n```\n\n**Successful outcome:** You will be able to successfully use the Spark shell to work with DataFrames.\n**Before you begin:** Complete Lab: Working with HDFS\n**Related lessons:**  \n\n---","user":"devuser","dateUpdated":"2020-11-19T03:41:27+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>About</h1>\n<p><strong>Lab:</strong> Exploring DataFrames Using the Apache Spark Shell\n<br  /><strong>Objective:</strong> You will use the Spark shell to work with DataFrames\n<br  /><strong>File locations:</strong></p>\n<pre><code>/var/data/telco/device.json\n</code></pre>\n<p><strong>Successful outcome:</strong> You will be able to successfully use the Spark shell to work with DataFrames.\n<br  /><strong>Before you begin:</strong> Complete Lab: Working with HDFS\n<br  /><strong>Related lessons:</strong></p>\n<hr />\n"}]},"apps":[],"jobName":"paragraph_1603769314735_-522370790","id":"20181126-092644_1457476546","dateCreated":"2020-10-27T03:28:34+0000","dateStarted":"2020-11-19T03:41:27+0000","dateFinished":"2020-11-19T03:41:27+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:31815"},{"text":"%md\n# Setup","user":"devuser","dateUpdated":"2020-10-27T03:28:34+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>Setup</h1>\n"}]},"apps":[],"jobName":"paragraph_1603769314735_-1995109958","id":"20181201-044336_178705192","dateCreated":"2020-10-27T03:28:34+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:31816"},{"title":"","text":"%md\nYou will start by viewing and bookmarking the Spark documentation in your browser.\nThen you will start the Spark shell and read a simple JSON file into a DataFrame.\n\n**Important:** This exercise assumes you are comfortable working with HDFS. You can practice your skills by completing exercise `HDFS/ Basic Commands `.","user":"devuser","dateUpdated":"2020-11-08T20:14:31+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"title":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>You will start by viewing and bookmarking the Spark documentation in your browser.\n<br  />Then you will start the Spark shell and read a simple JSON file into a DataFrame.</p>\n<p><strong>Important:</strong> This exercise assumes you are comfortable working with HDFS. You can practice your skills by completing exercise <code>HDFS/ Basic Commands</code>.</p>\n"}]},"apps":[],"jobName":"paragraph_1603769314735_-703044107","id":"20191112-223734_624990466","dateCreated":"2020-10-27T03:28:34+0000","dateStarted":"2020-11-08T20:14:31+0000","dateFinished":"2020-11-08T20:14:33+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:31817"},{"title":"Copy data file into /tmp","text":"%sh\nrm -r /tmp/telco/device\nmkdir -p /tmp/telco/device\ncp /var/data/telco/device.json /tmp/telco/device/\nls /tmp/telco/device","user":"devuser","dateUpdated":"2020-12-09T23:53:17+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/sh","title":true,"editorHide":false,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"device.json\n"}]},"apps":[],"jobName":"paragraph_1604889098135_-1473384209","id":"20201109-023138_540405983","dateCreated":"2020-11-09T02:31:38+0000","dateStarted":"2020-12-09T23:53:18+0000","dateFinished":"2020-12-09T23:53:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:31818"},{"title":"Put the datafile into hdfs","text":"%sh\nsudo -u hdfs hdfs dfs -rm -r -skipTrash /data/telco/device.json\nsudo -u hdfs hdfs dfs -put /tmp/telco/device/device.json /data/telco/device.json\nsudo -u hdfs hdfs dfs -ls /data/telco","user":"devuser","dateUpdated":"2020-12-09T23:53:21+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/sh","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Deleted /data/telco/device.json\nFound 2 items\ndrwxr-xr-x   - hdfs hdfs          0 2020-11-20 18:19 /data/telco/account\n-rw-r--r--   3 hdfs hdfs       5483 2020-12-09 23:53 /data/telco/device.json\n"}]},"apps":[],"jobName":"paragraph_1604889220855_-2142478482","id":"20201109-023340_1068994441","dateCreated":"2020-11-09T02:33:40+0000","dateStarted":"2020-12-09T23:53:21+0000","dateFinished":"2020-12-09T23:53:27+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:31819"},{"text":"%md\n# Lab\n","user":"devuser","dateUpdated":"2020-10-27T03:28:34+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>Lab</h1>\n"}]},"apps":[],"jobName":"paragraph_1603769314736_1875856190","id":"20181126-093358_358613711","dateCreated":"2020-10-27T03:28:34+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:31820"},{"text":"%md\n### View the Spark Documentation","user":"devuser","dateUpdated":"2020-10-27T03:28:34+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>View the Spark Documentation</h3>\n"}]},"apps":[],"jobName":"paragraph_1603769314736_2054365806","id":"20200427-224625_7331506","dateCreated":"2020-10-27T03:28:34+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:31821"},{"title":"1 - Open the Spark Documentation","text":"%md\nView the Spark documentation in your web browser by visiting [http://spark.apache.org/docs/2.4.7/](http://spark.apache.org/docs/2.4.7/).","user":"devuser","dateUpdated":"2020-11-08T20:18:07+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>View the Spark documentation in your web browser by visiting <a href=\"http://spark.apache.org/docs/2.4.7/\">http://spark.apache.org/docs/2.4.7/</a>.</p>\n"}]},"apps":[],"jobName":"paragraph_1603769314736_-1493077187","id":"20191112-224241_1478925112","dateCreated":"2020-10-27T03:28:34+0000","dateStarted":"2020-11-08T20:18:07+0000","dateFinished":"2020-11-08T20:18:07+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:31822"},{"title":"2 - Review the guide for SQL, DataFrames, and Datasets","text":"%md\nFrom the **Programming Guides** menu, select **SQL, DataFrames, and Datasets**. Briefly review the guide and bookmark the page for later reference.","user":"devuser","dateUpdated":"2020-11-08T20:18:40+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>From the <strong>Programming Guides</strong> menu, select <strong>SQL, DataFrames, and Datasets</strong>. Briefly review the guide and bookmark the page for later reference.</p>\n"}]},"apps":[],"jobName":"paragraph_1603769314736_-2074285958","id":"20200424-001307_182214646","dateCreated":"2020-10-27T03:28:34+0000","dateStarted":"2020-11-08T20:18:40+0000","dateFinished":"2020-11-08T20:18:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:31823"},{"title":"3 - Review the API documentation","text":"%md\nFrom the API Docs menu, select Python. Bookmark the API page for use during class. Later exercises will refer to this documentation","user":"devuser","dateUpdated":"2020-11-08T20:18:43+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"title":true,"results":{"0":{"graph":{"mode":"table","height":59,"optionOpen":false}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>From the API Docs menu, select Python. Bookmark the API page for use during class. Later exercises will refer to this documentation</p>\n"}]},"apps":[],"jobName":"paragraph_1603769314736_-1382410197","id":"20200424-001814_1198814570","dateCreated":"2020-10-27T03:28:34+0000","dateStarted":"2020-11-08T20:18:43+0000","dateFinished":"2020-11-08T20:18:43+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:31824"},{"title":"4 - Review the SQL module for Python","text":"%md\nClick the link for the `pyspark.sql` module. This module contains most of the classes you will be working with in this course. \nAt the top are some of the key classes in the module. View the API for the DataFrame class; these are the operations you will practice using in this exercise.","user":"devuser","dateUpdated":"2020-11-30T01:28:53+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Click the link for the <code>pyspark.sql</code> module. This module contains most of the classes you will be working with in this course.\n<br  />At the top are some of the key classes in the module. View the API for the DataFrame class; these are the operations you will practice using in this exercise.</p>\n"}]},"apps":[],"jobName":"paragraph_1603769314736_-2090639872","id":"20200424-002121_1245830488","dateCreated":"2020-10-27T03:28:34+0000","dateStarted":"2020-11-30T01:28:53+0000","dateFinished":"2020-11-30T01:28:53+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:31825"},{"text":"%md\n### Start the Spark Shell","user":"devuser","dateUpdated":"2020-10-27T03:28:34+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Start the Spark Shell</h3>\n"}]},"apps":[],"jobName":"paragraph_1603769314737_1806189811","id":"20200521-184112_1302709995","dateCreated":"2020-10-27T03:28:34+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:31826"},{"title":"5 - Starting the Spark shell","text":"%md\n**Note:** In this Zeppelin notebook environment a Spark shell is started by the `pyspark` interpreter so you do not need to manually start one. In a normal terminal, however, you can start the Spark shell for Python by using the `pyspark` command.","user":"devuser","dateUpdated":"2020-11-30T01:29:43+0000","config":{"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"title":true,"results":{},"enabled":true,"editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p><strong>Note:</strong> In this Zeppelin notebook environment a Spark shell is started by the <code>pyspark</code> interpreter so you do not need to manually start one. In a normal terminal, however, you can start the Spark shell for Python by using the <code>pyspark</code> command.</p>\n"}]},"apps":[],"jobName":"paragraph_1603769314737_-938871250","id":"20200521-191625_1692551877","dateCreated":"2020-10-27T03:28:34+0000","dateStarted":"2020-11-30T01:29:43+0000","dateFinished":"2020-11-30T01:29:43+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:31827"},{"title":"6 - Confirm that a SparkSession has been instantiated","text":"%pyspark\nspark","user":"devuser","dateUpdated":"2020-12-09T23:53:46+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true,"title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"<pyspark.sql.session.SparkSession object at 0x7f389c4ef110>\n"}]},"apps":[],"jobName":"paragraph_1603769314737_1141811686","id":"20200524-190546_1424495401","dateCreated":"2020-10-27T03:28:34+0000","dateStarted":"2020-12-09T23:53:46+0000","dateFinished":"2020-12-09T23:54:10+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:31828"},{"title":"","text":"%md\nSpark creates a `SparkSession` object for you called `spark`. Make sure the object exists. Use the command spark \nto display information about the spark object such as: `<pyspark.sql.session.SparkSession at` *address*`>`","user":"devuser","dateUpdated":"2020-11-09T02:38:54+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"title":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Spark creates a <code>SparkSession</code> object for you called <code>spark</code>. Make sure the object exists. Use the command spark\n<br  />to display information about the spark object such as: <code>&lt;pyspark.sql.session.SparkSession at</code> <em>address</em><code>&gt;</code></p>\n"}]},"apps":[],"jobName":"paragraph_1603769314737_-2007535580","id":"20200424-004925_515825214","dateCreated":"2020-10-27T03:28:34+0000","dateStarted":"2020-11-09T02:38:54+0000","dateFinished":"2020-11-09T02:38:54+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:31829"},{"title":"7 - View available Spark session methods","text":"%pyspark\nspark.\nspark.debugger","user":"devuser","dateUpdated":"2020-12-09T23:52:30+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1604867143919_996313775","id":"20201108-202543_1415071083","dateCreated":"2020-11-08T20:25:43+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:31830"},{"title":"","text":"%md\nUsing command completion, you can see all the available Spark session methods: type `spark.` (spark followed by a dot) \nand then the `TAB` key.\n\n**Note:** To exit the Python Spark shell, press `Ctrl+D` or type `exit`. However, you won't need to terminate the shell in this environment.","user":"devuser","dateUpdated":"2020-11-09T02:39:21+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"title":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Using command completion, you can see all the available Spark session methods: type <code>spark.</code> (spark followed by a dot)\n<br  />and then the <code>TAB</code> key.</p>\n<p><strong>Note:</strong> To exit the Python Spark shell, press <code>Ctrl+D</code> or type <code>exit</code>. However, you won't need to terminate the shell in this environment.</p>\n"}]},"apps":[],"jobName":"paragraph_1603769314737_-372846061","id":"20200424-010436_1751918744","dateCreated":"2020-10-27T03:28:34+0000","dateStarted":"2020-11-09T02:39:21+0000","dateFinished":"2020-11-09T02:39:21+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:31831"},{"text":"%md\n#### Read and Display a JSON File","user":"devuser","dateUpdated":"2020-11-09T02:39:41+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h4>Read and Display a JSON File</h4>\n"}]},"apps":[],"jobName":"paragraph_1603769314737_66700089","id":"20200427-230624_139432148","dateCreated":"2020-10-27T03:28:34+0000","dateStarted":"2020-11-09T02:39:41+0000","dateFinished":"2020-11-09T02:39:41+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:31832"},{"title":"8 - Review the data file you will be using","text":"%sh\ncat /var/data/telco/device.json","user":"devuser","dateUpdated":"2020-12-09T23:54:19+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/sh","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"{\"devnum\":1,\"release_dt\":\"2008-10-21T00:00:00.000-07:00\",\"make\":\"Sorrento\",\"model\":\"F00L\",\"dev_type\":\"phone\"}\n{\"devnum\":2,\"release_dt\":\"2010-04-19T00:00:00.000-07:00\",\"make\":\"Titanic\",\"model\":\"2100\",\"dev_type\":\"phone\"}\n{\"devnum\":3,\"release_dt\":\"2011-02-18T00:00:00.000-08:00\",\"make\":\"MeeToo\",\"model\":\"3.0\",\"dev_type\":\"phone\"}\n{\"devnum\":4,\"release_dt\":\"2011-09-21T00:00:00.000-07:00\",\"make\":\"MeeToo\",\"model\":\"3.1\",\"dev_type\":\"phone\"}\n{\"devnum\":5,\"release_dt\":\"2008-10-21T00:00:00.000-07:00\",\"make\":\"iFruit\",\"model\":\"1\",\"dev_type\":\"phone\"}\n{\"devnum\":6,\"release_dt\":\"2011-11-02T00:00:00.000-07:00\",\"make\":\"iFruit\",\"model\":\"3\",\"dev_type\":\"phone\"}\n{\"devnum\":7,\"release_dt\":\"2010-05-20T00:00:00.000-07:00\",\"make\":\"iFruit\",\"model\":\"2\",\"dev_type\":\"phone\"}\n{\"devnum\":8,\"release_dt\":\"2013-07-02T00:00:00.000-07:00\",\"make\":\"iFruit\",\"model\":\"5\",\"dev_type\":\"phone\"}\n{\"devnum\":9,\"release_dt\":\"2008-10-21T00:00:00.000-07:00\",\"make\":\"Titanic\",\"model\":\"1000\",\"dev_type\":\"phone\"}\n{\"devnum\":10,\"release_dt\":\"2008-10-21T00:00:00.000-07:00\",\"make\":\"MeeToo\",\"model\":\"1.0\",\"dev_type\":\"phone\"}\n{\"devnum\":11,\"release_dt\":\"2011-02-28T00:00:00.000-08:00\",\"make\":\"Sorrento\",\"model\":\"F21L\",\"dev_type\":\"phone\"}\n{\"devnum\":12,\"release_dt\":\"2012-10-25T00:00:00.000-07:00\",\"make\":\"iFruit\",\"model\":\"4\",\"dev_type\":\"phone\"}\n{\"devnum\":13,\"release_dt\":\"2011-11-21T00:00:00.000-08:00\",\"make\":\"Sorrento\",\"model\":\"F23L\",\"dev_type\":\"phone\"}\n{\"devnum\":14,\"release_dt\":\"2010-05-25T00:00:00.000-07:00\",\"make\":\"Titanic\",\"model\":\"2200\",\"dev_type\":\"phone\"}\n{\"devnum\":15,\"release_dt\":\"2010-06-20T00:00:00.000-07:00\",\"make\":\"Ronin\",\"model\":\"Novelty Note 1\",\"dev_type\":\"phone\"}\n{\"devnum\":16,\"release_dt\":\"2012-07-21T00:00:00.000-07:00\",\"make\":\"Titanic\",\"model\":\"2500\",\"dev_type\":\"phone\"}\n{\"devnum\":17,\"release_dt\":\"2013-04-11T00:00:00.000-07:00\",\"make\":\"Ronin\",\"model\":\"Novelty Note 3\",\"dev_type\":\"phone\"}\n{\"devnum\":18,\"release_dt\":\"2011-10-02T00:00:00.000-07:00\",\"make\":\"Ronin\",\"model\":\"Novelty Note 2\",\"dev_type\":\"phone\"}\n{\"devnum\":19,\"release_dt\":\"2013-07-02T00:00:00.000-07:00\",\"make\":\"Ronin\",\"model\":\"Novelty Note 4\",\"dev_type\":\"phone\"}\n{\"devnum\":20,\"release_dt\":\"2012-07-21T00:00:00.000-07:00\",\"make\":\"iFruit\",\"model\":\"3A\",\"dev_type\":\"phone\"}\n{\"devnum\":21,\"release_dt\":\"2011-02-18T00:00:00.000-08:00\",\"make\":\"Titanic\",\"model\":\"2300\",\"dev_type\":\"phone\"}\n{\"devnum\":22,\"release_dt\":\"2012-03-12T00:00:00.000-07:00\",\"make\":\"Sorrento\",\"model\":\"F24L\",\"dev_type\":\"phone\"}\n{\"devnum\":23,\"release_dt\":\"2010-11-01T00:00:00.000-07:00\",\"make\":\"Sorrento\",\"model\":\"F20L\",\"dev_type\":\"phone\"}\n{\"devnum\":24,\"release_dt\":\"2012-10-21T00:00:00.000-07:00\",\"make\":\"Sorrento\",\"model\":\"F32L\",\"dev_type\":\"phone\"}\n{\"devnum\":25,\"release_dt\":\"2011-10-01T00:00:00.000-07:00\",\"make\":\"Sorrento\",\"model\":\"F22L\",\"dev_type\":\"phone\"}\n{\"devnum\":26,\"release_dt\":\"2012-06-21T00:00:00.000-07:00\",\"make\":\"Sorrento\",\"model\":\"F30L\",\"dev_type\":\"phone\"}\n{\"devnum\":27,\"release_dt\":\"2009-10-25T00:00:00.000-07:00\",\"make\":\"Sorrento\",\"model\":\"F10L\",\"dev_type\":\"phone\"}\n{\"devnum\":28,\"release_dt\":\"2012-09-21T00:00:00.000-07:00\",\"make\":\"Titanic\",\"model\":\"4000\",\"dev_type\":\"phone\"}\n{\"devnum\":29,\"release_dt\":\"2013-11-01T00:00:00.000-07:00\",\"make\":\"Sorrento\",\"model\":\"F41L\",\"dev_type\":\"phone\"}\n{\"devnum\":30,\"release_dt\":\"2013-08-01T00:00:00.000-07:00\",\"make\":\"Titanic\",\"model\":\"DeckChairs\",\"dev_type\":\"phone\"}\n{\"devnum\":31,\"release_dt\":\"2012-08-04T00:00:00.000-07:00\",\"make\":\"MeeToo\",\"model\":\"4.1\",\"dev_type\":\"phone\"}\n{\"devnum\":32,\"release_dt\":\"2012-07-21T00:00:00.000-07:00\",\"make\":\"MeeToo\",\"model\":\"4.0\",\"dev_type\":\"phone\"}\n{\"devnum\":33,\"release_dt\":\"2010-05-15T00:00:00.000-07:00\",\"make\":\"MeeToo\",\"model\":\"2.0\",\"dev_type\":\"phone\"}\n{\"devnum\":34,\"release_dt\":\"2009-12-21T00:00:00.000-08:00\",\"make\":\"Titanic\",\"model\":\"2000\",\"dev_type\":\"phone\"}\n{\"devnum\":35,\"release_dt\":\"2012-09-21T00:00:00.000-07:00\",\"make\":\"MeeToo\",\"model\":\"5.0\",\"dev_type\":\"phone\"}\n{\"devnum\":36,\"release_dt\":\"2013-08-01T00:00:00.000-07:00\",\"make\":\"MeeToo\",\"model\":\"5.1\",\"dev_type\":\"phone\"}\n{\"devnum\":37,\"release_dt\":\"2012-08-04T00:00:00.000-07:00\",\"make\":\"Titanic\",\"model\":\"3000\",\"dev_type\":\"phone\"}\n{\"devnum\":38,\"release_dt\":\"2008-11-25T00:00:00.000-08:00\",\"make\":\"Titanic\",\"model\":\"1100\",\"dev_type\":\"phone\"}\n{\"devnum\":39,\"release_dt\":\"2013-03-11T00:00:00.000-07:00\",\"make\":\"Sorrento\",\"model\":\"F33L\",\"dev_type\":\"phone\"}\n{\"devnum\":40,\"release_dt\":\"2013-02-11T00:00:00.000-08:00\",\"make\":\"iFruit\",\"model\":\"4A\",\"dev_type\":\"phone\"}\n{\"devnum\":41,\"release_dt\":\"2012-07-04T00:00:00.000-07:00\",\"make\":\"Sorrento\",\"model\":\"F31L\",\"dev_type\":\"phone\"}\n{\"devnum\":42,\"release_dt\":\"2013-06-26T00:00:00.000-07:00\",\"make\":\"Sorrento\",\"model\":\"F40L\",\"dev_type\":\"phone\"}\n{\"devnum\":43,\"release_dt\":\"2009-03-11T00:00:00.000-07:00\",\"make\":\"Sorrento\",\"model\":\"F01L\",\"dev_type\":\"phone\"}\n{\"devnum\":44,\"release_dt\":\"2010-04-10T00:00:00.000-07:00\",\"make\":\"Sorrento\",\"model\":\"F11L\",\"dev_type\":\"phone\"}\n{\"devnum\":45,\"release_dt\":\"2011-09-21T00:00:00.000-07:00\",\"make\":\"Titanic\",\"model\":\"2400\",\"dev_type\":\"phone\"}\n{\"devnum\":46,\"release_dt\":\"2013-10-02T00:00:00.000-07:00\",\"make\":\"Ronin\",\"model\":\"S4\",\"dev_type\":\"phone\"}\n{\"devnum\":47,\"release_dt\":\"2010-05-20T00:00:00.000-07:00\",\"make\":\"Ronin\",\"model\":\"S1\",\"dev_type\":\"phone\"}\n{\"devnum\":48,\"release_dt\":\"2013-02-11T00:00:00.000-08:00\",\"make\":\"Ronin\",\"model\":\"S3\",\"dev_type\":\"phone\"}\n{\"devnum\":49,\"release_dt\":\"2012-07-21T00:00:00.000-07:00\",\"make\":\"Ronin\",\"model\":\"S2\",\"dev_type\":\"phone\"}\n{\"devnum\":50,\"release_dt\":\"2013-10-02T00:00:00.000-07:00\",\"make\":\"iFruit\",\"model\":\"5A\",\"dev_type\":\"phone\"}\n"}]},"apps":[],"jobName":"paragraph_1604867239792_1999480890","id":"20201108-202719_205221018","dateCreated":"2020-11-08T20:27:19+0000","dateStarted":"2020-12-09T23:54:19+0000","dateFinished":"2020-12-09T23:54:19+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:31833"},{"title":"","text":"%md\nReview the simple text file you will be using: `/var/data/telco/device.json`. You can view the file by  in \nan editor, or by starting a new terminal window then using the `less` command. (Do not modify the file.) This \nfile contains records for each of the supported devices. For example:\n\n```\n    {\"devnum\":1,\"release_dt\":\"2008-10-21T00:00:00.000-07:00\", \"make\":\"Sorrento\",\"model\":\"F00L\",\"dev_type\":\"phone\"}\n```\n\nNotice the field names and types of values in the first few records.","user":"devuser","dateUpdated":"2020-11-19T03:15:18+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"title":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Review the simple text file you will be using: <code>/var/data/telco/device.json</code>. You can view the file by  in\n<br  />an editor, or by starting a new terminal window then using the <code>less</code> command. (Do not modify the file.) This\n<br  />file contains records for each of the supported devices. For example:</p>\n<pre><code>    {\"devnum\":1,\"release_dt\":\"2008-10-21T00:00:00.000-07:00\", \"make\":\"Sorrento\",\"model\":\"F00L\",\"dev_type\":\"phone\"}\n</code></pre>\n<p>Notice the field names and types of values in the first few records.</p>\n"}]},"apps":[],"jobName":"paragraph_1603769314738_1619226488","id":"20200424-010839_474210908","dateCreated":"2020-10-27T03:28:34+0000","dateStarted":"2020-11-19T03:15:18+0000","dateFinished":"2020-11-19T03:15:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:31834"},{"title":"9 - Upload the data file to HDFS","text":"%sh\nhdfs dfs -rm  -r -skipTrash /user/zeppelin/device.json\nhdfs dfs -put /var/data/telco/device.json /user/zeppelin/\nhdfs dfs -ls /user/zeppelin/","user":"devuser","dateUpdated":"2020-12-09T23:54:27+0000","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"results":{},"enabled":true,"title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Deleted /user/zeppelin/device.json\nFound 14 items\ndrwx------   - zeppelin hdfs          0 2020-11-20 00:00 /user/zeppelin/.Trash\ndrwxrwxrwx   - zeppelin hdfs          0 2020-12-09 23:53 /user/zeppelin/.sparkStaging\ndrwx------   - zeppelin hdfs          0 2020-12-09 00:48 /user/zeppelin/.staging\ndrwxr-xr-x   - zeppelin hdfs          0 2020-12-02 21:15 /user/zeppelin/account_device\ndrwxr-xr-x   - zeppelin hdfs          0 2020-11-30 04:26 /user/zeppelin/account_zip94913\n-rw-r--r--   3 zeppelin hdfs      13149 2020-11-20 19:01 /user/zeppelin/base_station.parquet\ndrwxrwxrwx   - zeppelin hdfs          0 2020-12-09 18:19 /user/zeppelin/conf\n-rw-r--r--   3 zeppelin hdfs       5483 2020-12-09 23:54 /user/zeppelin/device.json\ndrwxr-xr-x   - zeppelin hdfs          0 2020-11-30 04:57 /user/zeppelin/device_parquet\ndrwxr-xr-x   - zeppelin hdfs          0 2020-12-02 02:20 /user/zeppelin/hive\ndrwxrwxrwx   - zeppelin hdfs          0 2020-11-20 04:54 /user/zeppelin/notebook\ndrwxr-xr-x   - zeppelin hdfs          0 2020-11-17 16:13 /user/zeppelin/nyse\ndrwxr-xr-x   - zeppelin hdfs          0 2020-11-19 14:18 /user/zeppelin/test\ndrwxr-xr-x   - zeppelin hdfs          0 2020-11-20 19:12 /user/zeppelin/top_device\n"}]},"apps":[],"jobName":"paragraph_1603769314738_-1521742778","id":"20200430-003404_594738016","dateCreated":"2020-10-27T03:28:34+0000","dateStarted":"2020-12-09T23:54:27+0000","dateFinished":"2020-12-09T23:54:33+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:31835"},{"title":"10 - Create a DataFrame based on the device.json file","text":"%pyspark\ndevDF = spark.read.json(\"/user/zeppelin/device.json\")","user":"devuser","dateUpdated":"2020-12-09T23:54:36+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"results":{},"enabled":true,"title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1603769314738_-289383191","id":"20200424-032459_2069854050","dateCreated":"2020-10-27T03:28:34+0000","dateStarted":"2020-12-09T23:54:36+0000","dateFinished":"2020-12-09T23:54:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:31836"},{"title":"11 - View the schema of the DataFrame","text":"%pyspark\ndevDF.printSchema()","user":"devuser","dateUpdated":"2020-12-09T23:55:26+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true,"title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- dev_type: string (nullable = true)\n |-- devnum: long (nullable = true)\n |-- make: string (nullable = true)\n |-- model: string (nullable = true)\n |-- release_dt: string (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1603769314738_2007160163","id":"20200424-032841_1009875752","dateCreated":"2020-10-27T03:28:34+0000","dateStarted":"2020-12-09T23:55:26+0000","dateFinished":"2020-12-09T23:55:26+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:31837"},{"title":"","text":"%md\nSpark has not yet read the data in the file, but it has scanned the file to infer the schema. View the schema, and note \nthat the column names match the record field names in the JSON file.","user":"devuser","dateUpdated":"2020-11-08T20:33:16+0000","config":{"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"title":false,"results":{},"enabled":true,"editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Spark has not yet read the data in the file, but it has scanned the file to infer the schema. View the schema, and note\n<br  />that the column names match the record field names in the JSON file.</p>\n"}]},"apps":[],"jobName":"paragraph_1603769314738_-1658097954","id":"20200424-032825_299685384","dateCreated":"2020-10-27T03:28:34+0000","dateStarted":"2020-11-08T20:33:16+0000","dateFinished":"2020-11-08T20:33:16+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:31838"},{"title":"12 - Display the data using the show action","text":"%pyspark\ndevDF.show(5)","user":"devuser","dateUpdated":"2020-12-09T23:55:33+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------+------+--------+-----+--------------------+\n|dev_type|devnum|    make|model|          release_dt|\n+--------+------+--------+-----+--------------------+\n|   phone|     1|Sorrento| F00L|2008-10-21T00:00:...|\n|   phone|     2| Titanic| 2100|2010-04-19T00:00:...|\n|   phone|     3|  MeeToo|  3.0|2011-02-18T00:00:...|\n|   phone|     4|  MeeToo|  3.1|2011-09-21T00:00:...|\n|   phone|     5|  iFruit|    1|2008-10-21T00:00:...|\n+--------+------+--------+-----+--------------------+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1603769314739_1466303051","id":"20200424-033005_1468690942","dateCreated":"2020-10-27T03:28:34+0000","dateStarted":"2020-12-09T23:55:33+0000","dateFinished":"2020-12-09T23:55:33+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:31839"},{"title":"","text":"%md\nDisplay the data in the DataFrame using the show function. If you don't pass an argument to `show`, Spark \nwill display the first 20 rows in the DataFrame. For this step, display the first five rows. Note that the data is \ndisplayed in tabular form, using the column names defined in the schema.","user":"devuser","dateUpdated":"2020-11-09T02:42:29+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"title":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Display the data in the DataFrame using the show function. If you don't pass an argument to <code>show</code>, Spark\n<br  />will display the first 20 rows in the DataFrame. For this step, display the first five rows. Note that the data is\n<br  />displayed in tabular form, using the column names defined in the schema.</p>\n"}]},"apps":[],"jobName":"paragraph_1603769314739_984582027","id":"20200424-011941_1495209860","dateCreated":"2020-10-27T03:28:34+0000","dateStarted":"2020-11-09T02:42:29+0000","dateFinished":"2020-11-09T02:42:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:31840"},{"title":"13 - Access the data using the take action","text":"%pyspark\nrows = devDF.take(10)\nfor row in rows: print row","user":"devuser","dateUpdated":"2020-12-09T23:55:41+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true,"title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Row(dev_type=u'phone', devnum=1, make=u'Sorrento', model=u'F00L', release_dt=u'2008-10-21T00:00:00.000-07:00')\nRow(dev_type=u'phone', devnum=2, make=u'Titanic', model=u'2100', release_dt=u'2010-04-19T00:00:00.000-07:00')\nRow(dev_type=u'phone', devnum=3, make=u'MeeToo', model=u'3.0', release_dt=u'2011-02-18T00:00:00.000-08:00')\nRow(dev_type=u'phone', devnum=4, make=u'MeeToo', model=u'3.1', release_dt=u'2011-09-21T00:00:00.000-07:00')\nRow(dev_type=u'phone', devnum=5, make=u'iFruit', model=u'1', release_dt=u'2008-10-21T00:00:00.000-07:00')\nRow(dev_type=u'phone', devnum=6, make=u'iFruit', model=u'3', release_dt=u'2011-11-02T00:00:00.000-07:00')\nRow(dev_type=u'phone', devnum=7, make=u'iFruit', model=u'2', release_dt=u'2010-05-20T00:00:00.000-07:00')\nRow(dev_type=u'phone', devnum=8, make=u'iFruit', model=u'5', release_dt=u'2013-07-02T00:00:00.000-07:00')\nRow(dev_type=u'phone', devnum=9, make=u'Titanic', model=u'1000', release_dt=u'2008-10-21T00:00:00.000-07:00')\nRow(dev_type=u'phone', devnum=10, make=u'MeeToo', model=u'1.0', release_dt=u'2008-10-21T00:00:00.000-07:00')\n"}]},"apps":[],"jobName":"paragraph_1603769314739_2039370022","id":"20200424-033258_489855410","dateCreated":"2020-10-27T03:28:34+0000","dateStarted":"2020-12-09T23:55:41+0000","dateFinished":"2020-12-09T23:55:42+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:31841"},{"title":"","text":"%md\nThe `show` and `printSchema` operations are actions--that is, they return a value from the distributed DataFrame \nto the Spark driver. Both functions display the data in a nicely formatted table. These functions are intended for \ninteractive use in the shell, but do not allow you actually work with the data that is returned. Try using the `take` \naction instead, which returns a list of Row objects. You can display the data by iterating through the collection.","user":"devuser","dateUpdated":"2020-11-09T02:43:23+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"title":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>The <code>show</code> and <code>printSchema</code> operations are actions&ndash;that is, they return a value from the distributed DataFrame\n<br  />to the Spark driver. Both functions display the data in a nicely formatted table. These functions are intended for\n<br  />interactive use in the shell, but do not allow you actually work with the data that is returned. Try using the <code>take</code>\n<br  />action instead, which returns a list of Row objects. You can display the data by iterating through the collection.</p>\n"}]},"apps":[],"jobName":"paragraph_1603769314739_1599128206","id":"20200424-012052_1840734182","dateCreated":"2020-10-27T03:28:34+0000","dateStarted":"2020-11-09T02:43:23+0000","dateFinished":"2020-11-09T02:43:23+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:31842"},{"text":"%md\n#### Query a DataFrame","user":"devuser","dateUpdated":"2020-11-09T02:43:42+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h4>Query a DataFrame</h4>\n"}]},"apps":[],"jobName":"paragraph_1603769314739_-304033423","id":"20200427-231428_316380624","dateCreated":"2020-10-27T03:28:34+0000","dateStarted":"2020-11-09T02:43:42+0000","dateFinished":"2020-11-09T02:43:42+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:31843"},{"title":"14 - Count the number of items in the DataFrame","text":"%pyspark\ndevDF.count()","user":"devuser","dateUpdated":"2020-12-09T23:55:47+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true,"title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"50\n"}]},"apps":[],"jobName":"paragraph_1603769314740_1764206768","id":"20200424-033808_1012166995","dateCreated":"2020-10-27T03:28:34+0000","dateStarted":"2020-12-09T23:55:47+0000","dateFinished":"2020-12-09T23:55:48+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:31844"},{"title":"","text":"%md\nUse the `count` action to return the number of items in the DataFrame.","user":"devuser","dateUpdated":"2020-11-08T20:36:32+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"title":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Use the <code>count</code> action to return the number of items in the DataFrame.</p>\n"}]},"apps":[],"jobName":"paragraph_1603769314739_-1103749448","id":"20200424-012559_815782442","dateCreated":"2020-10-27T03:28:34+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:31845"},{"title":"15 - Use the select transformation to select make and model","text":"%pyspark\nmakeModelDF = devDF.select(\"make\",\"model\")\nmakeModelDF.printSchema()","user":"devuser","dateUpdated":"2020-12-09T23:55:51+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true,"title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- make: string (nullable = true)\n |-- model: string (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1603769314740_1381326366","id":"20200424-033915_1498601100","dateCreated":"2020-10-27T03:28:34+0000","dateStarted":"2020-12-09T23:55:51+0000","dateFinished":"2020-12-09T23:55:51+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:31846"},{"title":"","text":"%md\nDataFrame transformations typically return another DataFrame. Try using a `select` transformation to return a DataFrame \nwith only the `make` and `model` columns, then display its schema. Note that only the selected columns are in the schema.","user":"devuser","dateUpdated":"2020-11-08T20:37:21+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"title":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>DataFrame transformations typically return another DataFrame. Try using a <code>select</code> transformation to return a DataFrame\n<br  />with only the <code>make</code> and <code>model</code> columns, then display its schema. Note that only the selected columns are in the schema.</p>\n"}]},"apps":[],"jobName":"paragraph_1603769314740_-696561521","id":"20200424-012718_762015263","dateCreated":"2020-10-27T03:28:34+0000","dateStarted":"2020-11-08T20:37:21+0000","dateFinished":"2020-11-08T20:37:21+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:31847"},{"title":"16 - Execute the query by calling an action operation","text":"%pyspark\nmakeModelDF.show(10)","user":"devuser","dateUpdated":"2020-12-09T23:55:57+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true,"title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------+-----+\n|    make|model|\n+--------+-----+\n|Sorrento| F00L|\n| Titanic| 2100|\n|  MeeToo|  3.0|\n|  MeeToo|  3.1|\n|  iFruit|    1|\n|  iFruit|    3|\n|  iFruit|    2|\n|  iFruit|    5|\n| Titanic| 1000|\n|  MeeToo|  1.0|\n+--------+-----+\nonly showing top 10 rows\n\n"}]},"apps":[],"jobName":"paragraph_1603769314740_-1418059458","id":"20200424-034057_221622157","dateCreated":"2020-10-27T03:28:34+0000","dateStarted":"2020-12-09T23:55:57+0000","dateFinished":"2020-12-09T23:55:57+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:31848"},{"title":"","text":"%md\nA query is a series of one or more transformations followed by an action. Spark does not execute the query until you call the \naction operation. Display the first 20 lines of the final DataFrame in the series using the `show` action.","user":"devuser","dateUpdated":"2020-11-09T02:44:47+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"title":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>A query is a series of one or more transformations followed by an action. Spark does not execute the query until you call the\n<br  />action operation. Display the first 20 lines of the final DataFrame in the series using the <code>show</code> action.</p>\n"}]},"apps":[],"jobName":"paragraph_1603769314740_-1900652949","id":"20200424-012844_1710957544","dateCreated":"2020-10-27T03:28:34+0000","dateStarted":"2020-11-09T02:44:47+0000","dateFinished":"2020-11-09T02:44:47+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:31849"},{"title":"17 - Access the data using the take action","text":"%pyspark\nrows = makeModelDF.take(5)\nfor row in rows: print row","user":"devuser","dateUpdated":"2020-12-09T23:56:01+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","tableHide":false,"title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Row(make=u'Sorrento', model=u'F00L')\nRow(make=u'Titanic', model=u'2100')\nRow(make=u'MeeToo', model=u'3.0')\nRow(make=u'MeeToo', model=u'3.1')\nRow(make=u'iFruit', model=u'1')\n"}]},"apps":[],"jobName":"paragraph_1605756642386_-592962244","id":"20201119-033042_1298054926","dateCreated":"2020-11-19T03:30:42+0000","dateStarted":"2020-12-09T23:56:01+0000","dateFinished":"2020-12-09T23:56:01+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:31850"},{"title":"18 - Chain multiple transformations in a single command","text":"%pyspark\nmakeDF = devDF.select(\"devnum\",\"make\",\"model\"). \\\nwhere(\"make = 'Ronin'\")\nmakeDF.show()","user":"devuser","dateUpdated":"2020-12-09T23:56:05+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true,"title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------+-----+--------------+\n|devnum| make|         model|\n+------+-----+--------------+\n|    15|Ronin|Novelty Note 1|\n|    17|Ronin|Novelty Note 3|\n|    18|Ronin|Novelty Note 2|\n|    19|Ronin|Novelty Note 4|\n|    46|Ronin|            S4|\n|    47|Ronin|            S1|\n|    48|Ronin|            S3|\n|    49|Ronin|            S2|\n+------+-----+--------------+\n\n"}]},"apps":[],"jobName":"paragraph_1603769314740_22595783","id":"20200424-034245_1247017497","dateCreated":"2020-10-27T03:28:34+0000","dateStarted":"2020-12-09T23:56:05+0000","dateFinished":"2020-12-09T23:56:05+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:31851"},{"title":"","text":"%md\nTransformations in a query can be chained together. Execute a single command to show the results of a query using select \nand where. The resulting DataFrame will contain only the columns `devnum`, `make`, and `model`, and only the rows where \nthe make is `Ronin`.","user":"devuser","dateUpdated":"2020-11-08T20:39:05+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"title":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Transformations in a query can be chained together. Execute a single command to show the results of a query using select\n<br  />and where. The resulting DataFrame will contain only the columns <code>devnum</code>, <code>make</code>, and <code>model</code>, and only the rows where\n<br  />the make is <code>Ronin</code>.</p>\n"}]},"apps":[],"jobName":"paragraph_1603769314740_1423396066","id":"20200424-013213_1983526383","dateCreated":"2020-10-27T03:28:34+0000","dateStarted":"2020-11-08T20:39:05+0000","dateFinished":"2020-11-08T20:39:05+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:31852"},{"text":"%md\n# Reset\nAs long as the student hasn't made any additional changes to the system beyond the lab no action is required to reset the environment.","user":"devuser","dateUpdated":"2020-12-09T23:56:32+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>Reset</h1>\n<p>As long as the student hasn't made any additional changes to the system beyond the lab no action is required to reset the environment.</p>\n"}]},"apps":[],"jobName":"paragraph_1603769314741_-646073936","id":"20181126-133507_1472573213","dateCreated":"2020-10-27T03:28:34+0000","dateStarted":"2020-12-09T23:56:21+0000","dateFinished":"2020-12-09T23:56:21+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:31853"},{"text":"%md\n# Exercise","user":"devuser","dateUpdated":"2020-11-30T01:36:09+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>Exercise</h1>\n"}]},"apps":[],"jobName":"paragraph_1603769314741_1593220316","id":"20181018-125200_1133281582","dateCreated":"2020-10-27T03:28:34+0000","dateStarted":"2020-11-30T01:36:09+0000","dateFinished":"2020-11-30T01:36:09+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:31854"},{"text":"%md\n### View the Spark Documentation","user":"devuser","dateUpdated":"2020-10-27T03:28:34+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>View the Spark Documentation</h3>\n"}]},"apps":[],"jobName":"paragraph_1603769314741_-1498587114","id":"20200428-222440_1560118113","dateCreated":"2020-10-27T03:28:34+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:31855"},{"title":"1 - Open the Spark Documentation","text":"","user":"devuser","dateUpdated":"2020-11-08T20:14:56+0000","config":{"tableHide":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":true,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>View the Spark documentation in your web browser by visiting <a href=\"http://spark/apache.org/docs/2.4.0/\">http://spark.apache.org/docs/2.4.0/</a>.</p>\n"}]},"apps":[],"jobName":"paragraph_1603769314741_-1142012321","id":"20200428-220621_941982366","dateCreated":"2020-10-27T03:28:34+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:31856"},{"title":"2 - Review the guide for SQL, DataFrames, and Datasets","text":"","user":"devuser","dateUpdated":"2020-11-30T01:45:54+0000","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":true,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1603769314741_471382563","id":"20200428-221224_367935","dateCreated":"2020-10-27T03:28:34+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:31857"},{"title":"3 - Review the API documentation","text":"","user":"devuser","dateUpdated":"2020-11-30T01:45:58+0000","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":true,"title":true,"results":{"0":{"graph":{"mode":"table","height":59,"optionOpen":false}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1603769314741_1997068012","id":"20200428-221344_80691113","dateCreated":"2020-10-27T03:28:34+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:31858"},{"title":"4 - Review the SQL module for Python","text":"","user":"devuser","dateUpdated":"2020-11-30T01:45:59+0000","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":true,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1603769314741_-122772238","id":"20200428-221502_793143172","dateCreated":"2020-10-27T03:28:34+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:31859"},{"text":"%md ### Start the Spark Shell","user":"devuser","dateUpdated":"2020-10-27T03:28:34+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Start the Spark Shell</h3>\n"}]},"apps":[],"jobName":"paragraph_1603769314742_-1585140268","id":"20200428-222353_254420897","dateCreated":"2020-10-27T03:28:34+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:31860"},{"title":"5 - Starting the Spark shell","text":"%md\nNo action is required for this step because the Zeppelin notebook uses a built-in interpreter to process Spark commands.\nHow do you start the Spark shell in a normal terminal?","user":"devuser","dateUpdated":"2020-11-30T01:44:36+0000","config":{"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"title":true,"results":{},"enabled":true,"editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>No action is required for this step because the Zeppelin notebook uses a built-in interpreter to process Spark commands.\n<br  />How do you start the Spark shell in a normal terminal?</p>\n"}]},"apps":[],"jobName":"paragraph_1603769314742_-4415402","id":"20200521-192922_1675306584","dateCreated":"2020-10-27T03:28:34+0000","dateStarted":"2020-11-30T01:44:26+0000","dateFinished":"2020-11-30T01:44:26+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:31861"},{"title":"6 - Confirm that a SparkSession has been instantiated","text":"%pyspark\n","user":"devuser","dateUpdated":"2020-11-30T01:44:58+0000","config":{"tableHide":false,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"<pyspark.sql.session.SparkSession object at 0x7f634ad8e1d0>\n"}]},"apps":[],"jobName":"paragraph_1603769314742_240388293","id":"20200428-221636_1873208691","dateCreated":"2020-10-27T03:28:34+0000","dateStarted":"2020-11-20T16:58:19+0000","dateFinished":"2020-11-20T16:58:42+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:31862"},{"title":"7  - View available Spark session methods","text":"%pyspark\n#spark.\n","user":"devuser","dateUpdated":"2020-11-30T01:45:25+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"Traceback (most recent call last):\n  File \"/tmp/zeppelin_pyspark-5122276152426853540.py\", line 364, in <module>\n    code = compile('\\n'.join(stmts), '<stdin>', 'exec', ast.PyCF_ONLY_AST, 1)\n  File \"<stdin>\", line 1\n    spark.\n         ^\nSyntaxError: invalid syntax\n"}]},"apps":[],"jobName":"paragraph_1603769314742_410315736","id":"20200428-223059_378364109","dateCreated":"2020-10-27T03:28:34+0000","dateStarted":"2020-11-09T02:45:31+0000","dateFinished":"2020-11-09T02:45:31+0000","status":"ERROR","progressUpdateIntervalMs":500,"$$hashKey":"object:31863"},{"text":"%md\n#### Read and Display a JSON File","user":"devuser","dateUpdated":"2020-11-09T02:46:06+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h4>Read and Display a JSON File</h4>\n"}]},"apps":[],"jobName":"paragraph_1603769314742_-958907111","id":"20200428-223102_811862238","dateCreated":"2020-10-27T03:28:34+0000","dateStarted":"2020-11-09T02:46:06+0000","dateFinished":"2020-11-09T02:46:06+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:31864"},{"title":"8 - Review the data file you will be using","text":"%sh\n# The file is located at /var/data/telco/device.json","user":"devuser","dateUpdated":"2020-11-30T03:58:59+0000","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"title":true,"results":{},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"{\"devnum\":1,\"release_dt\":\"2008-10-21T00:00:00.000-07:00\",\"make\":\"Sorrento\",\"model\":\"F00L\",\"dev_type\":\"phone\"}\n{\"devnum\":2,\"release_dt\":\"2010-04-19T00:00:00.000-07:00\",\"make\":\"Titanic\",\"model\":\"2100\",\"dev_type\":\"phone\"}\n{\"devnum\":3,\"release_dt\":\"2011-02-18T00:00:00.000-08:00\",\"make\":\"MeeToo\",\"model\":\"3.0\",\"dev_type\":\"phone\"}\n{\"devnum\":4,\"release_dt\":\"2011-09-21T00:00:00.000-07:00\",\"make\":\"MeeToo\",\"model\":\"3.1\",\"dev_type\":\"phone\"}\n{\"devnum\":5,\"release_dt\":\"2008-10-21T00:00:00.000-07:00\",\"make\":\"iFruit\",\"model\":\"1\",\"dev_type\":\"phone\"}\n{\"devnum\":6,\"release_dt\":\"2011-11-02T00:00:00.000-07:00\",\"make\":\"iFruit\",\"model\":\"3\",\"dev_type\":\"phone\"}\n{\"devnum\":7,\"release_dt\":\"2010-05-20T00:00:00.000-07:00\",\"make\":\"iFruit\",\"model\":\"2\",\"dev_type\":\"phone\"}\n{\"devnum\":8,\"release_dt\":\"2013-07-02T00:00:00.000-07:00\",\"make\":\"iFruit\",\"model\":\"5\",\"dev_type\":\"phone\"}\n{\"devnum\":9,\"release_dt\":\"2008-10-21T00:00:00.000-07:00\",\"make\":\"Titanic\",\"model\":\"1000\",\"dev_type\":\"phone\"}\n{\"devnum\":10,\"release_dt\":\"2008-10-21T00:00:00.000-07:00\",\"make\":\"MeeToo\",\"model\":\"1.0\",\"dev_type\":\"phone\"}\n{\"devnum\":11,\"release_dt\":\"2011-02-28T00:00:00.000-08:00\",\"make\":\"Sorrento\",\"model\":\"F21L\",\"dev_type\":\"phone\"}\n{\"devnum\":12,\"release_dt\":\"2012-10-25T00:00:00.000-07:00\",\"make\":\"iFruit\",\"model\":\"4\",\"dev_type\":\"phone\"}\n{\"devnum\":13,\"release_dt\":\"2011-11-21T00:00:00.000-08:00\",\"make\":\"Sorrento\",\"model\":\"F23L\",\"dev_type\":\"phone\"}\n{\"devnum\":14,\"release_dt\":\"2010-05-25T00:00:00.000-07:00\",\"make\":\"Titanic\",\"model\":\"2200\",\"dev_type\":\"phone\"}\n{\"devnum\":15,\"release_dt\":\"2010-06-20T00:00:00.000-07:00\",\"make\":\"Ronin\",\"model\":\"Novelty Note 1\",\"dev_type\":\"phone\"}\n{\"devnum\":16,\"release_dt\":\"2012-07-21T00:00:00.000-07:00\",\"make\":\"Titanic\",\"model\":\"2500\",\"dev_type\":\"phone\"}\n{\"devnum\":17,\"release_dt\":\"2013-04-11T00:00:00.000-07:00\",\"make\":\"Ronin\",\"model\":\"Novelty Note 3\",\"dev_type\":\"phone\"}\n{\"devnum\":18,\"release_dt\":\"2011-10-02T00:00:00.000-07:00\",\"make\":\"Ronin\",\"model\":\"Novelty Note 2\",\"dev_type\":\"phone\"}\n{\"devnum\":19,\"release_dt\":\"2013-07-02T00:00:00.000-07:00\",\"make\":\"Ronin\",\"model\":\"Novelty Note 4\",\"dev_type\":\"phone\"}\n{\"devnum\":20,\"release_dt\":\"2012-07-21T00:00:00.000-07:00\",\"make\":\"iFruit\",\"model\":\"3A\",\"dev_type\":\"phone\"}\n{\"devnum\":21,\"release_dt\":\"2011-02-18T00:00:00.000-08:00\",\"make\":\"Titanic\",\"model\":\"2300\",\"dev_type\":\"phone\"}\n{\"devnum\":22,\"release_dt\":\"2012-03-12T00:00:00.000-07:00\",\"make\":\"Sorrento\",\"model\":\"F24L\",\"dev_type\":\"phone\"}\n{\"devnum\":23,\"release_dt\":\"2010-11-01T00:00:00.000-07:00\",\"make\":\"Sorrento\",\"model\":\"F20L\",\"dev_type\":\"phone\"}\n{\"devnum\":24,\"release_dt\":\"2012-10-21T00:00:00.000-07:00\",\"make\":\"Sorrento\",\"model\":\"F32L\",\"dev_type\":\"phone\"}\n{\"devnum\":25,\"release_dt\":\"2011-10-01T00:00:00.000-07:00\",\"make\":\"Sorrento\",\"model\":\"F22L\",\"dev_type\":\"phone\"}\n{\"devnum\":26,\"release_dt\":\"2012-06-21T00:00:00.000-07:00\",\"make\":\"Sorrento\",\"model\":\"F30L\",\"dev_type\":\"phone\"}\n{\"devnum\":27,\"release_dt\":\"2009-10-25T00:00:00.000-07:00\",\"make\":\"Sorrento\",\"model\":\"F10L\",\"dev_type\":\"phone\"}\n{\"devnum\":28,\"release_dt\":\"2012-09-21T00:00:00.000-07:00\",\"make\":\"Titanic\",\"model\":\"4000\",\"dev_type\":\"phone\"}\n{\"devnum\":29,\"release_dt\":\"2013-11-01T00:00:00.000-07:00\",\"make\":\"Sorrento\",\"model\":\"F41L\",\"dev_type\":\"phone\"}\n{\"devnum\":30,\"release_dt\":\"2013-08-01T00:00:00.000-07:00\",\"make\":\"Titanic\",\"model\":\"DeckChairs\",\"dev_type\":\"phone\"}\n{\"devnum\":31,\"release_dt\":\"2012-08-04T00:00:00.000-07:00\",\"make\":\"MeeToo\",\"model\":\"4.1\",\"dev_type\":\"phone\"}\n{\"devnum\":32,\"release_dt\":\"2012-07-21T00:00:00.000-07:00\",\"make\":\"MeeToo\",\"model\":\"4.0\",\"dev_type\":\"phone\"}\n{\"devnum\":33,\"release_dt\":\"2010-05-15T00:00:00.000-07:00\",\"make\":\"MeeToo\",\"model\":\"2.0\",\"dev_type\":\"phone\"}\n{\"devnum\":34,\"release_dt\":\"2009-12-21T00:00:00.000-08:00\",\"make\":\"Titanic\",\"model\":\"2000\",\"dev_type\":\"phone\"}\n{\"devnum\":35,\"release_dt\":\"2012-09-21T00:00:00.000-07:00\",\"make\":\"MeeToo\",\"model\":\"5.0\",\"dev_type\":\"phone\"}\n{\"devnum\":36,\"release_dt\":\"2013-08-01T00:00:00.000-07:00\",\"make\":\"MeeToo\",\"model\":\"5.1\",\"dev_type\":\"phone\"}\n{\"devnum\":37,\"release_dt\":\"2012-08-04T00:00:00.000-07:00\",\"make\":\"Titanic\",\"model\":\"3000\",\"dev_type\":\"phone\"}\n{\"devnum\":38,\"release_dt\":\"2008-11-25T00:00:00.000-08:00\",\"make\":\"Titanic\",\"model\":\"1100\",\"dev_type\":\"phone\"}\n{\"devnum\":39,\"release_dt\":\"2013-03-11T00:00:00.000-07:00\",\"make\":\"Sorrento\",\"model\":\"F33L\",\"dev_type\":\"phone\"}\n{\"devnum\":40,\"release_dt\":\"2013-02-11T00:00:00.000-08:00\",\"make\":\"iFruit\",\"model\":\"4A\",\"dev_type\":\"phone\"}\n{\"devnum\":41,\"release_dt\":\"2012-07-04T00:00:00.000-07:00\",\"make\":\"Sorrento\",\"model\":\"F31L\",\"dev_type\":\"phone\"}\n{\"devnum\":42,\"release_dt\":\"2013-06-26T00:00:00.000-07:00\",\"make\":\"Sorrento\",\"model\":\"F40L\",\"dev_type\":\"phone\"}\n{\"devnum\":43,\"release_dt\":\"2009-03-11T00:00:00.000-07:00\",\"make\":\"Sorrento\",\"model\":\"F01L\",\"dev_type\":\"phone\"}\n{\"devnum\":44,\"release_dt\":\"2010-04-10T00:00:00.000-07:00\",\"make\":\"Sorrento\",\"model\":\"F11L\",\"dev_type\":\"phone\"}\n{\"devnum\":45,\"release_dt\":\"2011-09-21T00:00:00.000-07:00\",\"make\":\"Titanic\",\"model\":\"2400\",\"dev_type\":\"phone\"}\n{\"devnum\":46,\"release_dt\":\"2013-10-02T00:00:00.000-07:00\",\"make\":\"Ronin\",\"model\":\"S4\",\"dev_type\":\"phone\"}\n{\"devnum\":47,\"release_dt\":\"2010-05-20T00:00:00.000-07:00\",\"make\":\"Ronin\",\"model\":\"S1\",\"dev_type\":\"phone\"}\n{\"devnum\":48,\"release_dt\":\"2013-02-11T00:00:00.000-08:00\",\"make\":\"Ronin\",\"model\":\"S3\",\"dev_type\":\"phone\"}\n{\"devnum\":49,\"release_dt\":\"2012-07-21T00:00:00.000-07:00\",\"make\":\"Ronin\",\"model\":\"S2\",\"dev_type\":\"phone\"}\n{\"devnum\":50,\"release_dt\":\"2013-10-02T00:00:00.000-07:00\",\"make\":\"iFruit\",\"model\":\"5A\",\"dev_type\":\"phone\"}\n"}]},"apps":[],"jobName":"paragraph_1603769314742_1565477935","id":"20200428-223221_352134750","dateCreated":"2020-10-27T03:28:34+0000","dateStarted":"2020-11-30T03:45:56+0000","dateFinished":"2020-11-30T03:45:56+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:31865"},{"title":"9 - Upload the data file to HDFS","text":"%sh\n","user":"devuser","dateUpdated":"2020-11-30T03:58:23+0000","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"rm: `/user/zeppelin/devices.json': No such file or directory\nput: `/user/zeppelin/device.json': File exists\nFound 12 items\ndrwx------   - zeppelin hdfs          0 2020-11-20 00:00 /user/zeppelin/.Trash\ndrwxrwxrwx   - zeppelin hdfs          0 2020-11-20 16:58 /user/zeppelin/.sparkStaging\ndrwx------   - zeppelin hdfs          0 2020-11-12 20:26 /user/zeppelin/.staging\ndrwxr-xr-x   - zeppelin hdfs          0 2020-11-20 04:50 /user/zeppelin/account_device\n-rw-r--r--   3 zeppelin hdfs      13149 2020-11-20 04:36 /user/zeppelin/base_station.parquet\ndrwxrwxrwx   - zeppelin hdfs          0 2020-11-20 14:10 /user/zeppelin/conf\n-rw-r--r--   3 zeppelin hdfs       5483 2020-11-20 04:43 /user/zeppelin/device.json\ndrwxr-xr-x   - zeppelin hdfs          0 2020-11-20 05:03 /user/zeppelin/hive\ndrwxrwxrwx   - zeppelin hdfs          0 2020-11-20 04:54 /user/zeppelin/notebook\ndrwxr-xr-x   - zeppelin hdfs          0 2020-11-17 16:13 /user/zeppelin/nyse\ndrwxr-xr-x   - zeppelin hdfs          0 2020-11-19 14:18 /user/zeppelin/test\ndrwxr-xr-x   - zeppelin hdfs          0 2020-11-20 04:43 /user/zeppelin/top_device\n"}]},"apps":[],"jobName":"paragraph_1603769314742_-1965875800","id":"20200428-223236_87217881","dateCreated":"2020-10-27T03:28:34+0000","dateStarted":"2020-11-20T17:03:58+0000","dateFinished":"2020-11-20T17:04:04+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:31866"},{"title":"10 - Create a DataFrame based on the devices.json file","text":"%pyspark\n","user":"devuser","dateUpdated":"2020-11-30T03:59:23+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1603769314743_1164412575","id":"20200428-223351_1447447811","dateCreated":"2020-10-27T03:28:34+0000","dateStarted":"2020-11-20T17:06:38+0000","dateFinished":"2020-11-20T17:06:42+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:31867"},{"title":"11 - View the schema of the DataFrame","text":"%pyspark\n","user":"devuser","dateUpdated":"2020-11-30T03:59:23+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- dev_type: string (nullable = true)\n |-- devnum: long (nullable = true)\n |-- make: string (nullable = true)\n |-- model: string (nullable = true)\n |-- release_dt: string (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1603769314743_979992704","id":"20200428-223520_174824961","dateCreated":"2020-10-27T03:28:34+0000","dateStarted":"2020-11-20T17:07:08+0000","dateFinished":"2020-11-20T17:07:08+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:31868"},{"title":"12 - Display the data using the show action","text":"%pyspark\n","user":"devuser","dateUpdated":"2020-11-30T04:00:24+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------+------+--------+-----+--------------------+\n|dev_type|devnum|    make|model|          release_dt|\n+--------+------+--------+-----+--------------------+\n|   phone|     1|Sorrento| F00L|2008-10-21T00:00:...|\n|   phone|     2| Titanic| 2100|2010-04-19T00:00:...|\n|   phone|     3|  MeeToo|  3.0|2011-02-18T00:00:...|\n|   phone|     4|  MeeToo|  3.1|2011-09-21T00:00:...|\n|   phone|     5|  iFruit|    1|2008-10-21T00:00:...|\n+--------+------+--------+-----+--------------------+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1603769314743_628841266","id":"20200428-223618_1010809721","dateCreated":"2020-10-27T03:28:34+0000","dateStarted":"2020-11-20T17:08:30+0000","dateFinished":"2020-11-20T17:08:30+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:31869"},{"title":"13 - Access the data using the take action","text":"%pyspark\n","user":"devuser","dateUpdated":"2020-11-30T04:00:24+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Row(dev_type=u'phone', devnum=1, make=u'Sorrento', model=u'F00L', release_dt=u'2008-10-21T00:00:00.000-07:00')\nRow(dev_type=u'phone', devnum=2, make=u'Titanic', model=u'2100', release_dt=u'2010-04-19T00:00:00.000-07:00')\nRow(dev_type=u'phone', devnum=3, make=u'MeeToo', model=u'3.0', release_dt=u'2011-02-18T00:00:00.000-08:00')\nRow(dev_type=u'phone', devnum=4, make=u'MeeToo', model=u'3.1', release_dt=u'2011-09-21T00:00:00.000-07:00')\nRow(dev_type=u'phone', devnum=5, make=u'iFruit', model=u'1', release_dt=u'2008-10-21T00:00:00.000-07:00')\n"}]},"apps":[],"jobName":"paragraph_1603769314743_-517875485","id":"20200428-223654_814080359","dateCreated":"2020-10-27T03:28:34+0000","dateStarted":"2020-11-09T02:47:34+0000","dateFinished":"2020-11-09T02:47:34+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:31870"},{"text":"%md\n#### Query a DataFrame","user":"devuser","dateUpdated":"2020-11-09T02:47:48+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h4>Query a DataFrame</h4>\n"}]},"apps":[],"jobName":"paragraph_1603769314743_310827755","id":"20200428-223737_479505684","dateCreated":"2020-10-27T03:28:34+0000","dateStarted":"2020-11-09T02:47:48+0000","dateFinished":"2020-11-09T02:47:48+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:31871"},{"title":"14 - Count the number of items in the DataFrame","text":"%pyspark\n","user":"devuser","dateUpdated":"2020-11-30T04:00:24+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"50\n"}]},"apps":[],"jobName":"paragraph_1603769314743_2124019590","id":"20200428-223808_1051562813","dateCreated":"2020-10-27T03:28:34+0000","dateStarted":"2020-11-09T02:47:58+0000","dateFinished":"2020-11-09T02:47:58+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:31872"},{"title":"15 - Use the select transformation","text":"%pyspark\n","user":"devuser","dateUpdated":"2020-11-30T04:00:24+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- make: string (nullable = true)\n |-- model: string (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1603769314744_-1438160167","id":"20200428-223831_1189921640","dateCreated":"2020-10-27T03:28:34+0000","dateStarted":"2020-11-09T02:48:04+0000","dateFinished":"2020-11-09T02:48:04+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:31873"},{"title":"16 - Execute the query by calling an action operation","text":"%pyspark\n","user":"devuser","dateUpdated":"2020-11-30T04:00:24+0000","config":{"tableHide":false,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------+--------------+\n|    make|         model|\n+--------+--------------+\n|Sorrento|          F00L|\n| Titanic|          2100|\n|  MeeToo|           3.0|\n|  MeeToo|           3.1|\n|  iFruit|             1|\n|  iFruit|             3|\n|  iFruit|             2|\n|  iFruit|             5|\n| Titanic|          1000|\n|  MeeToo|           1.0|\n|Sorrento|          F21L|\n|  iFruit|             4|\n|Sorrento|          F23L|\n| Titanic|          2200|\n|   Ronin|Novelty Note 1|\n| Titanic|          2500|\n|   Ronin|Novelty Note 3|\n|   Ronin|Novelty Note 2|\n|   Ronin|Novelty Note 4|\n|  iFruit|            3A|\n+--------+--------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1603769314744_2095854157","id":"20200428-223941_404796421","dateCreated":"2020-10-27T03:28:34+0000","dateStarted":"2020-11-09T02:48:10+0000","dateFinished":"2020-11-09T02:48:10+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:31874"},{"title":"17 - Access the data using the take action","text":"%pyspark\n","user":"devuser","dateUpdated":"2020-11-30T04:00:51+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1606708828975_-1410998449","id":"20201130-040028_1745806265","dateCreated":"2020-11-30T04:00:28+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:31875"},{"title":"18 - Chain multiple transformations in a single command","text":"%pyspark\n# Show the 'devnum', 'make', and 'model' for all phones of make 'Ronin'\n","user":"devuser","dateUpdated":"2020-11-30T04:03:34+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------+-----+--------------+\n|devnum| make|         model|\n+------+-----+--------------+\n|    15|Ronin|Novelty Note 1|\n|    17|Ronin|Novelty Note 3|\n|    18|Ronin|Novelty Note 2|\n|    19|Ronin|Novelty Note 4|\n|    46|Ronin|            S4|\n|    47|Ronin|            S1|\n|    48|Ronin|            S3|\n|    49|Ronin|            S2|\n+------+-----+--------------+\n\n"}]},"apps":[],"jobName":"paragraph_1603769314744_139240279","id":"20200428-224456_1487912743","dateCreated":"2020-10-27T03:28:34+0000","dateStarted":"2020-11-09T02:48:18+0000","dateFinished":"2020-11-09T02:48:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:31876"},{"text":"%md\n# Result\n**You have now:** You have now successfully used the Spark shell to work with DataFrames.\n\n---","user":"devuser","dateUpdated":"2020-12-09T23:57:03+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>Result</h1>\n<p><strong>You have now:</strong> You have now successfully used the Spark shell to work with DataFrames.</p>\n<hr />\n"}]},"apps":[],"jobName":"paragraph_1606700233229_248168031","id":"20201130-013713_1480433213","dateCreated":"2020-11-30T01:37:13+0000","dateStarted":"2020-12-09T23:57:03+0000","dateFinished":"2020-12-09T23:57:03+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:31877"},{"text":"%md\nWe hope you've enjoyed this lab. Below are additional resources that you should find useful:\n\n1. [Cloudera Apache Spark Tutorials](http://hortonworks.com/tutorials/#tuts-developers) are your natural next step where you can explore Spark in more depth.\n2. [Cloudera Community Connection (HCC)](https://community.hortonworks.com/spaces/85/data-science.html?type=question) is a great resource for questions and answers on Spark, Data Analytics/Science, and many more Big Data topics.\n3. [Cloudera Apache Spark Docs](https://docs.hortonworks.com/HDPDocuments/HDP3/HDP-3.0.1/spark-overview/content/analyzing_data_with_apache_spark.html) - official Spark documentation.\n4. [Cloudera Apache Zeppelin Docs](https://docs.hortonworks.com/HDPDocuments/HDP3/HDP-3.0.1/zeppelin-overview/content/overview.html) - official Zeppelin documentation.\n","user":"devuser","dateUpdated":"2020-11-09T02:48:43+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>We hope you've enjoyed this lab. Below are additional resources that you should find useful:</p>\n<ol>\n<li><a href=\"http://hortonworks.com/tutorials/#tuts-developers\">Cloudera Apache Spark Tutorials</a> are your natural next step where you can explore Spark in more depth.</li>\n<li><a href=\"https://community.hortonworks.com/spaces/85/data-science.html?type=question\">Cloudera Community Connection (HCC)</a> is a great resource for questions and answers on Spark, Data Analytics/Science, and many more Big Data topics.</li>\n<li><a href=\"https://docs.hortonworks.com/HDPDocuments/HDP3/HDP-3.0.1/spark-overview/content/analyzing_data_with_apache_spark.html\">Cloudera Apache Spark Docs</a> - official Spark documentation.</li>\n<li><a href=\"https://docs.hortonworks.com/HDPDocuments/HDP3/HDP-3.0.1/zeppelin-overview/content/overview.html\">Cloudera Apache Zeppelin Docs</a> - official Zeppelin documentation.</li>\n</ol>\n"}]},"apps":[],"jobName":"paragraph_1603769314744_798481421","id":"20181126-133017_244739700","dateCreated":"2020-10-27T03:28:34+0000","dateStarted":"2020-11-09T02:48:43+0000","dateFinished":"2020-11-09T02:48:43+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:31878"}],"name":"DTRAN/01-DataFrames","id":"2FQKSC9PX","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"sh:shared_process":[],"jdbc:shared_process":[],"spark2:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}