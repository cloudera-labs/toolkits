{"paragraphs":[{"text":" %md\n# About\n**Lab:** Analyzing Data with DataFrame Queries\n**Objective:** Analyze account data and mobile device data using DataFrame queries\n**File locations:**\n- Data files (local): \n    - /var/data/telco/accountdevice\n    - /var/data/telco/base_station.parquet\n- Data files (HDFS): /user/zeppelin/devices.json\n- Hive Tables: telco.accounts\n\n**Successful outcome:** \n**Before you begin:** \n**Related lessons:** \n\n---","user":"devuser","dateUpdated":"2020-11-09T03:34:06+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>About</h1>\n<p><strong>Lab:</strong> Analyzing Data with DataFrame Queries\n<br  /><strong>Objective:</strong> Analyze account data and mobile device data using DataFrame queries\n<br  /><strong>File locations:</strong></p>\n<ul>\n<li>Data files (local):<ul>\n<li>/var/data/telco/accountdevice</li>\n<li>/var/data/telco/base_station.parquet</li>\n</ul>\n</li>\n<li>Data files (HDFS): /user/zeppelin/devices.json</li>\n<li>Hive Tables: telco.accounts</li>\n</ul>\n<p><strong>Successful outcome:</strong>\n<br  /><strong>Before you begin:</strong>\n<br  /><strong>Related lessons:</strong></p>\n<hr />\n"}]},"apps":[],"jobName":"paragraph_1603769333383_-2000413335","id":"20181126-092644_1457476546","dateCreated":"2020-10-27T03:28:53+0000","dateStarted":"2020-11-09T03:34:06+0000","dateFinished":"2020-11-09T03:34:06+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:47195"},{"text":"%md\n# Setup","user":"devuser","dateUpdated":"2020-10-31T04:01:47+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>Setup</h1>\n"}]},"apps":[],"jobName":"paragraph_1603769333383_-1018119675","id":"20181201-044336_178705192","dateCreated":"2020-10-27T03:28:53+0000","dateStarted":"2020-10-31T04:01:47+0000","dateFinished":"2020-10-31T04:01:47+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:47196"},{"title":"Confirm the Hive table exists","text":"%jdbc(hive)\nSELECT * FROM telco.account LIMIT 5;","user":"devuser","dateUpdated":"2020-12-10T00:41:19+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"account.acct_num":"string","account.acct_create_dt":"string","account.acct_close_dt":"string","account.first_name":"string","account.last_name":"string","account.address":"string","account.city":"string","account.state":"string","account.zipcode":"string","account.phone_number":"string","account.created":"string","account.modified":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"account.acct_num\taccount.acct_create_dt\taccount.acct_close_dt\taccount.first_name\taccount.last_name\taccount.address\taccount.city\taccount.state\taccount.zipcode\taccount.phone_number\taccount.created\taccount.modified\n1\t2008-10-23 16:05:05.0\tnull\tDonald\tBecton\t2275 Washburn Street\tOakland\tCA\t94660\t5100032418\t2014-03-18 13:29:47.0\t2014-03-18 13:29:47.0\n2\t2008-11-12 03:00:01.0\tnull\tDonna\tJones\t3885 Elliott Street\tSan Francisco\tCA\t94171\t4150835799\t2014-03-18 13:29:47.0\t2014-03-18 13:29:47.0\n3\t2008-12-21 09:19:50.0\tnull\tDorthy\tChalmers\t4073 Whaley Lane\tSan Mateo\tCA\t94479\t6506877757\t2014-03-18 13:29:47.0\t2014-03-18 13:29:47.0\n4\t2008-11-28 00:08:09.0\tnull\tLeila\tSpencer\t1447 Ross Street\tSan Mateo\tCA\t94444\t6503198619\t2014-03-18 13:29:47.0\t2014-03-18 13:29:47.0\n5\t2008-11-15 23:06:06.0\tnull\tAnita\tLaughlin\t2767 Hill Street\tRichmond\tCA\t94872\t5107754354\t2014-03-18 13:29:47.0\t2014-03-18 13:29:47.0\n"}]},"apps":[],"jobName":"paragraph_1606862056793_1154742339","id":"20201201-223416_2145999538","dateCreated":"2020-12-01T22:34:16+0000","dateStarted":"2020-12-10T00:41:19+0000","dateFinished":"2020-12-10T00:41:19+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:47197"},{"text":"%md\n# Lab\n","user":"devuser","dateUpdated":"2020-10-27T03:28:53+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>Lab</h1>\n"}]},"apps":[],"jobName":"paragraph_1603769333384_-669064363","id":"20181126-093358_358613711","dateCreated":"2020-10-27T03:28:53+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:47198"},{"text":"%md\n### Query DataFrames Using Column Expressions","user":"devuser","dateUpdated":"2020-10-27T03:28:53+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Query DataFrames Using Column Expressions</h3>\n"}]},"apps":[],"jobName":"paragraph_1603769333384_-1371889257","id":"20200428-000319_1418615856","dateCreated":"2020-10-27T03:28:53+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:47199"},{"title":"1 - Review the API documentation for the Spark Column class","text":"%md\n*Optional:* Review the API docs for the `Column` class (which is in the Python module `pyspark.sql`). \nTake note of the various options available.","user":"devuser","dateUpdated":"2020-11-09T03:34:26+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p><em>Optional:</em> Review the API docs for the <code>Column</code> class (which is in the Python module <code>pyspark.sql</code>).\n<br  />Take note of the various options available.</p>\n"}]},"apps":[],"jobName":"paragraph_1603769333384_-697051506","id":"20200424-212509_1688232409","dateCreated":"2020-10-27T03:28:53+0000","dateStarted":"2020-11-09T03:34:26+0000","dateFinished":"2020-11-09T03:34:26+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:47200"},{"title":"2 - Create a new DataFrame called accountsDF","text":"%pyspark\naccountDF = spark.read.table(\"telco.account\")\naccountDF.printSchema()\naccountDF.show()","user":"devuser","dateUpdated":"2020-12-10T00:52:53+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true,"title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- acct_num: integer (nullable = true)\n |-- acct_create_dt: timestamp (nullable = true)\n |-- acct_close_dt: timestamp (nullable = true)\n |-- first_name: string (nullable = true)\n |-- last_name: string (nullable = true)\n |-- address: string (nullable = true)\n |-- city: string (nullable = true)\n |-- state: string (nullable = true)\n |-- zipcode: string (nullable = true)\n |-- phone_number: string (nullable = true)\n |-- created: timestamp (nullable = true)\n |-- modified: timestamp (nullable = true)\n\n+--------+-------------------+-------------------+----------+---------+--------------------+-------------+-----+-------+------------+-------------------+-------------------+\n|acct_num|     acct_create_dt|      acct_close_dt|first_name|last_name|             address|         city|state|zipcode|phone_number|            created|           modified|\n+--------+-------------------+-------------------+----------+---------+--------------------+-------------+-----+-------+------------+-------------------+-------------------+\n|       1|2008-10-23 16:05:05|               null|    Donald|   Becton|2275 Washburn Street|      Oakland|   CA|  94660|  5100032418|2014-03-18 13:29:47|2014-03-18 13:29:47|\n|       2|2008-11-12 03:00:01|               null|     Donna|    Jones| 3885 Elliott Street|San Francisco|   CA|  94171|  4150835799|2014-03-18 13:29:47|2014-03-18 13:29:47|\n|       3|2008-12-21 09:19:50|               null|    Dorthy| Chalmers|    4073 Whaley Lane|    San Mateo|   CA|  94479|  6506877757|2014-03-18 13:29:47|2014-03-18 13:29:47|\n|       4|2008-11-28 00:08:09|               null|     Leila|  Spencer|    1447 Ross Street|    San Mateo|   CA|  94444|  6503198619|2014-03-18 13:29:47|2014-03-18 13:29:47|\n|       5|2008-11-15 23:06:06|               null|     Anita| Laughlin|    2767 Hill Street|     Richmond|   CA|  94872|  5107754354|2014-03-18 13:29:47|2014-03-18 13:29:47|\n|       6|2008-11-20 12:39:33|2014-03-01 07:37:48|    Stevie|   Bridge|   3977 Linda Street|   Sacramento|   CA|  94264|  9162111862|2014-03-18 13:29:47|2014-03-18 13:29:47|\n|       7|2008-12-09 10:32:12|2010-10-16 10:01:51|     David|   Eggers|    2109 Ross Street|      Oakland|   CA|  94508|  5103935529|2014-03-18 13:29:47|2014-03-18 13:29:47|\n|       8|2008-12-15 08:49:38|               null|   Dorothy|  Koopman|   1985 Pratt Avenue|    San Mateo|   CA|  94469|  6502406661|2014-03-18 13:29:47|2014-03-18 13:29:47|\n|       9|2008-11-07 17:58:55|2014-02-14 01:26:52|      Kara|     Kohl|     235 Fort Street|    Palo Alto|   CA|  94312|  6502384894|2014-03-18 13:29:47|2014-03-18 13:29:47|\n|      10|2008-12-02 23:28:01|               null|     Diane|   Nelson|      921 Sardis Sta|      Oakland|   CA|  94577|  5102711264|2014-03-18 13:29:47|2014-03-18 13:29:47|\n|      11|2008-10-27 19:37:29|               null|    Robert|   Fisher|  3710 Heliport Loop|      Oakland|   CA|  94669|  5109726353|2014-03-18 13:29:47|2014-03-18 13:29:47|\n|      12|2008-12-21 23:21:53|               null|    Marcia|  Roberts|   3616 Augusta Park|    Palo Alto|   CA|  94322|  6505209743|2014-03-18 13:29:47|2014-03-18 13:29:47|\n|      13|2008-10-28 14:27:18|               null|    Andres|    Cruse|518 John Daniel D...|San Francisco|   CA|  94143|  4153335996|2014-03-18 13:29:47|2014-03-18 13:29:47|\n|      14|2008-11-29 18:25:38|               null|       Ann|    Moore|4984 Buena Vista ...|   Sacramento|   CA|  94234|  9163145431|2014-03-18 13:29:47|2014-03-18 13:29:47|\n|      15|2008-11-14 09:22:05|               null|    Joseph|   Lackey|  3977 Snowbird Lane|     Berkeley|   CA|  94726|  5108428188|2014-03-18 13:29:47|2014-03-18 13:29:47|\n|      16|2008-12-03 23:48:22|2013-08-01 15:10:07|     Sarah|   Duvall|    4875 Essex Court|San Francisco|   CA|  94056|  4154969289|2014-03-18 13:29:47|2014-03-18 13:29:47|\n|      17|2008-12-27 23:31:40|               null|      Lucy|   Corley|   4834 Brown Street|   Santa Rosa|   CA|  94980|  7076068290|2014-03-18 13:29:47|2014-03-18 13:29:47|\n|      18|2008-11-05 11:16:01|               null|    Roland| Crawford| 2951 Allison Avenue|    Palo Alto|   CA|  94373|  6506033983|2014-03-18 13:29:47|2014-03-18 13:29:47|\n|      19|2008-11-13 23:40:53|2014-02-26 18:44:26|     Leona|     Bray|      364 Romrog Way|   Santa Rosa|   CA|  94913|  7070013038|2014-03-18 13:29:47|2014-03-18 13:29:47|\n|      20|2008-11-02 07:55:25|               null|   Forrest|   Becker|4211 Lightning Po...|   Santa Rosa|   CA|  94902|  7075831640|2014-03-18 13:29:47|2014-03-18 13:29:47|\n+--------+-------------------+-------------------+----------+---------+--------------------+-------------+-----+-------+------------+-------------------+-------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1603769333384_-868820809","id":"20200424-212305_1976759900","dateCreated":"2020-10-27T03:28:53+0000","dateStarted":"2020-12-10T00:52:53+0000","dateFinished":"2020-12-10T00:52:53+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:47201"},{"title":"","text":"%md\nCreate a new DataFrame called `accountDF` based on the Hive `telco.account` table.","user":"devuser","dateUpdated":"2020-11-08T23:44:37+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"title":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Create a new DataFrame called <code>accountDF</code> based on the Hive <code>telco.account</code> table.</p>\n"}]},"apps":[],"jobName":"paragraph_1603769333384_-2087625779","id":"20200424-212208_1992391573","dateCreated":"2020-10-27T03:28:53+0000","dateStarted":"2020-11-08T23:44:37+0000","dateFinished":"2020-11-08T23:44:37+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:47202"},{"title":"3 - Practice using both column reference syntaxes","text":"%pyspark\n# Syntax 1\naccountDF.select(accountDF[\"first_name\"]).show()\n\n# Syntax 2\n#accountDF.select(accountDF.first_name).show()","user":"devuser","dateUpdated":"2020-12-10T00:53:14+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true,"title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------+\n|first_name|\n+----------+\n|    Donald|\n|     Donna|\n|    Dorthy|\n|     Leila|\n|     Anita|\n|    Stevie|\n|     David|\n|   Dorothy|\n|      Kara|\n|     Diane|\n|    Robert|\n|    Marcia|\n|    Andres|\n|       Ann|\n|    Joseph|\n|     Sarah|\n|      Lucy|\n|    Roland|\n|     Leona|\n|   Forrest|\n+----------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1603769333385_-94333060","id":"20200424-212055_1017943498","dateCreated":"2020-10-27T03:28:53+0000","dateStarted":"2020-12-10T00:53:06+0000","dateFinished":"2020-12-10T00:53:06+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:47203"},{"title":"","text":"%md\nTry a simple query with `select`, using both column reference syntaxes.","user":"devuser","dateUpdated":"2020-11-08T23:29:22+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"title":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Try a simple query with <code>select</code>, using both column reference syntaxes.</p>\n"}]},"apps":[],"jobName":"paragraph_1603769333384_-52668290","id":"20200424-212125_1404990380","dateCreated":"2020-10-27T03:28:53+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:47204"},{"title":"4 - Create a column object","text":"%pyspark\nfnCol = accountDF.first_name","user":"devuser","dateUpdated":"2020-12-10T00:53:14+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true,"title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1603769333385_344264129","id":"20200424-211535_1918581691","dateCreated":"2020-10-27T03:28:53+0000","dateStarted":"2020-12-10T00:53:14+0000","dateFinished":"2020-12-10T00:53:14+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:47205"},{"title":"","text":"%md\nTo explore column expressions, create a column object to work with, based on the `first_name` \ncolumn in the `accountDF` DataFrame.","user":"devuser","dateUpdated":"2020-11-09T03:35:15+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"title":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>To explore column expressions, create a column object to work with, based on the <code>first_name</code>\n<br  />column in the <code>accountDF</code> DataFrame.</p>\n"}]},"apps":[],"jobName":"paragraph_1603769333385_1731687042","id":"20200424-211342_2102011750","dateCreated":"2020-10-27T03:28:53+0000","dateStarted":"2020-11-09T03:35:15+0000","dateFinished":"2020-11-09T03:35:15+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:47206"},{"title":"5 - View available methods and attributes of the Column class","text":"%pyspark\n#fnCol.","user":"devuser","dateUpdated":"2020-11-08T23:30:37+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true,"title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1603769333385_1427759529","id":"20200428-024431_1568395373","dateCreated":"2020-10-27T03:28:53+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:47207"},{"title":"","text":"%md\nNote that the object type is `Column`. To see available methods and attributes, use tab \ncompletion--that is, enter `fnCol`. followed by `TAB`.","user":"devuser","dateUpdated":"2020-11-09T03:35:27+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"title":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Note that the object type is <code>Column</code>. To see available methods and attributes, use tab\n<br  />completion&ndash;that is, enter <code>fnCol</code>. followed by <code>TAB</code>.</p>\n"}]},"apps":[],"jobName":"paragraph_1603769333385_-1457779171","id":"20200424-211341_2090534806","dateCreated":"2020-10-27T03:28:53+0000","dateStarted":"2020-11-09T03:35:27+0000","dateFinished":"2020-11-09T03:35:27+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:47208"},{"title":"6 - Use a column expression to create a new column object","text":"%pyspark\nlucyCol = (fnCol == \"Lucy\")","user":"devuser","dateUpdated":"2020-12-10T00:53:19+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true,"title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1603769333386_720529096","id":"20200424-211140_1331293844","dateCreated":"2020-10-27T03:28:53+0000","dateStarted":"2020-12-10T00:53:19+0000","dateFinished":"2020-12-10T00:53:19+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:47209"},{"title":"","text":"%md\nNew `Column` objects are created when you perform operations on existing columns. Create a \nnew `Column` object based on a column expression that identifies users whose first name is Lucy using \nthe equality operator on the `fnCol` object you created above.","user":"devuser","dateUpdated":"2020-11-09T03:36:04+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"title":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>New <code>Column</code> objects are created when you perform operations on existing columns. Create a\n<br  />new <code>Column</code> object based on a column expression that identifies users whose first name is Lucy using\n<br  />the equality operator on the <code>fnCol</code> object you created above.</p>\n"}]},"apps":[],"jobName":"paragraph_1603769333385_1040779265","id":"20200424-211259_1439234654","dateCreated":"2020-10-27T03:28:53+0000","dateStarted":"2020-11-09T03:36:04+0000","dateFinished":"2020-11-09T03:36:04+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:47210"},{"title":"7 - Use the lucyCol column expression in a select statement","text":"%pyspark\naccountDF. \\\nselect(accountDF.first_name, \\\naccountDF.last_name,lucyCol).show()","user":"devuser","dateUpdated":"2020-12-10T00:53:23+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true,"title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------+---------+-------------------+\n|first_name|last_name|(first_name = Lucy)|\n+----------+---------+-------------------+\n|    Donald|   Becton|              false|\n|     Donna|    Jones|              false|\n|    Dorthy| Chalmers|              false|\n|     Leila|  Spencer|              false|\n|     Anita| Laughlin|              false|\n|    Stevie|   Bridge|              false|\n|     David|   Eggers|              false|\n|   Dorothy|  Koopman|              false|\n|      Kara|     Kohl|              false|\n|     Diane|   Nelson|              false|\n|    Robert|   Fisher|              false|\n|    Marcia|  Roberts|              false|\n|    Andres|    Cruse|              false|\n|       Ann|    Moore|              false|\n|    Joseph|   Lackey|              false|\n|     Sarah|   Duvall|              false|\n|      Lucy|   Corley|               true|\n|    Roland| Crawford|              false|\n|     Leona|     Bray|              false|\n|   Forrest|   Becker|              false|\n+----------+---------+-------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1603769333386_519239893","id":"20200424-210944_441417371","dateCreated":"2020-10-27T03:28:53+0000","dateStarted":"2020-12-10T00:53:23+0000","dateFinished":"2020-12-10T00:53:23+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:47211"},{"title":"","text":"%md\nUse the `lucyCol` column expression in a `select` statement. Because `lucyCol` is based on a boolean expression, \nthe column values will be `true` or `false` depending on the value of the `first_name` column. Confirm that users \nnamed Lucy are identified with the value `true`.","user":"devuser","dateUpdated":"2020-11-08T23:33:00+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"title":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Use the <code>lucyCol</code> column expression in a <code>select</code> statement. Because <code>lucyCol</code> is based on a boolean expression,\n<br  />the column values will be <code>true</code> or <code>false</code> depending on the value of the <code>first_name</code> column. Confirm that users\n<br  />named Lucy are identified with the value <code>true</code>.</p>\n"}]},"apps":[],"jobName":"paragraph_1603769333386_-1448283602","id":"20200424-211010_1767236609","dateCreated":"2020-10-27T03:28:53+0000","dateStarted":"2020-11-08T23:33:00+0000","dateFinished":"2020-11-08T23:33:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:47212"},{"title":"8 - Use the where operation","text":"%pyspark\naccountDF.where(lucyCol).show(5)","user":"devuser","dateUpdated":"2020-12-10T00:53:27+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true,"title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------+-------------------+-------------------+----------+---------+--------------------+----------+-----+-------+------------+-------------------+-------------------+\n|acct_num|     acct_create_dt|      acct_close_dt|first_name|last_name|             address|      city|state|zipcode|phone_number|            created|           modified|\n+--------+-------------------+-------------------+----------+---------+--------------------+----------+-----+-------+------------+-------------------+-------------------+\n|      17|2008-12-27 23:31:40|               null|      Lucy|   Corley|   4834 Brown Street|Santa Rosa|   CA|  94980|  7076068290|2014-03-18 13:29:47|2014-03-18 13:29:47|\n|    1762|2009-03-19 23:43:00|               null|      Lucy|    Davis|2195 Riverside Drive|Sacramento|   CA|  95620|  9169959437|2014-03-18 13:29:50|2014-03-18 13:29:50|\n|    6551|2010-09-04 19:28:22|2014-02-14 19:19:16|      Lucy|  Casiano|2821 Wood Duck Drive|  Alhambra|   CA|  91810|  6261078791|2014-03-18 13:29:59|2014-03-18 13:29:59|\n|    6978|2010-09-22 07:13:16|               null|      Lucy|      Lee|4781 Shadowmar Drive|   Salinas|   CA|  93961|  8315367970|2014-03-18 13:30:00|2014-03-18 13:30:00|\n|    7107|2010-02-10 00:23:38|2014-01-23 22:55:06|      Lucy| Hastings|   4759 Gateway Road|    Fresno|   CA|  93692|  5595001084|2014-03-18 13:30:00|2014-03-18 13:30:00|\n+--------+-------------------+-------------------+----------+---------+--------------------+----------+-----+-------+------------+-------------------+-------------------+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1603769333386_2137754575","id":"20200424-210819_197116283","dateCreated":"2020-10-27T03:28:53+0000","dateStarted":"2020-12-10T00:53:27+0000","dateFinished":"2020-12-10T00:53:27+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:47213"},{"title":"","text":"%md\nThe `where` operation requires a boolean-based column expression. Use the `lucyCol` column \nexpression in a where transformation and view the data in the resulting DataFrame. Confirm that \nonly users named Lucy are in the data.","user":"devuser","dateUpdated":"2020-11-09T03:36:36+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"title":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>The <code>where</code> operation requires a boolean-based column expression. Use the <code>lucyCol</code> column\n<br  />expression in a where transformation and view the data in the resulting DataFrame. Confirm that\n<br  />only users named Lucy are in the data.</p>\n"}]},"apps":[],"jobName":"paragraph_1603769333386_-1045730596","id":"20200424-210842_326461687","dateCreated":"2020-10-27T03:28:53+0000","dateStarted":"2020-11-09T03:36:36+0000","dateFinished":"2020-11-09T03:36:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:47214"},{"title":"9 - Try a query without assigning the result to a variable","text":"%pyspark\naccountDF.where(fnCol == \"Lucy\").show(5)","user":"devuser","dateUpdated":"2020-12-10T00:53:31+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true,"title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------+-------------------+-------------------+----------+---------+--------------------+----------+-----+-------+------------+-------------------+-------------------+\n|acct_num|     acct_create_dt|      acct_close_dt|first_name|last_name|             address|      city|state|zipcode|phone_number|            created|           modified|\n+--------+-------------------+-------------------+----------+---------+--------------------+----------+-----+-------+------------+-------------------+-------------------+\n|      17|2008-12-27 23:31:40|               null|      Lucy|   Corley|   4834 Brown Street|Santa Rosa|   CA|  94980|  7076068290|2014-03-18 13:29:47|2014-03-18 13:29:47|\n|    1762|2009-03-19 23:43:00|               null|      Lucy|    Davis|2195 Riverside Drive|Sacramento|   CA|  95620|  9169959437|2014-03-18 13:29:50|2014-03-18 13:29:50|\n|    6551|2010-09-04 19:28:22|2014-02-14 19:19:16|      Lucy|  Casiano|2821 Wood Duck Drive|  Alhambra|   CA|  91810|  6261078791|2014-03-18 13:29:59|2014-03-18 13:29:59|\n|    6978|2010-09-22 07:13:16|               null|      Lucy|      Lee|4781 Shadowmar Drive|   Salinas|   CA|  93961|  8315367970|2014-03-18 13:30:00|2014-03-18 13:30:00|\n|    7107|2010-02-10 00:23:38|2014-01-23 22:55:06|      Lucy| Hastings|   4759 Gateway Road|    Fresno|   CA|  93692|  5595001084|2014-03-18 13:30:00|2014-03-18 13:30:00|\n+--------+-------------------+-------------------+----------+---------+--------------------+----------+-----+-------+------------+-------------------+-------------------+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1603769333387_1682916131","id":"20200424-210713_2131753087","dateCreated":"2020-10-27T03:28:53+0000","dateStarted":"2020-12-10T00:53:31+0000","dateFinished":"2020-12-10T00:53:32+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:47215"},{"title":"","text":"%md\nColumn expressions do not need to be assigned to a variable. Try the same query without using \nthe `lucyCol` variable.","user":"devuser","dateUpdated":"2020-11-09T03:36:53+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"title":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Column expressions do not need to be assigned to a variable. Try the same query without using\n<br  />the <code>lucyCol</code> variable.</p>\n"}]},"apps":[],"jobName":"paragraph_1603769333386_-532098936","id":"20200424-210740_808874803","dateCreated":"2020-10-27T03:28:53+0000","dateStarted":"2020-11-09T03:36:53+0000","dateFinished":"2020-11-09T03:36:53+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:47216"},{"title":"10 - Column expressions can be used wherever a column could be used","text":"%pyspark\naccountDF. \\\nselect(\"city\", \"state\", \\\naccountDF.phone_number.substr(1,3)). \\\nshow(5)","user":"devuser","dateUpdated":"2020-12-10T00:53:35+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true,"title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------+-----+-----------------------------+\n|         city|state|substring(phone_number, 1, 3)|\n+-------------+-----+-----------------------------+\n|      Oakland|   CA|                          510|\n|San Francisco|   CA|                          415|\n|    San Mateo|   CA|                          650|\n|    San Mateo|   CA|                          650|\n|     Richmond|   CA|                          510|\n+-------------+-----+-----------------------------+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1603769333387_1560121202","id":"20200424-210506_2050598948","dateCreated":"2020-10-27T03:28:53+0000","dateStarted":"2020-12-10T00:53:35+0000","dateFinished":"2020-12-10T00:53:35+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:47217"},{"title":"","text":"%md\nColumn expressions are not limited to where operations like those above. They can be used in any transformation \nfor which a simple column could be used, such as a `select`. Try selecting the `city` and `state` columns, and the \nfirst three characters of the `phone_number` column (in the U.S., the first three digits of a phone number are known \nas the area code). Use the `substr` operator on the `phone_number` column to extract the area code.","user":"devuser","dateUpdated":"2020-11-08T23:35:22+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"title":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Column expressions are not limited to where operations like those above. They can be used in any transformation\n<br  />for which a simple column could be used, such as a <code>select</code>. Try selecting the <code>city</code> and <code>state</code> columns, and the\n<br  />first three characters of the <code>phone_number</code> column (in the U.S., the first three digits of a phone number are known\n<br  />as the area code). Use the <code>substr</code> operator on the <code>phone_number</code> column to extract the area code.</p>\n"}]},"apps":[],"jobName":"paragraph_1603769333387_1744435959","id":"20200424-210538_1418669039","dateCreated":"2020-10-27T03:28:53+0000","dateStarted":"2020-11-08T23:35:22+0000","dateFinished":"2020-11-08T23:35:22+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:47218"},{"title":"11 - Use the alias operator to rename a column","text":"%pyspark\naccountDF. \\\nselect(\"city\", \"state\", \\\naccountDF.phone_number. \\\nsubstr(1,3).alias(\"area_code\")). \\\nshow(5)","user":"devuser","dateUpdated":"2020-12-10T00:53:39+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true,"title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------+-----+---------+\n|         city|state|area_code|\n+-------------+-----+---------+\n|      Oakland|   CA|      510|\n|San Francisco|   CA|      415|\n|    San Mateo|   CA|      650|\n|    San Mateo|   CA|      650|\n|     Richmond|   CA|      510|\n+-------------+-----+---------+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1603769333387_1604556303","id":"20200424-205156_136439727","dateCreated":"2020-10-27T03:28:53+0000","dateStarted":"2020-12-10T00:53:39+0000","dateFinished":"2020-12-10T00:53:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:47219"},{"title":"","text":"%md\nNotice that in the last step, the values returned by the query were correct, but the column name was \n`substring(phone_number, 1, 3)`, which is long and hard to work with. Repeat the same query, using the alias \noperator to rename that column as `area_code`.","user":"devuser","dateUpdated":"2020-11-08T23:36:01+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"title":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Notice that in the last step, the values returned by the query were correct, but the column name was\n<br  /><code>substring(phone_number, 1, 3)</code>, which is long and hard to work with. Repeat the same query, using the alias\n<br  />operator to rename that column as <code>area_code</code>.</p>\n"}]},"apps":[],"jobName":"paragraph_1603769333387_803749134","id":"20200424-205240_2041304491","dateCreated":"2020-10-27T03:28:53+0000","dateStarted":"2020-11-08T23:36:01+0000","dateFinished":"2020-11-08T23:36:01+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:47220"},{"title":"12 - Practice using transformations","text":"%pyspark\naccountDF.where(accountDF.first_name.substr(1,2) == accountDF.last_name.substr(1,2)).select(\"first_name\",\"last_name\").show(5)","user":"devuser","dateUpdated":"2020-12-10T00:53:44+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true,"title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------+---------+\n|first_name|last_name|\n+----------+---------+\n|   Johnnie|    Jones|\n|    Robert|   Roller|\n|   Michael|  Minnick|\n| Rosemarie|Robertson|\n|     Keith|   Kemble|\n+----------+---------+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1603769333387_1621443709","id":"20200424-205103_2140068119","dateCreated":"2020-10-27T03:28:53+0000","dateStarted":"2020-12-10T00:53:44+0000","dateFinished":"2020-12-10T00:53:44+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:47221"},{"title":" ","text":"%md\nPerform a query that results in a DataFrame with just `first_name` and `last_name` columns, and only includes users \nwhose first and last names both begin with the same two letters. (For example, the user Roberta Roget would be included, \nbecause both her first and last names begin with\"Ro\".)","user":"devuser","dateUpdated":"2020-11-08T23:36:35+0000","config":{"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"title":false,"results":{},"enabled":true,"editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Perform a query that results in a DataFrame with just <code>first_name</code> and <code>last_name</code> columns, and only includes users\n<br  />whose first and last names both begin with the same two letters. (For example, the user Roberta Roget would be included,\n<br  />because both her first and last names begin with\"Ro&rdquo;.)</p>\n"}]},"apps":[],"jobName":"paragraph_1603769333387_1780307775","id":"20200424-205004_811241468","dateCreated":"2020-10-27T03:28:53+0000","dateStarted":"2020-11-08T23:36:35+0000","dateFinished":"2020-11-08T23:36:35+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:47222"},{"text":"%md\n#### Group and Count Data by Name","user":"devuser","dateUpdated":"2020-11-09T03:37:47+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h4>Group and Count Data by Name</h4>\n"}]},"apps":[],"jobName":"paragraph_1603769333388_1350674343","id":"20200428-021130_74434274","dateCreated":"2020-10-27T03:28:53+0000","dateStarted":"2020-11-09T03:37:47+0000","dateFinished":"2020-11-09T03:37:47+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:47223"},{"title":"13 - Query the DataFrame using groupBy with the count aggregation transformation","text":"%pyspark\naccountDF.groupBy(\"last_name\").count().show(5)","user":"devuser","dateUpdated":"2020-12-10T00:53:49+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true,"title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---------+-----+\n|last_name|count|\n+---------+-----+\n| Francois|    6|\n|   Bohner|    3|\n|    Tyler|   50|\n|   Maddox|   60|\n| Abramson|    3|\n+---------+-----+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1603769333388_326026412","id":"20200424-204814_258444822","dateCreated":"2020-10-27T03:28:53+0000","dateStarted":"2020-12-10T00:53:49+0000","dateFinished":"2020-12-10T00:53:49+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:47224"},{"title":" ","text":"%md\nQuery the `accountDF` DataFrame using `groupBy` with count to find out the total number people \nsharing each last name. \n(Note that the count aggregation transformation returns a DataFrame, unlike the `count` DataFrame action, \nwhich returns a single value to the driver.)","user":"devuser","dateUpdated":"2020-11-09T03:38:15+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"title":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Query the <code>accountDF</code> DataFrame using <code>groupBy</code> with count to find out the total number people\n<br  />sharing each last name.\n<br  />(Note that the count aggregation transformation returns a DataFrame, unlike the <code>count</code> DataFrame action,\n<br  />which returns a single value to the driver.)</p>\n"}]},"apps":[],"jobName":"paragraph_1603769333388_1610138813","id":"20200424-204838_1865108814","dateCreated":"2020-10-27T03:28:53+0000","dateStarted":"2020-11-09T03:38:15+0000","dateFinished":"2020-11-09T03:38:15+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:47225"},{"title":"14 - Use groupBy on multiple columns","text":"%pyspark\naccountDF.groupBy(\"last_name\",\"first_name\").count().show(5)","user":"devuser","dateUpdated":"2020-12-10T00:53:56+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true,"title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---------+----------+-----+\n|last_name|first_name|count|\n+---------+----------+-----+\n| Williams|   Lillian|    6|\n|Robertson| Rosemarie|    3|\n|     Bell|    Joanna|    3|\n|    Spano|    Amanda|    3|\n|    Beane|     Marie|    3|\n+---------+----------+-----+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1603769333388_-1249822828","id":"20200424-204702_186191411","dateCreated":"2020-10-27T03:28:53+0000","dateStarted":"2020-12-10T00:53:56+0000","dateFinished":"2020-12-10T00:53:57+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:47226"},{"title":"","text":"%md\nYou can also group by multiple columns. Query `accountDF` again, this time counting the number of people who share\nthe same last and first name.","user":"devuser","dateUpdated":"2020-11-08T23:46:57+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"title":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>You can also group by multiple columns. Query <code>accountDF</code> again, this time counting the number of people who share\n<br  />the same last and first name.</p>\n"}]},"apps":[],"jobName":"paragraph_1603769333388_-1154298665","id":"20200424-204728_710380328","dateCreated":"2020-10-27T03:28:53+0000","dateStarted":"2020-11-08T23:46:57+0000","dateFinished":"2020-11-08T23:46:57+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:47227"},{"text":"%md\n#### Join Account Data with Cellular Towers by Zip Code","user":"devuser","dateUpdated":"2020-11-08T23:38:59+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h4>Join Account Data with Cellular Towers by Zip Code</h4>\n"}]},"apps":[],"jobName":"paragraph_1603769333389_-1311205967","id":"20200428-023308_165587244","dateCreated":"2020-10-27T03:28:53+0000","dateStarted":"2020-11-08T23:38:59+0000","dateFinished":"2020-11-08T23:38:59+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:47228"},{"title":"15 - Review the base_stations.parquet file","text":"%md\nIn this section, you will join the accounts data that you have been using with data about cell tower base station locations, \nwhich is in the `base_station.parquet` file. Start by reviewing the schema and a few records of the data. Use the \n`parquet-tools` command in a separate terminal window (not the one running the Spark shell).\n\n    $ parquet-tools schema /var/data/telco/base_station.parquet\n    $ parquet-tools head /var/data/telco/base_station.parquet","user":"devuser","dateUpdated":"2020-11-09T03:39:05+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>In this section, you will join the accounts data that you have been using with data about cell tower base station locations,\n<br  />which is in the <code>base_station.parquet</code> file. Start by reviewing the schema and a few records of the data. Use the\n<br  /><code>parquet-tools</code> command in a separate terminal window (not the one running the Spark shell).</p>\n<pre><code>$ parquet-tools schema /var/data/telco/base_station.parquet\n$ parquet-tools head /var/data/telco/base_station.parquet\n</code></pre>\n"}]},"apps":[],"jobName":"paragraph_1603769333389_-1619520518","id":"20200424-204523_175092546","dateCreated":"2020-10-27T03:28:53+0000","dateStarted":"2020-11-09T03:39:05+0000","dateFinished":"2020-11-09T03:39:05+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:47229"},{"title":"16 - Upload the data file to HDFS","text":"%sh\nhdfs dfs -rm -r -skipTrash /user/zeppelin/base_station.parquet\nhdfs dfs -put /var/data/telco/base_station.parquet /user/zeppelin\nhdfs dfs -ls /user/zeppelin","user":"devuser","dateUpdated":"2020-12-10T00:54:04+0000","config":{"tableHide":false,"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Deleted /user/zeppelin/base_station.parquet\nFound 14 items\ndrwx------   - zeppelin hdfs          0 2020-11-20 00:00 /user/zeppelin/.Trash\ndrwxrwxrwx   - zeppelin hdfs          0 2020-12-09 23:53 /user/zeppelin/.sparkStaging\ndrwx------   - zeppelin hdfs          0 2020-12-09 00:48 /user/zeppelin/.staging\ndrwxr-xr-x   - zeppelin hdfs          0 2020-12-10 00:49 /user/zeppelin/account_device\ndrwxr-xr-x   - zeppelin hdfs          0 2020-12-10 00:24 /user/zeppelin/account_zip94913\n-rw-r--r--   3 zeppelin hdfs      13149 2020-12-10 00:54 /user/zeppelin/base_station.parquet\ndrwxrwxrwx   - zeppelin hdfs          0 2020-12-09 18:19 /user/zeppelin/conf\n-rw-r--r--   3 zeppelin hdfs       5483 2020-12-10 00:49 /user/zeppelin/device.json\ndrwxr-xr-x   - zeppelin hdfs          0 2020-12-10 00:25 /user/zeppelin/device_parquet\ndrwxr-xr-x   - zeppelin hdfs          0 2020-12-02 02:20 /user/zeppelin/hive\ndrwxrwxrwx   - zeppelin hdfs          0 2020-11-20 04:54 /user/zeppelin/notebook\ndrwxr-xr-x   - zeppelin hdfs          0 2020-11-17 16:13 /user/zeppelin/nyse\ndrwxr-xr-x   - zeppelin hdfs          0 2020-11-19 14:18 /user/zeppelin/test\ndrwxr-xr-x   - zeppelin hdfs          0 2020-12-10 00:49 /user/zeppelin/top_device\n"}]},"apps":[],"jobName":"paragraph_1603769333389_-2059470732","id":"20200424-204412_257827029","dateCreated":"2020-10-27T03:28:53+0000","dateStarted":"2020-12-10T00:54:03+0000","dateFinished":"2020-12-10T00:54:09+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:47230"},{"title":"17 - Create a new DataFrame using the base stations data","text":"%pyspark\nbaseDF = spark.read.parquet(\"/user/zeppelin/base_station.parquet\")","user":"devuser","dateUpdated":"2020-12-10T00:54:11+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true,"title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1603769333389_50698770","id":"20200428-024608_162427147","dateCreated":"2020-10-27T03:28:53+0000","dateStarted":"2020-12-10T00:54:11+0000","dateFinished":"2020-12-10T00:54:11+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:47231"},{"title":"","text":"%md\nIn your Spark shell, create a new DataFrame called `baseDF` using the base stations data. Review the `baseDF` \nschema and data to ensure it matches the data in the Parquet file.","user":"devuser","dateUpdated":"2020-11-08T23:40:18+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"title":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>In your Spark shell, create a new DataFrame called <code>baseDF</code> using the base stations data. Review the <code>baseDF</code>\n<br  />schema and data to ensure it matches the data in the Parquet file.</p>\n"}]},"apps":[],"jobName":"paragraph_1603769333389_-1495650151","id":"20200424-204225_363142431","dateCreated":"2020-10-27T03:28:53+0000","dateStarted":"2020-11-08T23:40:18+0000","dateFinished":"2020-11-08T23:40:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:47232"},{"title":"18 - Perform a join on baseDF and accountsDF","text":"%pyspark\naccountDF. \\\nselect(\"acct_num\",\"first_name\",\"last_name\",\"zipcode\"). \\\njoin(baseDF, baseDF.zip == accountDF.zipcode). \\\nshow()","user":"devuser","dateUpdated":"2020-12-10T00:54:16+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true,"title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------+----------+-----------+-------+---+-----+-------------+-----+-------+---------+\n|acct_num|first_name|  last_name|zipcode| id|  zip|         city|state|    lat|      lon|\n+--------+----------+-----------+-------+---+-----+-------------+-----+-------+---------+\n|      37|    Cheryl|       West|  94622|231|94622|      Oakland|   CA| 37.799|-122.2337|\n|      56|   Terrell|   Hardiman|  94261|127|94261|   Sacramento|   CA|38.3774|-121.4444|\n|      60|     Irwin|Clatterbuck|  94403|185|94403|    San Mateo|   CA|37.5395|-122.2998|\n|      68|    Walter|    Greiner|  94701| 35|94701|     Berkeley|   CA|37.8606|-122.2967|\n|     126|     Keith|     Branan|  94623| 34|94623|      Oakland|   CA|37.6802|-121.9215|\n|     130|   Maynard|     Penley|  94120|165|94120|San Francisco|   CA|37.7848|-122.7278|\n|     179|     Julia|    Nowicki|  94059|182|94059| Redwood City|   CA|37.3811|-122.3348|\n|     183| Elizabeth|   McMillan|  94150|173|94150|San Francisco|   CA|37.7848|-122.7278|\n|     196|     Bruce|     Vargas|  94975|211|94975|     Petaluma|   CA|38.4631|  -122.99|\n|     233|     Arden|      Black|  94088|190|94088|    Sunnyvale|   CA|37.1894|-121.7053|\n|     241|    Conrad|  Fairchild|  94116|164|94116|San Francisco|   CA|37.7441|-122.4863|\n|     275|   Chelsea|      Gaona|  94040|189|94040|Mountain View|   CA|37.3855| -122.088|\n|     410|   Kenneth|    Nowicki|  94110|163|94110|San Francisco|   CA|37.7509|-122.4153|\n|     415|     Jason|       King|  94529| 39|94529|      Concord|   CA|37.7772|-121.9554|\n|     435|    Andrew|      Oakes|  94130|167|94130|San Francisco|   CA|37.8231|-122.3693|\n|     481|     Grace|     Brooks|  95675| 37|95675|  River Pines|   CA|38.5463| -120.743|\n|     489|    George|       Sams|  94088|190|94088|    Sunnyvale|   CA|37.1894|-121.7053|\n|     530|       Ann|   Stennett|  95190|202|95190|     San Jose|   CA|37.3894|-121.8868|\n|     543|      Joan|     Benito|  95915|121|95915|       Belden|   CA|39.9324|-121.3144|\n|     556|  Gretchen|    Akridge|  94074|184|94074| San Gregorio|   CA|37.3255|-122.3556|\n+--------+----------+-----------+-------+---+-----+-------------+-----+-------+---------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1603769333390_724109292","id":"20200424-204205_958335764","dateCreated":"2020-10-27T03:28:53+0000","dateStarted":"2020-12-10T00:54:16+0000","dateFinished":"2020-12-10T00:54:16+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:47233"},{"title":"","text":"%md\nSome account holders live in zip codes that have a base station. Join `baseDF` and `accountDF` to find those users. For \neach of those users, include their account ID, first name, last name, and the ID and location data (latitude and longitude) \nfor the base station in their zip code.","user":"devuser","dateUpdated":"2020-11-08T23:48:06+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"title":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Some account holders live in zip codes that have a base station. Join <code>baseDF</code> and <code>accountDF</code> to find those users. For\n<br  />each of those users, include their account ID, first name, last name, and the ID and location data (latitude and longitude)\n<br  />for the base station in their zip code.</p>\n"}]},"apps":[],"jobName":"paragraph_1603769333389_-1123024556","id":"20200424-204225_1650611891","dateCreated":"2020-10-27T03:28:53+0000","dateStarted":"2020-11-08T23:48:06+0000","dateFinished":"2020-11-08T23:48:06+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:47234"},{"text":"%md\n#### Count Active Devices","user":"devuser","dateUpdated":"2020-11-08T23:41:15+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h4>Count Active Devices</h4>\n"}]},"apps":[],"jobName":"paragraph_1603769333390_1328886675","id":"20200428-023757_1155572954","dateCreated":"2020-10-27T03:28:53+0000","dateStarted":"2020-11-08T23:41:15+0000","dateFinished":"2020-11-08T23:41:15+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:47235"},{"title":"19 - Review the account device data and upload it to HDFS","text":"%sh\nhdfs dfs -rm -r -skipTrash /user/zeppelin/device.json\nhdfs dfs -rm -r -skipTrash /user/zeppelin/account_device\nhdfs dfs -put /var/data/telco/device.json /user/zeppelin/device.json\nhdfs dfs -put /var/data/telco/account_device /user/zeppelin/account_device\nhdfs dfs -ls /user/zeppelin/","user":"devuser","dateUpdated":"2020-12-10T00:54:22+0000","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"results":{},"enabled":true,"title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Deleted /user/zeppelin/device.json\nDeleted /user/zeppelin/account_device\nFound 14 items\ndrwx------   - zeppelin hdfs          0 2020-11-20 00:00 /user/zeppelin/.Trash\ndrwxrwxrwx   - zeppelin hdfs          0 2020-12-09 23:53 /user/zeppelin/.sparkStaging\ndrwx------   - zeppelin hdfs          0 2020-12-09 00:48 /user/zeppelin/.staging\ndrwxr-xr-x   - zeppelin hdfs          0 2020-12-10 00:54 /user/zeppelin/account_device\ndrwxr-xr-x   - zeppelin hdfs          0 2020-12-10 00:24 /user/zeppelin/account_zip94913\n-rw-r--r--   3 zeppelin hdfs      13149 2020-12-10 00:54 /user/zeppelin/base_station.parquet\ndrwxrwxrwx   - zeppelin hdfs          0 2020-12-09 18:19 /user/zeppelin/conf\n-rw-r--r--   3 zeppelin hdfs       5483 2020-12-10 00:54 /user/zeppelin/device.json\ndrwxr-xr-x   - zeppelin hdfs          0 2020-12-10 00:25 /user/zeppelin/device_parquet\ndrwxr-xr-x   - zeppelin hdfs          0 2020-12-02 02:20 /user/zeppelin/hive\ndrwxrwxrwx   - zeppelin hdfs          0 2020-11-20 04:54 /user/zeppelin/notebook\ndrwxr-xr-x   - zeppelin hdfs          0 2020-11-17 16:13 /user/zeppelin/nyse\ndrwxr-xr-x   - zeppelin hdfs          0 2020-11-19 14:18 /user/zeppelin/test\ndrwxr-xr-x   - zeppelin hdfs          0 2020-12-10 00:49 /user/zeppelin/top_device\n"}]},"apps":[],"jobName":"paragraph_1603769333390_871095816","id":"20200521-201713_1902770408","dateCreated":"2020-10-27T03:28:53+0000","dateStarted":"2020-12-10T00:54:22+0000","dateFinished":"2020-12-10T00:54:32+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:47236"},{"title":" ","text":"%md\nThe `accountdevice` CSV dataset contains a list of all the devices used by all accounts. Each row in the data set \nincludes a row ID, an account ID, an ID for the type of device, the date the device was activated for the account, \nand the specific device ID.\n\nThe CSV data file is in the `/var/data/telco/accountdevice` directory. Review the data in the data set, \nthen upload the directory and its contents to the HDFS directory `/user/zeppelin/accountdevice`.","user":"devuser","dateUpdated":"2020-11-08T23:48:29+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"title":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>The <code>accountdevice</code> CSV dataset contains a list of all the devices used by all accounts. Each row in the data set\n<br  />includes a row ID, an account ID, an ID for the type of device, the date the device was activated for the account,\n<br  />and the specific device ID.</p>\n<p>The CSV data file is in the <code>/var/data/telco/accountdevice</code> directory. Review the data in the data set,\n<br  />then upload the directory and its contents to the HDFS directory <code>/user/zeppelin/accountdevice</code>.</p>\n"}]},"apps":[],"jobName":"paragraph_1603769333390_1412897660","id":"20200424-203930_1058017229","dateCreated":"2020-10-27T03:28:53+0000","dateStarted":"2020-11-08T23:48:29+0000","dateFinished":"2020-11-08T23:48:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:47237"},{"title":"20 - Create a DataFrame based on the account device data","text":"%pyspark\naccountDeviceDF = spark.read.option(\"header\",\"true\"). \\\noption(\"inferSchema\",\"true\"). \\\ncsv(\"/user/zeppelin/account_device\")","user":"devuser","dateUpdated":"2020-12-10T00:54:36+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true,"title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1603769333390_-1249785647","id":"20200428-024633_1113292222","dateCreated":"2020-10-27T03:28:53+0000","dateStarted":"2020-12-10T00:54:36+0000","dateFinished":"2020-12-10T00:54:37+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:47238"},{"title":"21 - Analyze the data presented in this exercise","text":"%pyspark\n# Create a DataFrame with only active accounts\nactiveAccountDF = accountDF.where(accountDF.acct_close_dt.isNull())\n\n# Create a DataFrame with a device model IDs for only devices used by active accounts\nactiveAcctDevDF =  activeAccountDF.join(accountDeviceDF,activeAccountDF.acct_num == accountDeviceDF.account_id).select(\"device_id\")\n\n# Sum up the total number of each device model \nsumDeviceDF = activeAcctDevDF.groupBy(\"device_id\").count().withColumnRenamed(\"count\",\"active_num\")\n\n# Order by count in descending order\norderDeviceDF = sumDeviceDF.orderBy(sumDeviceDF.active_num.desc())\n\n# Create a DataFrame based on the devices.json file\ndevDF = spark.read.json(\"/user/zeppelin/device.json\")\n\n# Join the list of device model totals with the list of devices\n# to get the make and model for each device\njoinDeviceDF = orderDeviceDF.join(devDF,sumDeviceDF.device_id == devDF.devnum)\n\n# Write out the data with the correct columns\n# Use overwrite mode so the solution can be run multiple times\njoinDeviceDF.select(\"device_id\",\"make\",\"model\",joinDeviceDF.active_num).write.mode(\"overwrite\").save(\"/user/zeppelin/top_device\")\n# *** ^^^Should be saved as parquet\n#?? joinDeviceDF.select(\"device_id\",\"make\",\"modle\",joinDeviceDF.active_num).write.mode(\"overwrite\").parquet(\"/user/zeppelin/top_device\")","user":"devuser","dateUpdated":"2020-12-10T00:54:39+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true,"title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1603769333391_-1373475138","id":"20200428-024202_845661804","dateCreated":"2020-10-27T03:28:53+0000","dateStarted":"2020-12-10T00:54:39+0000","dateFinished":"2020-12-10T00:54:42+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:47239"},{"title":" ","text":"%md\nUse the account device data and the DataFrames you created previously in this exercise to find the total number of each device model across all *active* accounts -- that is, accounts that have not been closed. The new DataFrame should be sorted from most to least common model. Save the data as Parquet files in a directory called `/user/zeppelin/top_device` with the following columns:\n\n```\n| Column Name | Description                                                                                  | Example Value  |\n|-------------|----------------------------------------------------------------------------------------------|----------------|\n| device_id   | The ID number of each known device (including those that might not be in use by any account) | 18             |\n| make        | The manufacturer name for the device                                                         | Ronin          |\n| model       | The model name for the device                                                                | Novelty Note 2 |\n| active_num  | The total number of the model used by active accounts                                        | 2092           |\n```\n\nHints:\n- Active accounts are those with a null value for `acct_close_dt` (account close date) in the `account` table.\n- The `account_id` column in the device accounts data corresponds to the `acct_num` column in `account` table.\n- The `device_id` column in the device accounts data corresponds to the devnum column in the list of known \n  devices in the `/data/telco/devices.json` file.\n- When you count devices, use `withColumnRenamed` to rename the count column to `active_num`. (The `count` \n  column name is ambiguous because it is both a function and a column.)\n- The query to complete this exercise is somewhat complicated and includes a sequence of many transformations. \n    - You may wish to assign variables to the intermediate DataFrames resulting from the transformations that make up the query to make the code easier to work with and debug.","user":"devuser","dateUpdated":"2020-12-10T00:51:10+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Use the account device data and the DataFrames you created previously in this exercise to find the total number of each device model across all <em>active</em> accounts &ndash; that is, accounts that have not been closed. The new DataFrame should be sorted from most to least common model. Save the data as Parquet files in a directory called <code>/user/zeppelin/top_device</code> with the following columns:</p>\n<pre><code>| Column Name | Description                                                                                  | Example Value  |\n|-------------|----------------------------------------------------------------------------------------------|----------------|\n| device_id   | The ID number of each known device (including those that might not be in use by any account) | 18             |\n| make        | The manufacturer name for the device                                                         | Ronin          |\n| model       | The model name for the device                                                                | Novelty Note 2 |\n| active_num  | The total number of the model used by active accounts                                        | 2092           |\n</code></pre>\n<p>Hints:</p>\n<ul>\n<li>Active accounts are those with a null value for <code>acct_close_dt</code> (account close date) in the <code>account</code> table.</li>\n<li>The <code>account_id</code> column in the device accounts data corresponds to the <code>acct_num</code> column in <code>account</code> table.</li>\n<li>The <code>device_id</code> column in the device accounts data corresponds to the devnum column in the list of known\n<br  />devices in the <code>/data/telco/devices.json</code> file.</li>\n<li>When you count devices, use <code>withColumnRenamed</code> to rename the count column to <code>active_num</code>. (The <code>count</code>\n<br  />column name is ambiguous because it is both a function and a column.)</li>\n<li>The query to complete this exercise is somewhat complicated and includes a sequence of many transformations.<ul>\n<li>You may wish to assign variables to the intermediate DataFrames resulting from the transformations that make up the query to make the code easier to work with and debug.</li>\n</ul>\n</li>\n</ul>\n"}]},"apps":[],"jobName":"paragraph_1603769333391_-1109586929","id":"20200424-202645_1446658215","dateCreated":"2020-10-27T03:28:53+0000","dateStarted":"2020-12-10T00:51:01+0000","dateFinished":"2020-12-10T00:51:01+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:47240"},{"title":"22 - Review the resulting file","text":"%sh\nrm -r /tmp/top_device\nhdfs dfs -get /user/zeppelin/top_device /tmp/\nls /tmp/top_device\n\n# In a separate shell:\n#parquet-tools head /tmp/top_device","user":"devuser","dateUpdated":"2020-12-10T00:54:47+0000","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"part-00000-01fedbcb-6776-4af1-8d3e-4f97c6fefc8b-c000.snappy.parquet\npart-00001-01fedbcb-6776-4af1-8d3e-4f97c6fefc8b-c000.snappy.parquet\npart-00002-01fedbcb-6776-4af1-8d3e-4f97c6fefc8b-c000.snappy.parquet\npart-00003-01fedbcb-6776-4af1-8d3e-4f97c6fefc8b-c000.snappy.parquet\npart-00004-01fedbcb-6776-4af1-8d3e-4f97c6fefc8b-c000.snappy.parquet\npart-00005-01fedbcb-6776-4af1-8d3e-4f97c6fefc8b-c000.snappy.parquet\npart-00006-01fedbcb-6776-4af1-8d3e-4f97c6fefc8b-c000.snappy.parquet\npart-00007-01fedbcb-6776-4af1-8d3e-4f97c6fefc8b-c000.snappy.parquet\npart-00008-01fedbcb-6776-4af1-8d3e-4f97c6fefc8b-c000.snappy.parquet\npart-00009-01fedbcb-6776-4af1-8d3e-4f97c6fefc8b-c000.snappy.parquet\npart-00010-01fedbcb-6776-4af1-8d3e-4f97c6fefc8b-c000.snappy.parquet\npart-00011-01fedbcb-6776-4af1-8d3e-4f97c6fefc8b-c000.snappy.parquet\npart-00012-01fedbcb-6776-4af1-8d3e-4f97c6fefc8b-c000.snappy.parquet\npart-00013-01fedbcb-6776-4af1-8d3e-4f97c6fefc8b-c000.snappy.parquet\npart-00014-01fedbcb-6776-4af1-8d3e-4f97c6fefc8b-c000.snappy.parquet\npart-00015-01fedbcb-6776-4af1-8d3e-4f97c6fefc8b-c000.snappy.parquet\npart-00016-01fedbcb-6776-4af1-8d3e-4f97c6fefc8b-c000.snappy.parquet\npart-00017-01fedbcb-6776-4af1-8d3e-4f97c6fefc8b-c000.snappy.parquet\npart-00018-01fedbcb-6776-4af1-8d3e-4f97c6fefc8b-c000.snappy.parquet\npart-00019-01fedbcb-6776-4af1-8d3e-4f97c6fefc8b-c000.snappy.parquet\npart-00020-01fedbcb-6776-4af1-8d3e-4f97c6fefc8b-c000.snappy.parquet\npart-00021-01fedbcb-6776-4af1-8d3e-4f97c6fefc8b-c000.snappy.parquet\npart-00022-01fedbcb-6776-4af1-8d3e-4f97c6fefc8b-c000.snappy.parquet\npart-00023-01fedbcb-6776-4af1-8d3e-4f97c6fefc8b-c000.snappy.parquet\npart-00024-01fedbcb-6776-4af1-8d3e-4f97c6fefc8b-c000.snappy.parquet\npart-00025-01fedbcb-6776-4af1-8d3e-4f97c6fefc8b-c000.snappy.parquet\npart-00026-01fedbcb-6776-4af1-8d3e-4f97c6fefc8b-c000.snappy.parquet\npart-00027-01fedbcb-6776-4af1-8d3e-4f97c6fefc8b-c000.snappy.parquet\npart-00028-01fedbcb-6776-4af1-8d3e-4f97c6fefc8b-c000.snappy.parquet\npart-00029-01fedbcb-6776-4af1-8d3e-4f97c6fefc8b-c000.snappy.parquet\npart-00030-01fedbcb-6776-4af1-8d3e-4f97c6fefc8b-c000.snappy.parquet\npart-00031-01fedbcb-6776-4af1-8d3e-4f97c6fefc8b-c000.snappy.parquet\npart-00032-01fedbcb-6776-4af1-8d3e-4f97c6fefc8b-c000.snappy.parquet\npart-00033-01fedbcb-6776-4af1-8d3e-4f97c6fefc8b-c000.snappy.parquet\npart-00034-01fedbcb-6776-4af1-8d3e-4f97c6fefc8b-c000.snappy.parquet\npart-00035-01fedbcb-6776-4af1-8d3e-4f97c6fefc8b-c000.snappy.parquet\npart-00036-01fedbcb-6776-4af1-8d3e-4f97c6fefc8b-c000.snappy.parquet\npart-00037-01fedbcb-6776-4af1-8d3e-4f97c6fefc8b-c000.snappy.parquet\npart-00038-01fedbcb-6776-4af1-8d3e-4f97c6fefc8b-c000.snappy.parquet\npart-00039-01fedbcb-6776-4af1-8d3e-4f97c6fefc8b-c000.snappy.parquet\npart-00040-01fedbcb-6776-4af1-8d3e-4f97c6fefc8b-c000.snappy.parquet\npart-00041-01fedbcb-6776-4af1-8d3e-4f97c6fefc8b-c000.snappy.parquet\npart-00042-01fedbcb-6776-4af1-8d3e-4f97c6fefc8b-c000.snappy.parquet\npart-00043-01fedbcb-6776-4af1-8d3e-4f97c6fefc8b-c000.snappy.parquet\npart-00044-01fedbcb-6776-4af1-8d3e-4f97c6fefc8b-c000.snappy.parquet\npart-00045-01fedbcb-6776-4af1-8d3e-4f97c6fefc8b-c000.snappy.parquet\npart-00046-01fedbcb-6776-4af1-8d3e-4f97c6fefc8b-c000.snappy.parquet\npart-00047-01fedbcb-6776-4af1-8d3e-4f97c6fefc8b-c000.snappy.parquet\npart-00048-01fedbcb-6776-4af1-8d3e-4f97c6fefc8b-c000.snappy.parquet\npart-00049-01fedbcb-6776-4af1-8d3e-4f97c6fefc8b-c000.snappy.parquet\n_SUCCESS\n"}]},"apps":[],"jobName":"paragraph_1603769333391_272778017","id":"20200602-190907_1352716578","dateCreated":"2020-10-27T03:28:53+0000","dateStarted":"2020-12-10T00:54:47+0000","dateFinished":"2020-12-10T00:54:49+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:47241"},{"text":"%md\n# Reset\nNo reset is required.","user":"devuser","dateUpdated":"2020-12-01T22:45:54+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>Reset</h1>\n<p>No reset is required.</p>\n"}]},"apps":[],"jobName":"paragraph_1606862696837_348720755","id":"20201201-224456_1187241398","dateCreated":"2020-12-01T22:44:56+0000","dateStarted":"2020-12-01T22:45:54+0000","dateFinished":"2020-12-01T22:45:54+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:47242"},{"text":"%md\n# Exercise","user":"devuser","dateUpdated":"2020-12-01T21:36:50+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>Exercise</h1>\n"}]},"apps":[],"jobName":"paragraph_1603769333391_494483567","id":"20181018-125200_1133281582","dateCreated":"2020-10-27T03:28:53+0000","dateStarted":"2020-12-01T21:36:20+0000","dateFinished":"2020-12-01T21:36:20+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:47243"},{"text":"%md\n### Query DataFrames Using Column Expressions","user":"devuser","dateUpdated":"2020-10-27T03:28:53+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Query DataFrames Using Column Expressions</h3>\n"}]},"apps":[],"jobName":"paragraph_1603769333392_343388135","id":"20200428-232253_1213291613","dateCreated":"2020-10-27T03:28:53+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:47244"},{"title":"1 - Review the API documentation for the Spark Column class","text":"","user":"devuser","dateUpdated":"2020-10-27T03:28:53+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1603769333392_516235020","id":"20200428-232312_1160155618","dateCreated":"2020-10-27T03:28:53+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:47245"},{"title":"2 - Create a new DataFrame called accountsDF","text":"%pyspark\n","user":"devuser","dateUpdated":"2020-12-01T20:54:39+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- acct_num: integer (nullable = true)\n |-- acct_create_dt: timestamp (nullable = true)\n |-- acct_close_dt: timestamp (nullable = true)\n |-- first_name: string (nullable = true)\n |-- last_name: string (nullable = true)\n |-- address: string (nullable = true)\n |-- city: string (nullable = true)\n |-- state: string (nullable = true)\n |-- zipcode: string (nullable = true)\n |-- phone_number: string (nullable = true)\n |-- created: timestamp (nullable = true)\n |-- modified: timestamp (nullable = true)\n\n+--------+-------------------+-------------------+----------+---------+--------------------+-------------+-----+-------+------------+-------------------+-------------------+\n|acct_num|     acct_create_dt|      acct_close_dt|first_name|last_name|             address|         city|state|zipcode|phone_number|            created|           modified|\n+--------+-------------------+-------------------+----------+---------+--------------------+-------------+-----+-------+------------+-------------------+-------------------+\n|       1|2008-10-23 16:05:05|               null|    Donald|   Becton|2275 Washburn Street|      Oakland|   CA|  94660|  5100032418|2014-03-18 13:29:47|2014-03-18 13:29:47|\n|       2|2008-11-12 03:00:01|               null|     Donna|    Jones| 3885 Elliott Street|San Francisco|   CA|  94171|  4150835799|2014-03-18 13:29:47|2014-03-18 13:29:47|\n|       3|2008-12-21 09:19:50|               null|    Dorthy| Chalmers|    4073 Whaley Lane|    San Mateo|   CA|  94479|  6506877757|2014-03-18 13:29:47|2014-03-18 13:29:47|\n|       4|2008-11-28 00:08:09|               null|     Leila|  Spencer|    1447 Ross Street|    San Mateo|   CA|  94444|  6503198619|2014-03-18 13:29:47|2014-03-18 13:29:47|\n|       5|2008-11-15 23:06:06|               null|     Anita| Laughlin|    2767 Hill Street|     Richmond|   CA|  94872|  5107754354|2014-03-18 13:29:47|2014-03-18 13:29:47|\n|       6|2008-11-20 12:39:33|2014-03-01 07:37:48|    Stevie|   Bridge|   3977 Linda Street|   Sacramento|   CA|  94264|  9162111862|2014-03-18 13:29:47|2014-03-18 13:29:47|\n|       7|2008-12-09 10:32:12|2010-10-16 10:01:51|     David|   Eggers|    2109 Ross Street|      Oakland|   CA|  94508|  5103935529|2014-03-18 13:29:47|2014-03-18 13:29:47|\n|       8|2008-12-15 08:49:38|               null|   Dorothy|  Koopman|   1985 Pratt Avenue|    San Mateo|   CA|  94469|  6502406661|2014-03-18 13:29:47|2014-03-18 13:29:47|\n|       9|2008-11-07 17:58:55|2014-02-14 01:26:52|      Kara|     Kohl|     235 Fort Street|    Palo Alto|   CA|  94312|  6502384894|2014-03-18 13:29:47|2014-03-18 13:29:47|\n|      10|2008-12-02 23:28:01|               null|     Diane|   Nelson|      921 Sardis Sta|      Oakland|   CA|  94577|  5102711264|2014-03-18 13:29:47|2014-03-18 13:29:47|\n|      11|2008-10-27 19:37:29|               null|    Robert|   Fisher|  3710 Heliport Loop|      Oakland|   CA|  94669|  5109726353|2014-03-18 13:29:47|2014-03-18 13:29:47|\n|      12|2008-12-21 23:21:53|               null|    Marcia|  Roberts|   3616 Augusta Park|    Palo Alto|   CA|  94322|  6505209743|2014-03-18 13:29:47|2014-03-18 13:29:47|\n|      13|2008-10-28 14:27:18|               null|    Andres|    Cruse|518 John Daniel D...|San Francisco|   CA|  94143|  4153335996|2014-03-18 13:29:47|2014-03-18 13:29:47|\n|      14|2008-11-29 18:25:38|               null|       Ann|    Moore|4984 Buena Vista ...|   Sacramento|   CA|  94234|  9163145431|2014-03-18 13:29:47|2014-03-18 13:29:47|\n|      15|2008-11-14 09:22:05|               null|    Joseph|   Lackey|  3977 Snowbird Lane|     Berkeley|   CA|  94726|  5108428188|2014-03-18 13:29:47|2014-03-18 13:29:47|\n|      16|2008-12-03 23:48:22|2013-08-01 15:10:07|     Sarah|   Duvall|    4875 Essex Court|San Francisco|   CA|  94056|  4154969289|2014-03-18 13:29:47|2014-03-18 13:29:47|\n|      17|2008-12-27 23:31:40|               null|      Lucy|   Corley|   4834 Brown Street|   Santa Rosa|   CA|  94980|  7076068290|2014-03-18 13:29:47|2014-03-18 13:29:47|\n|      18|2008-11-05 11:16:01|               null|    Roland| Crawford| 2951 Allison Avenue|    Palo Alto|   CA|  94373|  6506033983|2014-03-18 13:29:47|2014-03-18 13:29:47|\n|      19|2008-11-13 23:40:53|2014-02-26 18:44:26|     Leona|     Bray|      364 Romrog Way|   Santa Rosa|   CA|  94913|  7070013038|2014-03-18 13:29:47|2014-03-18 13:29:47|\n|      20|2008-11-02 07:55:25|               null|   Forrest|   Becker|4211 Lightning Po...|   Santa Rosa|   CA|  94902|  7075831640|2014-03-18 13:29:47|2014-03-18 13:29:47|\n+--------+-------------------+-------------------+----------+---------+--------------------+-------------+-----+-------+------------+-------------------+-------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1603769333392_-338835103","id":"20200428-232339_1779103463","dateCreated":"2020-10-27T03:28:53+0000","dateStarted":"2020-11-20T18:46:48+0000","dateFinished":"2020-11-20T18:46:48+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:47246"},{"title":"3 - Practice using both column reference syntaxes","text":"%pyspark\n# Syntax 1\n\n\n# Syntax 2\n","user":"devuser","dateUpdated":"2020-12-01T20:55:37+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------+\n|first_name|\n+----------+\n|    Donald|\n|     Donna|\n|    Dorthy|\n|     Leila|\n|     Anita|\n|    Stevie|\n|     David|\n|   Dorothy|\n|      Kara|\n|     Diane|\n|    Robert|\n|    Marcia|\n|    Andres|\n|       Ann|\n|    Joseph|\n|     Sarah|\n|      Lucy|\n|    Roland|\n|     Leona|\n|   Forrest|\n+----------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1603769333392_-830182030","id":"20200428-232337_600421207","dateCreated":"2020-10-27T03:28:53+0000","dateStarted":"2020-11-20T18:48:45+0000","dateFinished":"2020-11-20T18:48:45+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:47247"},{"title":"4 - Create a column object","text":"%pyspark\n","user":"devuser","dateUpdated":"2020-12-01T20:55:37+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1603769333392_1554076991","id":"20200428-232337_398231540","dateCreated":"2020-10-27T03:28:53+0000","dateStarted":"2020-11-20T18:49:18+0000","dateFinished":"2020-11-20T18:49:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:47248"},{"title":"5 - View the available methods and attributes of the Column class","text":"%pyspark\n","user":"devuser","dateUpdated":"2020-12-01T20:55:37+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1603769333392_-635805613","id":"20200428-232336_2041671728","dateCreated":"2020-10-27T03:28:53+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:47249"},{"title":"6 - Use a column expression to create a new column object","text":"%pyspark\n","user":"devuser","dateUpdated":"2020-12-01T20:55:46+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1603769333393_860306770","id":"20200428-232336_254950066","dateCreated":"2020-10-27T03:28:53+0000","dateStarted":"2020-11-20T18:51:24+0000","dateFinished":"2020-11-20T18:51:24+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:47250"},{"title":"7 - Use the lucyCol column expression in a select statement","text":"%pyspark\n","user":"devuser","dateUpdated":"2020-12-01T20:56:07+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------+---------+-------------------+\n|first_name|last_name|(first_name = Lucy)|\n+----------+---------+-------------------+\n|    Donald|   Becton|              false|\n|     Donna|    Jones|              false|\n|    Dorthy| Chalmers|              false|\n|     Leila|  Spencer|              false|\n|     Anita| Laughlin|              false|\n|    Stevie|   Bridge|              false|\n|     David|   Eggers|              false|\n|   Dorothy|  Koopman|              false|\n|      Kara|     Kohl|              false|\n|     Diane|   Nelson|              false|\n|    Robert|   Fisher|              false|\n|    Marcia|  Roberts|              false|\n|    Andres|    Cruse|              false|\n|       Ann|    Moore|              false|\n|    Joseph|   Lackey|              false|\n|     Sarah|   Duvall|              false|\n|      Lucy|   Corley|               true|\n|    Roland| Crawford|              false|\n|     Leona|     Bray|              false|\n|   Forrest|   Becker|              false|\n+----------+---------+-------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1603769333393_471263979","id":"20200428-232335_334373975","dateCreated":"2020-10-27T03:28:53+0000","dateStarted":"2020-11-20T18:51:32+0000","dateFinished":"2020-11-20T18:51:32+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:47251"},{"title":"8 - Use the where operation","text":"%pyspark\n","user":"devuser","dateUpdated":"2020-12-01T20:56:07+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------+-------------------+-------------------+----------+---------+--------------------+----------+-----+-------+------------+-------------------+-------------------+\n|acct_num|     acct_create_dt|      acct_close_dt|first_name|last_name|             address|      city|state|zipcode|phone_number|            created|           modified|\n+--------+-------------------+-------------------+----------+---------+--------------------+----------+-----+-------+------------+-------------------+-------------------+\n|      17|2008-12-27 23:31:40|               null|      Lucy|   Corley|   4834 Brown Street|Santa Rosa|   CA|  94980|  7076068290|2014-03-18 13:29:47|2014-03-18 13:29:47|\n|    1762|2009-03-19 23:43:00|               null|      Lucy|    Davis|2195 Riverside Drive|Sacramento|   CA|  95620|  9169959437|2014-03-18 13:29:50|2014-03-18 13:29:50|\n|    6551|2010-09-04 19:28:22|2014-02-14 19:19:16|      Lucy|  Casiano|2821 Wood Duck Drive|  Alhambra|   CA|  91810|  6261078791|2014-03-18 13:29:59|2014-03-18 13:29:59|\n|    6978|2010-09-22 07:13:16|               null|      Lucy|      Lee|4781 Shadowmar Drive|   Salinas|   CA|  93961|  8315367970|2014-03-18 13:30:00|2014-03-18 13:30:00|\n|    7107|2010-02-10 00:23:38|2014-01-23 22:55:06|      Lucy| Hastings|   4759 Gateway Road|    Fresno|   CA|  93692|  5595001084|2014-03-18 13:30:00|2014-03-18 13:30:00|\n+--------+-------------------+-------------------+----------+---------+--------------------+----------+-----+-------+------------+-------------------+-------------------+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1603769333393_-1067880532","id":"20200428-232335_471510672","dateCreated":"2020-10-27T03:28:53+0000","dateStarted":"2020-11-20T18:52:17+0000","dateFinished":"2020-11-20T18:52:17+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:47252"},{"title":"9 - Try a query without assigning the result to a variable","text":"%pyspark\n","user":"devuser","dateUpdated":"2020-12-01T20:56:21+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------+-------------------+-------------------+----------+---------+--------------------+----------+-----+-------+------------+-------------------+-------------------+\n|acct_num|     acct_create_dt|      acct_close_dt|first_name|last_name|             address|      city|state|zipcode|phone_number|            created|           modified|\n+--------+-------------------+-------------------+----------+---------+--------------------+----------+-----+-------+------------+-------------------+-------------------+\n|      17|2008-12-27 23:31:40|               null|      Lucy|   Corley|   4834 Brown Street|Santa Rosa|   CA|  94980|  7076068290|2014-03-18 13:29:47|2014-03-18 13:29:47|\n|    1762|2009-03-19 23:43:00|               null|      Lucy|    Davis|2195 Riverside Drive|Sacramento|   CA|  95620|  9169959437|2014-03-18 13:29:50|2014-03-18 13:29:50|\n|    6551|2010-09-04 19:28:22|2014-02-14 19:19:16|      Lucy|  Casiano|2821 Wood Duck Drive|  Alhambra|   CA|  91810|  6261078791|2014-03-18 13:29:59|2014-03-18 13:29:59|\n|    6978|2010-09-22 07:13:16|               null|      Lucy|      Lee|4781 Shadowmar Drive|   Salinas|   CA|  93961|  8315367970|2014-03-18 13:30:00|2014-03-18 13:30:00|\n|    7107|2010-02-10 00:23:38|2014-01-23 22:55:06|      Lucy| Hastings|   4759 Gateway Road|    Fresno|   CA|  93692|  5595001084|2014-03-18 13:30:00|2014-03-18 13:30:00|\n+--------+-------------------+-------------------+----------+---------+--------------------+----------+-----+-------+------------+-------------------+-------------------+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1603769333393_449077092","id":"20200428-232335_698368359","dateCreated":"2020-10-27T03:28:53+0000","dateStarted":"2020-11-20T18:53:01+0000","dateFinished":"2020-11-20T18:53:02+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:47253"},{"title":"10 - Column expressions can be used wherever a column could be used","text":"%pyspark\n","user":"devuser","dateUpdated":"2020-12-01T20:56:39+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------+-----+-----------------------------+\n|         city|state|substring(phone_number, 1, 3)|\n+-------------+-----+-----------------------------+\n|      Oakland|   CA|                          510|\n|San Francisco|   CA|                          415|\n|    San Mateo|   CA|                          650|\n|    San Mateo|   CA|                          650|\n|     Richmond|   CA|                          510|\n+-------------+-----+-----------------------------+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1603769333393_1943215458","id":"20200428-232335_1184100242","dateCreated":"2020-10-27T03:28:53+0000","dateStarted":"2020-11-20T18:55:23+0000","dateFinished":"2020-11-20T18:55:23+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:47254"},{"title":"11 - Use the alias operator to rename a column","text":"%pyspark\n","user":"devuser","dateUpdated":"2020-12-01T20:57:11+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------+-----+---------+\n|         city|state|area_code|\n+-------------+-----+---------+\n|      Oakland|   CA|      510|\n|San Francisco|   CA|      415|\n|    San Mateo|   CA|      650|\n|    San Mateo|   CA|      650|\n|     Richmond|   CA|      510|\n+-------------+-----+---------+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1603769333393_1088652291","id":"20200428-232334_1233728225","dateCreated":"2020-10-27T03:28:53+0000","dateStarted":"2020-11-20T18:55:59+0000","dateFinished":"2020-11-20T18:55:59+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:47255"},{"title":"12 - Practice using transformations","text":"%pyspark\n","user":"devuser","dateUpdated":"2020-12-01T20:57:11+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------+---------+\n|first_name|last_name|\n+----------+---------+\n|   Johnnie|    Jones|\n|    Robert|   Roller|\n|   Michael|  Minnick|\n| Rosemarie|Robertson|\n|     Keith|   Kemble|\n+----------+---------+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1603769333394_838177948","id":"20200428-232334_1759454808","dateCreated":"2020-10-27T03:28:53+0000","dateStarted":"2020-11-20T18:57:52+0000","dateFinished":"2020-11-20T18:57:52+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:47256"},{"text":"%md\n#### Group and Count Data by Name","user":"devuser","dateUpdated":"2020-11-09T03:45:09+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h4>Group and Count Data by Name</h4>\n"}]},"apps":[],"jobName":"paragraph_1603769333394_-671990959","id":"20200428-232334_821188933","dateCreated":"2020-10-27T03:28:53+0000","dateStarted":"2020-11-09T03:45:09+0000","dateFinished":"2020-11-09T03:45:09+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:47257"},{"title":"13 - Query the DataFrame using groupBy with the count aggregation transformation","text":"%pyspark\n","user":"devuser","dateUpdated":"2020-12-01T20:57:37+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---------+-----+\n|last_name|count|\n+---------+-----+\n| Landwehr|    4|\n|    Roach|   35|\n|  Jemison|    5|\n|     Hitz|    4|\n| Yearwood|    5|\n|     Legg|   11|\n|    Bever|    2|\n|    Sword|    4|\n|    Tyler|   50|\n| Francois|    6|\n+---------+-----+\nonly showing top 10 rows\n\n"}]},"apps":[],"jobName":"paragraph_1603769333394_1477883806","id":"20200428-232334_1509899401","dateCreated":"2020-10-27T03:28:53+0000","dateStarted":"2020-11-20T18:58:40+0000","dateFinished":"2020-11-20T18:58:42+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:47258"},{"title":"14 - Use groupBy on multiple columns","text":"%pyspark\n","user":"devuser","dateUpdated":"2020-12-01T20:57:37+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---------+----------+-----+\n|last_name|first_name|count|\n+---------+----------+-----+\n| Williams|   Lillian|    6|\n|Robertson| Rosemarie|    3|\n|     Bell|    Joanna|    3|\n|    Spano|    Amanda|    3|\n|    Beane|     Marie|    3|\n+---------+----------+-----+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1603769333394_-1070447655","id":"20200428-232334_896687392","dateCreated":"2020-10-27T03:28:53+0000","dateStarted":"2020-11-20T18:59:07+0000","dateFinished":"2020-11-20T18:59:08+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:47259"},{"text":"%md\n#### Join Account Data with Cellular Towers by Zip Code","user":"devuser","dateUpdated":"2020-11-09T03:45:45+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h4>Join Account Data with Cellular Towers by Zip Code</h4>\n"}]},"apps":[],"jobName":"paragraph_1603769333394_-1932943720","id":"20200428-232334_931178343","dateCreated":"2020-10-27T03:28:53+0000","dateStarted":"2020-11-09T03:45:45+0000","dateFinished":"2020-11-09T03:45:45+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:47260"},{"title":"15 - Review the base_station.parquet file","text":"","user":"devuser","dateUpdated":"2020-11-20T04:35:53+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true,"editorHide":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1603769333395_688652805","id":"20200428-232334_1714620989","dateCreated":"2020-10-27T03:28:53+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:47261"},{"title":"16 - Upload the data file to HDFS","text":"%sh\n","user":"devuser","dateUpdated":"2020-12-01T21:04:22+0000","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Deleted /user/zeppelin/base_station.parquet\nFound 14 items\ndrwx------   - zeppelin hdfs          0 2020-11-20 00:00 /user/zeppelin/.Trash\ndrwxrwxrwx   - zeppelin hdfs          0 2020-11-20 16:58 /user/zeppelin/.sparkStaging\ndrwx------   - zeppelin hdfs          0 2020-11-12 20:26 /user/zeppelin/.staging\ndrwxr-xr-x   - zeppelin hdfs          0 2020-11-20 04:50 /user/zeppelin/account_device\ndrwxr-xr-x   - zeppelin hdfs          0 2020-11-20 18:30 /user/zeppelin/account_zip94913\n-rw-r--r--   3 zeppelin hdfs      13149 2020-11-20 19:01 /user/zeppelin/base_station.parquet\ndrwxrwxrwx   - zeppelin hdfs          0 2020-11-20 14:10 /user/zeppelin/conf\n-rw-r--r--   3 zeppelin hdfs       5483 2020-11-20 17:44 /user/zeppelin/device.json\ndrwxr-xr-x   - zeppelin hdfs          0 2020-11-20 18:43 /user/zeppelin/device_parquet\ndrwxr-xr-x   - zeppelin hdfs          0 2020-11-20 05:03 /user/zeppelin/hive\ndrwxrwxrwx   - zeppelin hdfs          0 2020-11-20 04:54 /user/zeppelin/notebook\ndrwxr-xr-x   - zeppelin hdfs          0 2020-11-17 16:13 /user/zeppelin/nyse\ndrwxr-xr-x   - zeppelin hdfs          0 2020-11-19 14:18 /user/zeppelin/test\ndrwxr-xr-x   - zeppelin hdfs          0 2020-11-20 04:43 /user/zeppelin/top_device\n"}]},"apps":[],"jobName":"paragraph_1603769333395_1195168801","id":"20200428-232333_209687192","dateCreated":"2020-10-27T03:28:53+0000","dateStarted":"2020-11-20T19:01:29+0000","dateFinished":"2020-11-20T19:01:34+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:47262"},{"title":"17 - Create a new DataFrame using the base stations data","text":"%pyspark\n","user":"devuser","dateUpdated":"2020-12-01T21:04:22+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1603769333395_-1768314759","id":"20200428-232333_92654281","dateCreated":"2020-10-27T03:28:53+0000","dateStarted":"2020-11-20T19:02:00+0000","dateFinished":"2020-11-20T19:02:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:47263"},{"title":"18 - Perform a join on baseDF and accountsDF","text":"%pyspark\n","user":"devuser","dateUpdated":"2020-12-01T21:08:30+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------+----------+-----------+-------+---+-----+-------------+-----+-------+---------+\n|acct_num|first_name|  last_name|zipcode| id|  zip|         city|state|    lat|      lon|\n+--------+----------+-----------+-------+---+-----+-------------+-----+-------+---------+\n|      37|    Cheryl|       West|  94622|231|94622|      Oakland|   CA| 37.799|-122.2337|\n|      56|   Terrell|   Hardiman|  94261|127|94261|   Sacramento|   CA|38.3774|-121.4444|\n|      60|     Irwin|Clatterbuck|  94403|185|94403|    San Mateo|   CA|37.5395|-122.2998|\n|      68|    Walter|    Greiner|  94701| 35|94701|     Berkeley|   CA|37.8606|-122.2967|\n|     126|     Keith|     Branan|  94623| 34|94623|      Oakland|   CA|37.6802|-121.9215|\n|     130|   Maynard|     Penley|  94120|165|94120|San Francisco|   CA|37.7848|-122.7278|\n|     179|     Julia|    Nowicki|  94059|182|94059| Redwood City|   CA|37.3811|-122.3348|\n|     183| Elizabeth|   McMillan|  94150|173|94150|San Francisco|   CA|37.7848|-122.7278|\n|     196|     Bruce|     Vargas|  94975|211|94975|     Petaluma|   CA|38.4631|  -122.99|\n|     233|     Arden|      Black|  94088|190|94088|    Sunnyvale|   CA|37.1894|-121.7053|\n|     241|    Conrad|  Fairchild|  94116|164|94116|San Francisco|   CA|37.7441|-122.4863|\n|     275|   Chelsea|      Gaona|  94040|189|94040|Mountain View|   CA|37.3855| -122.088|\n|     410|   Kenneth|    Nowicki|  94110|163|94110|San Francisco|   CA|37.7509|-122.4153|\n|     415|     Jason|       King|  94529| 39|94529|      Concord|   CA|37.7772|-121.9554|\n|     435|    Andrew|      Oakes|  94130|167|94130|San Francisco|   CA|37.8231|-122.3693|\n|     481|     Grace|     Brooks|  95675| 37|95675|  River Pines|   CA|38.5463| -120.743|\n|     489|    George|       Sams|  94088|190|94088|    Sunnyvale|   CA|37.1894|-121.7053|\n|     530|       Ann|   Stennett|  95190|202|95190|     San Jose|   CA|37.3894|-121.8868|\n|     543|      Joan|     Benito|  95915|121|95915|       Belden|   CA|39.9324|-121.3144|\n|     556|  Gretchen|    Akridge|  94074|184|94074| San Gregorio|   CA|37.3255|-122.3556|\n+--------+----------+-----------+-------+---+-----+-------------+-----+-------+---------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1603769333395_450810504","id":"20200428-232333_123134156","dateCreated":"2020-10-27T03:28:53+0000","dateStarted":"2020-11-20T19:02:53+0000","dateFinished":"2020-11-20T19:02:53+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:47264"},{"text":"%md\n#### Count Active Devices","user":"devuser","dateUpdated":"2020-11-09T03:47:47+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h4>Count Active Devices</h4>\n"}]},"apps":[],"jobName":"paragraph_1603769333395_-55770254","id":"20200428-232333_439776920","dateCreated":"2020-10-27T03:28:53+0000","dateStarted":"2020-11-09T03:47:47+0000","dateFinished":"2020-11-09T03:47:47+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:47265"},{"title":"19 - Review the account device data and upload it to HDFS","text":"","user":"devuser","dateUpdated":"2020-12-01T21:09:02+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Deleted /user/zeppelin/device.json\nDeleted /user/zeppelin/account_device\nFound 14 items\ndrwx------   - zeppelin hdfs          0 2020-11-20 00:00 /user/zeppelin/.Trash\ndrwxrwxrwx   - zeppelin hdfs          0 2020-11-20 16:58 /user/zeppelin/.sparkStaging\ndrwx------   - zeppelin hdfs          0 2020-11-12 20:26 /user/zeppelin/.staging\ndrwxr-xr-x   - zeppelin hdfs          0 2020-11-20 19:09 /user/zeppelin/account_device\ndrwxr-xr-x   - zeppelin hdfs          0 2020-11-20 18:30 /user/zeppelin/account_zip94913\n-rw-r--r--   3 zeppelin hdfs      13149 2020-11-20 19:01 /user/zeppelin/base_station.parquet\ndrwxrwxrwx   - zeppelin hdfs          0 2020-11-20 14:10 /user/zeppelin/conf\n-rw-r--r--   3 zeppelin hdfs       5483 2020-11-20 19:09 /user/zeppelin/device.json\ndrwxr-xr-x   - zeppelin hdfs          0 2020-11-20 18:43 /user/zeppelin/device_parquet\ndrwxr-xr-x   - zeppelin hdfs          0 2020-11-20 05:03 /user/zeppelin/hive\ndrwxrwxrwx   - zeppelin hdfs          0 2020-11-20 04:54 /user/zeppelin/notebook\ndrwxr-xr-x   - zeppelin hdfs          0 2020-11-17 16:13 /user/zeppelin/nyse\ndrwxr-xr-x   - zeppelin hdfs          0 2020-11-19 14:18 /user/zeppelin/test\ndrwxr-xr-x   - zeppelin hdfs          0 2020-11-20 04:43 /user/zeppelin/top_device\n"}]},"apps":[],"jobName":"paragraph_1603769333396_-1999977630","id":"20200428-232333_2145921133","dateCreated":"2020-10-27T03:28:53+0000","dateStarted":"2020-11-20T19:09:39+0000","dateFinished":"2020-11-20T19:09:48+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:47266"},{"title":"20 - Create a DataFrame based on the account device data","text":"%pyspark\n","user":"devuser","dateUpdated":"2020-12-01T21:09:21+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1603769333396_-2098907900","id":"20200428-232333_1817940809","dateCreated":"2020-10-27T03:28:53+0000","dateStarted":"2020-11-20T19:09:53+0000","dateFinished":"2020-11-20T19:09:53+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:47267"},{"title":"21 - Analyze the data presented in this exercise","text":"%pyspark\n# Create a DataFrame with only active accounts\n\n\n# Create a DataFrame with the device model IDs of the devices used by active accounts\n\n\n# Calculate the total number of each device model\n\n\n# Order the models by count in descending order\n\n\n# Create a DataFrame by reading in the devices.json file\n\n\n# Get the make and model for each device by joining the list of devices with the ordered list of device model totals\n\n\n# Write the data to a file, including the device id, make, model, and number of active accounts using that model\n# Use overwrite mode so the code can be run multiple times\n","user":"devuser","dateUpdated":"2020-12-01T21:33:31+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1603769333396_1806307285","id":"20200428-232327_1166252029","dateCreated":"2020-10-27T03:28:53+0000","dateStarted":"2020-11-20T19:12:23+0000","dateFinished":"2020-11-20T19:12:25+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:47268"},{"title":"22 - Review the resulting file","text":"%sh\n","user":"devuser","dateUpdated":"2020-12-01T21:14:09+0000","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"part-00000-427785e0-f93b-4385-9605-3246fb11518c-c000.snappy.parquet\npart-00001-427785e0-f93b-4385-9605-3246fb11518c-c000.snappy.parquet\npart-00002-427785e0-f93b-4385-9605-3246fb11518c-c000.snappy.parquet\npart-00003-427785e0-f93b-4385-9605-3246fb11518c-c000.snappy.parquet\npart-00004-427785e0-f93b-4385-9605-3246fb11518c-c000.snappy.parquet\npart-00005-427785e0-f93b-4385-9605-3246fb11518c-c000.snappy.parquet\npart-00006-427785e0-f93b-4385-9605-3246fb11518c-c000.snappy.parquet\npart-00007-427785e0-f93b-4385-9605-3246fb11518c-c000.snappy.parquet\npart-00008-427785e0-f93b-4385-9605-3246fb11518c-c000.snappy.parquet\npart-00009-427785e0-f93b-4385-9605-3246fb11518c-c000.snappy.parquet\npart-00010-427785e0-f93b-4385-9605-3246fb11518c-c000.snappy.parquet\npart-00011-427785e0-f93b-4385-9605-3246fb11518c-c000.snappy.parquet\npart-00012-427785e0-f93b-4385-9605-3246fb11518c-c000.snappy.parquet\npart-00013-427785e0-f93b-4385-9605-3246fb11518c-c000.snappy.parquet\npart-00014-427785e0-f93b-4385-9605-3246fb11518c-c000.snappy.parquet\npart-00015-427785e0-f93b-4385-9605-3246fb11518c-c000.snappy.parquet\npart-00016-427785e0-f93b-4385-9605-3246fb11518c-c000.snappy.parquet\npart-00017-427785e0-f93b-4385-9605-3246fb11518c-c000.snappy.parquet\npart-00018-427785e0-f93b-4385-9605-3246fb11518c-c000.snappy.parquet\npart-00019-427785e0-f93b-4385-9605-3246fb11518c-c000.snappy.parquet\npart-00020-427785e0-f93b-4385-9605-3246fb11518c-c000.snappy.parquet\npart-00021-427785e0-f93b-4385-9605-3246fb11518c-c000.snappy.parquet\npart-00022-427785e0-f93b-4385-9605-3246fb11518c-c000.snappy.parquet\npart-00023-427785e0-f93b-4385-9605-3246fb11518c-c000.snappy.parquet\npart-00024-427785e0-f93b-4385-9605-3246fb11518c-c000.snappy.parquet\npart-00025-427785e0-f93b-4385-9605-3246fb11518c-c000.snappy.parquet\npart-00026-427785e0-f93b-4385-9605-3246fb11518c-c000.snappy.parquet\npart-00027-427785e0-f93b-4385-9605-3246fb11518c-c000.snappy.parquet\npart-00028-427785e0-f93b-4385-9605-3246fb11518c-c000.snappy.parquet\npart-00029-427785e0-f93b-4385-9605-3246fb11518c-c000.snappy.parquet\npart-00030-427785e0-f93b-4385-9605-3246fb11518c-c000.snappy.parquet\npart-00031-427785e0-f93b-4385-9605-3246fb11518c-c000.snappy.parquet\npart-00032-427785e0-f93b-4385-9605-3246fb11518c-c000.snappy.parquet\npart-00033-427785e0-f93b-4385-9605-3246fb11518c-c000.snappy.parquet\npart-00034-427785e0-f93b-4385-9605-3246fb11518c-c000.snappy.parquet\npart-00035-427785e0-f93b-4385-9605-3246fb11518c-c000.snappy.parquet\npart-00036-427785e0-f93b-4385-9605-3246fb11518c-c000.snappy.parquet\npart-00037-427785e0-f93b-4385-9605-3246fb11518c-c000.snappy.parquet\npart-00038-427785e0-f93b-4385-9605-3246fb11518c-c000.snappy.parquet\npart-00039-427785e0-f93b-4385-9605-3246fb11518c-c000.snappy.parquet\npart-00040-427785e0-f93b-4385-9605-3246fb11518c-c000.snappy.parquet\npart-00041-427785e0-f93b-4385-9605-3246fb11518c-c000.snappy.parquet\npart-00042-427785e0-f93b-4385-9605-3246fb11518c-c000.snappy.parquet\npart-00043-427785e0-f93b-4385-9605-3246fb11518c-c000.snappy.parquet\npart-00044-427785e0-f93b-4385-9605-3246fb11518c-c000.snappy.parquet\npart-00045-427785e0-f93b-4385-9605-3246fb11518c-c000.snappy.parquet\npart-00046-427785e0-f93b-4385-9605-3246fb11518c-c000.snappy.parquet\npart-00047-427785e0-f93b-4385-9605-3246fb11518c-c000.snappy.parquet\npart-00048-427785e0-f93b-4385-9605-3246fb11518c-c000.snappy.parquet\npart-00049-427785e0-f93b-4385-9605-3246fb11518c-c000.snappy.parquet\n_SUCCESS\n"}]},"apps":[],"jobName":"paragraph_1603769333396_-1062557731","id":"20200428-232327_20671638","dateCreated":"2020-10-27T03:28:53+0000","dateStarted":"2020-11-20T04:45:41+0000","dateFinished":"2020-11-20T04:45:41+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:47269"},{"text":"%md\n# Result\n**You have now:** analyzed data using DataFrame queries.\n\n---","user":"devuser","dateUpdated":"2020-12-01T22:31:23+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1606858597748_1328421950","id":"20201201-213637_1437073434","dateCreated":"2020-12-01T21:36:37+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:47270"},{"text":"%md\nWe hope you've enjoyed this lab. Below are additional resources that you should find useful:\n\n1. [Cloudera Apache Spark Tutorials](http://hortonworks.com/tutorials/#tuts-developers) are your natural next step where you can explore Spark in more depth.\n2. [Cloudera Community Connection (HCC)](https://community.hortonworks.com/spaces/85/data-science.html?type=question) is a great resource for questions and answers on Spark, Data Analytics/Science, and many more Big Data topics.\n3. [Cloudera Apache Spark Docs](https://docs.hortonworks.com/HDPDocuments/HDP3/HDP-3.0.1/spark-overview/content/analyzing_data_with_apache_spark.html) - official Spark documentation.\n4. [Cloudera Apache Zeppelin Docs](https://docs.hortonworks.com/HDPDocuments/HDP3/HDP-3.0.1/zeppelin-overview/content/overview.html) - official Zeppelin documentation.\n","user":"devuser","dateUpdated":"2020-11-08T23:53:49+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>We hope you've enjoyed this lab. Below are additional resources that you should find useful:</p>\n<ol>\n<li><a href=\"http://hortonworks.com/tutorials/#tuts-developers\">Cloudera Apache Spark Tutorials</a> are your natural next step where you can explore Spark in more depth.</li>\n<li><a href=\"https://community.hortonworks.com/spaces/85/data-science.html?type=question\">Cloudera Community Connection (HCC)</a> is a great resource for questions and answers on Spark, Data Analytics/Science, and many more Big Data topics.</li>\n<li><a href=\"https://docs.hortonworks.com/HDPDocuments/HDP3/HDP-3.0.1/spark-overview/content/analyzing_data_with_apache_spark.html\">Cloudera Apache Spark Docs</a> - official Spark documentation.</li>\n<li><a href=\"https://docs.hortonworks.com/HDPDocuments/HDP3/HDP-3.0.1/zeppelin-overview/content/overview.html\">Cloudera Apache Zeppelin Docs</a> - official Zeppelin documentation.</li>\n</ol>\n"}]},"apps":[],"jobName":"paragraph_1603769333396_1566523298","id":"20181126-133017_244739700","dateCreated":"2020-10-27T03:28:53+0000","dateStarted":"2020-11-08T23:53:49+0000","dateFinished":"2020-11-08T23:53:49+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:47271"}],"name":"DTRAN/03-Queries","id":"2FNC2UP41","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"sh:shared_process":[],"jdbc:shared_process":[],"spark2:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}